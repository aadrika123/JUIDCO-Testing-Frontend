import{r as O}from"./router-56e993c5.js";var G={};Object.defineProperty(G,"__esModule",{value:!0});var k=G.useGeolocated=D;const e=O;function D(l={}){const{positionOptions:i={enableHighAccuracy:!0,maximumAge:0,timeout:1/0},isOptimisticGeolocationEnabled:d=!0,userDecisionTimeout:n=void 0,suppressLocationOnMount:f=!1,watchPosition:s=!1,geolocationProvider:t=typeof navigator<"u"?navigator.geolocation:void 0,watchLocationPermissionChange:S=!1,onError:a,onSuccess:c}=l,m=(0,e.useRef)(0),v=(0,e.useRef)(!0),g=(0,e.useRef)(0),[y,P]=(0,e.useState)(d),[C,E]=(0,e.useState)(),[T,A]=(0,e.useState)(),[I,b]=(0,e.useState)(),[x,M]=(0,e.useState)(),r=(0,e.useCallback)(()=>{m.current&&window.clearTimeout(m.current)},[]),u=(0,e.useCallback)(o=>{r(),v.current&&(E(()=>{}),P(!1),b(o)),a==null||a(o)},[a,r]),p=(0,e.useCallback)(o=>{r(),v.current&&(E(o.coords),A(o.timestamp),P(!0),b(()=>{})),c==null||c(o)},[c,r]),w=(0,e.useCallback)(()=>{if(!t||!t.getCurrentPosition||!t.watchPosition)throw new Error("The provided geolocation provider is invalid");n&&(m.current=window.setTimeout(()=>{u()},n)),s?g.current=t.watchPosition(p,u,i):t.getCurrentPosition(p,u,i)},[t,s,n,u,p,i]);return(0,e.useEffect)(()=>{let o;return S&&t&&"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(h=>{o=h,o.onchange=()=>{M(o.state)}}).catch(h=>{console.error("Error updating the permissions",h)}),()=>{o&&(o.onchange=null)}},[]),(0,e.useEffect)(()=>(f||w(),()=>{r(),s&&g.current&&(t==null||t.clearWatch(g.current))}),[x]),{getPosition:w,coords:C,timestamp:T,isGeolocationEnabled:y,isGeolocationAvailable:!!t,positionError:I}}function L(){const{isGeolocationAvailable:l,isGeolocationEnabled:i,getPosition:d,coords:n,positionError:f,timestamp:s}=k({positionOptions:{enableHighAccuracy:!0,timeout:1/0,maximumAge:localStorage.getItem("geoMaxAge")||1/0},watchPosition:!0,userDecisionTimeout:5e3});return{isGeolocationAvailable:l,isGeolocationEnabled:i,coords:n,positionError:f,timestamp:s,getPosition:d}}export{L as u};
