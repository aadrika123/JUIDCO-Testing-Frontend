import{u as O,h as $,j as a,m as o,_ as n,r as l,i as aa,B as ea}from"./index-BOd1yYiR.js";import{a as sa}from"./index-DXeckOon.js";import{C as ra,a as ta,c as da,d as la}from"./card-C5Njr2qE.js";import{S as G,a as na,T as ca,b as ia,c as z,d as _,e as oa,f as g}from"./Spinner-BL_a21M1.js";import{a as K,o as Q,F as W,S as A,B as X,c as Y,d as V,b as P}from"./SelectField-Dcb70mjz.js";import"./input-f69tkrXX.js";import{g as Z}from"./services-KQnp_8oA.js";import{D as ua}from"./index-ZIqh30WV.js";import{L as xa,c as pa}from"./index.es-BPOV0YB1.js";import{L as ha}from"./label-DkJBltr-.js";import{q as ja}from"./switch-DQRC-OM_.js";const ma=Y().shape({ulb_id:V().required("ulb id is required"),service_id:V().required("service id is required")});function fa({open:I,setOpen:C,title:T,edit:b,setEdit:k,serviceList:M}){var S,i,y,N,d,w,p;const B=O({}),u=K({defaultValues:{ulb_id:0,service_id:0},resolver:Q(ma)}),v=async s=>{var h,j,m,f;try{const r=await B.mutateAsync({api:(h=o)==null?void 0:h.createServiceMapping,data:s});(j=r==null?void 0:r.data)!=null&&j.success?(n.success((m=r==null?void 0:r.data)==null?void 0:m.message),C(!1),k(!1),M.refetch()):n.error((f=r==null?void 0:r.data)==null?void 0:f.message)}catch(r){n.error(Z(r))}},x=$({api:`${(S=o)==null?void 0:S.getAllJuidcoUlbList}`,key:"getAllJuidcoUlbList",options:{enabled:!0}}),c=$({api:`${(i=o)==null?void 0:i.serviceList}`,key:"serviceList",options:{enabled:!0}});return a.jsx(ua,{open:I,setOpen:C,title:T,setEdit:k,edit:b,children:a.jsx(W,{methods:u,onSubmit:u.handleSubmit(v),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(A,{name:"service_id",data:((d=(N=(y=c==null?void 0:c.data)==null?void 0:y.data)==null?void 0:N.data)==null?void 0:d.map(s=>({value:s==null?void 0:s.id,label:s==null?void 0:s.service_name})))??[]})}),a.jsx("div",{children:a.jsx(A,{name:"ulb_id",data:((p=(w=x==null?void 0:x.data)==null?void 0:w.data)==null?void 0:p.map(s=>({value:s==null?void 0:s.id,label:s==null?void 0:s.ulb_name})))??[]})}),a.jsx(G,{}),a.jsx("div",{children:a.jsx(X,{isLoading:u.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const ga=Y().shape({ulbId:P(),moduleId:P(),complaintRefNo:P()});function ba(){var p,s,h,j,m,f,r;const[I,C]=l.useState(1),T=O({}),[b,k]=l.useState(10),[M,B]=l.useState(!1);l.useState(""),l.useState("");const[u,v]=l.useState(!1),[x]=l.useState(""),[c,S]=l.useState(!1),i=K({resolver:Q(ga),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),y=async e=>{d==null||d.refetch()},N=aa({api:(p=o)==null?void 0:p.userManagementModuleList,key:"userManagementModuleList",options:{enabled:!0}}),d=$({api:`${(s=o)==null?void 0:s.getServiceMapping}`,key:"getServiceMapping",options:{enabled:!0}}),w=async e=>{var L,F,q,D,U,E,J,R,H;try{const t=await T.mutateAsync({api:`${(L=o)==null?void 0:L.updateServiceMapping}`,data:{id:e}});(F=t==null?void 0:t.data)!=null&&F.success?(d.refetch(),((D=(q=t==null?void 0:t.data)==null?void 0:q.data)==null?void 0:D.status)==1&&n.success((U=t.data)==null?void 0:U.message),((J=(E=t==null?void 0:t.data)==null?void 0:E.data)==null?void 0:J.status)==0&&n.error((R=t.data)==null?void 0:R.message)):n.error((H=t.data)==null?void 0:H.message)}catch(t){n.error(Z(t))}};return a.jsxs("main",{className:"grid items-start",children:[M&&a.jsx("div",{style:{zIndex:1001},className:"fixed left-0 top-0 z-50 flex h-full w-full items-center justify-center bg-white",children:a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(xa,{className:"w-24",animationData:pa,loop:!0}),a.jsx("div",{className:"font-semibold",children:"Permission Updated"})]})}),a.jsx(fa,{open:u,setOpen:v,title:c?"Edit Service":"Add Service",id:x,edit:c,setEdit:S,serviceList:d}),a.jsx("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:a.jsxs(ra,{children:[a.jsx(W,{methods:i,onSubmit:i.handleSubmit(y),children:a.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[a.jsxs("div",{children:[a.jsx(ha,{htmlFor:"moduleId",children:"Module name"}),a.jsx(A,{className:"cursor-pointer bg-background",name:"moduleId",data:((j=(h=N.data)==null?void 0:h.data)==null?void 0:j.map(e=>({value:e==null?void 0:e.id,label:e==null?void 0:e.module_name})))??[]})]}),a.jsx("div",{className:"mt-6 flex justify-start",children:a.jsx(X,{variant:"secondary",isLoading:i.formState.isSubmitting,type:"submit",className:"float-right  w-auto px-10",children:"Search"})}),a.jsx("div",{className:"mt-6 flex justify-end",children:a.jsx(ea,{type:"button",className:"flex items-center gap-2",onClick:()=>v(!0),children:"Add New"})})]})}),a.jsx(ta,{className:"px-7",children:a.jsx(da,{})}),a.jsx(la,{children:d.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(na,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(ca,{children:[a.jsx(ia,{children:a.jsxs(z,{children:[a.jsx(_,{className:"",children:"#"}),a.jsx(_,{className:"",children:"Service"}),a.jsx(_,{className:"",children:"Module"}),a.jsx(_,{className:"",children:"ULB"})]})}),a.jsx(oa,{children:(r=(f=(m=d==null?void 0:d.data)==null?void 0:m.data)==null?void 0:f.data)==null?void 0:r.map((e,L)=>a.jsxs(z,{children:[a.jsx(g,{children:I*b-b+L+1}),a.jsx(g,{children:e==null?void 0:e.service_name}),a.jsx(g,{children:e==null?void 0:e.module_name}),a.jsx(g,{children:e==null?void 0:e.ulb_name}),a.jsx(g,{children:a.jsxs(ja,{checked:(e==null?void 0:e.status)==1,onChange:()=>w(e==null?void 0:e.id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})})]},e==null?void 0:e.id))})]}),a.jsx(G,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end"})]})})]})})]})}function Ma(){return a.jsx(sa,{title:"JUIDCO Service Mapping",subTitle:"Control all services here",children:a.jsx("div",{children:a.jsx(ba,{})})})}export{Ma as default};
