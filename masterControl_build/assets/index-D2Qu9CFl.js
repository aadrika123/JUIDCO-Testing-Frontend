import{j as e,_ as w,m as F,r as t,B as Q}from"./index-Dkt__Xic.js";import{a as Oe}from"./index-CS2NUbM0.js";import{C as oe,d as ue,b as we,a as We,c as Ue}from"./card-DQa5Tc8i.js";import{a as xe,T as he,b as me,c as K,d as _,e as je,f as k,S as ae}from"./Spinner-Dl07qqYH.js";import{u as J,b as H,a as Le}from"./useCustomQuery-NR9yHuLV.js";import{g as X}from"./services-KQnp_8oA.js";import{u as Qe,C as He,a as se,o as le,F as ge,c as z,b as T,R as Ke,B as Re,S as Ye}from"./SelectField-DQlMFVw9.js";import{I as Je}from"./input-pRXD90yN.js";import{L as Xe}from"./label-DJAQ3ybb.js";import{D as Se,d as pe,F as be,c as Ce,X as Me,b as _e,P as ke}from"./dialog-CiJumVAd.js";import{D as fe}from"./index-DA52_pEo.js";import{T as De,a as $e,f as Ie,g as Pe,b as Ae,c as Ee,d as ze,e as Ge}from"./tabs-dGW4k1qC.js";import{P as Ve}from"./index-C00InoNv.js";import{R as ee}from"./RHFTextField-WUzuukEo.js";import{I as qe}from"./Image-Bz6041jT.js";import{q as Te}from"./switch-EXoAnYEM.js";import"./createLucideIcon-vLxG6OSU.js";function Fe({name:a,label:v,isDynamic:O,isRequired:i,...f}){const{control:$,setValue:y}=Qe();return e.jsx(He,{name:a,control:$,render:({field:{ref:L},fieldState:{error:M}})=>e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-200",htmlFor:v,children:[v," ",i&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(Je,{type:"file",onChange:R=>{y(a,R.target.files?R.target.files[0]:null)},ref:L,className:`mt-1 ${M?"border-red-400":null}`,...f}),M&&e.jsx("span",{className:"text-red-400 text-xs",children:M.message})]})})}const Ze=z().shape({service_name:T().required("menu name is required")});function Be({open:a,setOpen:v,title:O,edit:i,setEdit:f,serviceList:$,moduleList:y,id:L,menuRoleList:M,moduleId:R,menuRoleId:S,moduleName:q,roleList:N,userPermittedRoles:p,userId:E,permittedModule:A,ulbId:m,permittedModuleListByUlb:D}){var l;const j=J({}),h=J({}),d=se({defaultValues:{service_name:""},resolver:le(Ze)}),n=async u=>{var r,s,o;try{const V=i?"EditModuleList":"AddmoduleList",b=i&&L?{...u,moduleId:L}:{...u,moduleId:R},C=await j.mutateAsync({api:V,data:b});(r=C==null?void 0:C.data)!=null&&r.success?(w.success((s=C==null?void 0:C.data)==null?void 0:s.message),v(!1),f(!1),$.refetch()):w.error((o=C==null?void 0:C.data)==null?void 0:o.message)}catch(V){w.error(X(V))}},g=async(u,r)=>{var s,o,V,b;console.log(r);try{const C={ulbId:m,moduleList:[{permissionStatus:r,moduleId:u}]},W=await h.mutateAsync({api:(s=F)==null?void 0:s.addRemoveModuleToUlb,data:C});(o=W==null?void 0:W.data)!=null&&o.status?(w.success(((V=W==null?void 0:W.data)==null?void 0:V.message)||"Permission updated successfully"),D.refetch()):w.error(((b=W==null?void 0:W.data)==null?void 0:b.message)||"Failed to update permission")}catch(C){w.error(X(C))}};return H({api:(l=F)==null?void 0:l.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),console.log(A),e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:f,edit:i,children:e.jsx(ge,{methods:d,onSubmit:d.handleSubmit(n),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Module Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(A==null?void 0:A.map((u,r)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${u.permission_status?"text-green-600":"text-black"}`,children:u.module_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:u.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>g(u.id,!u.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>g(u.id,!u.permission_status),children:"Add"})})]},u.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}const ea=z().shape({service_name:T().required("menu name is required")});function aa({open:a,setOpen:v,title:O,edit:i,setEdit:f,serviceList:$,moduleList:y,id:L,menuRoleList:M,moduleId:R,menuRoleId:S,moduleName:q,roleList:N,userPermittedRoles:p,userId:E,permittedModule:A,ulbId:m,permittedModuleListByUlb:D,getServicesByUlbModule:j,permittedServices:h}){var r;const d=J({}),n=J({}),g=se({defaultValues:{service_name:""},resolver:le(ea)}),l=async s=>{var o,V,b;try{const C=i?"EditModuleList":"AddmoduleList",W=i&&L?{...s,moduleId:L}:{...s,moduleId:R},U=await d.mutateAsync({api:C,data:W});(o=U==null?void 0:U.data)!=null&&o.success?(w.success((V=U==null?void 0:U.data)==null?void 0:V.message),v(!1),f(!1),$.refetch()):w.error((b=U==null?void 0:U.data)==null?void 0:b.message)}catch(C){w.error(X(C))}},u=async(s,o)=>{var V,b,C,W;console.log(o);try{const U={ulbId:m,serviceList:[{permissionStatus:o,serviceId:s}]},I=await n.mutateAsync({api:(V=F)==null?void 0:V.addRemoveServiceByUlbModule,data:U});(b=I==null?void 0:I.data)!=null&&b.status?(w.success(((C=I==null?void 0:I.data)==null?void 0:C.message)||"Permission updated successfully"),j.refetch()):w.error(((W=I==null?void 0:I.data)==null?void 0:W.message)||"Failed to update permission")}catch(U){w.error(X(U))}};return H({api:(r=F)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),console.log(A),e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:f,edit:i,children:e.jsx(ge,{methods:g,onSubmit:g.handleSubmit(l),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Route"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(h==null?void 0:h.map((s,o)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:o+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.services}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.path}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>u(s.id,!s.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>u(s.id,!s.permission_status),children:"Add"})})]},s.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}const sa=z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function la(a){var d,n,g,l,u,r,s,o,V;const[v,O]=t.useState(1),[i,f]=t.useState(10),[$,y]=t.useState(!1),[L,M]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(!1),t.useState(null);const[q,N]=t.useState(!1),[p,E]=t.useState("");t.useState("");const[A,m]=t.useState("");t.useState(1),t.useState(10),console.log(a==null?void 0:a.ulbId);const D=se({resolver:le(sa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),j=Le({api:`${(d=F)==null?void 0:d.serviceList}?module=${(n=D==null?void 0:D.watch())==null?void 0:n.moduleId}`,key:"serviceMasterList",options:{enabled:!0}});H({api:(g=F)==null?void 0:g.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:i,searchQuery:A,[p]:A},value:[v,i,p,A],options:{enabled:!!(a!=null&&a.ulbId)}});const h=H({api:(l=F)==null?void 0:l.getServicesByUlbModule,key:"getServicesByUlbModule",config:{ulbId:a==null?void 0:a.ulbId,moduleId:a==null?void 0:a.moduleId},options:{enabled:!!(a!=null&&a.ulbId)}});return console.log(a==null?void 0:a.moduleId),console.log((u=h==null?void 0:h.data)==null?void 0:u.data),e.jsxs(e.Fragment,{children:[e.jsx(Se,{open:q,children:e.jsx(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll"})}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{M(""),S(!1),y(!0)},children:"Restrict More Services"})})}),e.jsx(aa,{open:$,setOpen:y,title:R?"Edit Restrict Service":"Add Restrict Service",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,ulbId:a==null?void 0:a.ulbId,getServicesByUlbModule:h,permittedServices:(r=h==null?void 0:h.data)==null?void 0:r.data}),e.jsx(oe,{children:e.jsx(ue,{children:j.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Service Name"}),e.jsx(_,{className:"",children:"Service Route"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(V=(o=(s=h==null?void 0:h.data)==null?void 0:s.data)==null?void 0:o.filter(b=>(b==null?void 0:b.permission_status)==!0))==null?void 0:V.map((b,C)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+C+1}),e.jsx(k,{children:b==null?void 0:b.services}),e.jsx(k,{children:b==null?void 0:b.path}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{M(b==null?void 0:b.id),S(!0),y(!0)},children:[e.jsx(be,{})," Edit"]})})]},b==null?void 0:b.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"})]})})})]})})]})}z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ta(a){var r,s,o,V,b,C,W,U;const[v,O]=t.useState(1),[i,f]=t.useState(10),[$,y]=t.useState(!1),[L,M]=t.useState(""),[R,S]=t.useState(!1),[q,N]=t.useState(!1),[p,E]=t.useState(null),[A,m]=t.useState(1),[D,j]=t.useState(10),h=100,d=I=>{m(I)},n=I=>{j(I),m(1)};console.log(a==null?void 0:a.ulbId);const g=H({api:(r=F)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),l=H({api:(s=F)==null?void 0:s.getModuleByUlbId,key:"permittedModuleListByUlb",config:{ulbId:a==null?void 0:a.ulbId},options:{enabled:!!(a!=null&&a.ulbId)}});console.log((o=l==null?void 0:l.data)==null?void 0:o.data);const u=I=>{E(I),N(!0)};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:q,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:(V=a==null?void 0:a.selectedULB)==null?void 0:V.ulb_name})]}),e.jsxs("div",{children:["Module Name : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:p==null?void 0:p.module_name})]})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>N(!1)})})})]}),e.jsxs(De,{defaultValue:"MENULIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsx($e,{className:"grid w-auto grid-cols-2",children:e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Restricted Services"})})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(la,{ulbId:a==null?void 0:a.ulbId,moduleId:L,viewService:p})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{M(""),S(!1),y(!0)},children:"Add More Module"})})}),e.jsx(Be,{open:$,setOpen:y,title:R?"Edit Module":"Add Module",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedModule:(b=l==null?void 0:l.data)==null?void 0:b.data,permittedModuleListByUlb:l,ulbId:a==null?void 0:a.ulbId}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:g.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Module"}),e.jsx(_,{className:"",children:"Path"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(U=(W=(C=l==null?void 0:l.data)==null?void 0:C.data)==null?void 0:W.filter(I=>(I==null?void 0:I.permission_status)==!0))==null?void 0:U.map((I,Z)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+Z+1}),e.jsx(k,{children:I==null?void 0:I.module_name}),e.jsx(k,{children:I==null?void 0:I.url}),e.jsxs(k,{children:[e.jsxs(Q,{variant:"secondary",onClick:()=>{M(I==null?void 0:I.id),S(!0),y(!0)},children:[e.jsx(be,{})," Edit"]}),e.jsxs(Q,{onClick:()=>{u(I),M(I==null?void 0:I.id)},className:"ml-2",variant:"secondary",children:[e.jsx(_e,{})," View"]})]})]},I==null?void 0:I.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{currentPage:A,totalItems:h,itemsPerPage:D,onPageChange:d,onItemsPerPageChange:n})})]})})})]})})}const da=z().shape({service_name:T().required("menu name is required")});function na({open:a,setOpen:v,title:O,edit:i,setEdit:f,serviceList:$,moduleList:y,id:L,menuRoleList:M,moduleId:R,menuRoleId:S,moduleName:q,roleList:N,userPermittedRoles:p,userId:E}){const A=J({}),m=J({}),D=se({defaultValues:{service_name:""},resolver:le(da)}),j=async d=>{var n,g,l;try{const u=i?"EditModuleList":"AddmoduleList",r=i&&L?{...d,moduleId:L}:{...d,moduleId:R},s=await A.mutateAsync({api:u,data:r});(n=s==null?void 0:s.data)!=null&&n.success?(w.success((g=s==null?void 0:s.data)==null?void 0:g.message),v(!1),f(!1),$.refetch()):w.error((l=s==null?void 0:s.data)==null?void 0:l.message)}catch(u){w.error(X(u))}},h=async(d,n)=>{var g,l,u,r;console.log(n);try{const s={userId:E,permissionStatus:n,menuRoleId:d},o=await m.mutateAsync({api:(g=F)==null?void 0:g.addMenuRoleUser,data:s});(l=o==null?void 0:o.data)!=null&&l.status?(w.success(((u=o==null?void 0:o.data)==null?void 0:u.message)||"Permission updated successfully"),p.refetch()):w.error(((r=o==null?void 0:o.data)==null?void 0:r.message)||"Failed to update permission")}catch(s){w.error(X(s))}};return e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:f,edit:i,children:e.jsx(ge,{methods:D,onSubmit:D.handleSubmit(j),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(N==null?void 0:N.map((d,n)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:n+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${d.permission_status?"text-green-600":"text-black"}`,children:d.menu_role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>h(d.id,!d.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>h(d.id,!d.permission_status),children:"Add"})})]},d.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ra(a){var h,d,n,g,l,u;const[v,O]=t.useState(1),[i,f]=t.useState(10),[$,y]=t.useState(!1),[L,M]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(null);const[q,N]=t.useState(1),[p,E]=t.useState(10),A=100,m=r=>{N(r)},D=r=>{E(r),N(1)};console.log(a==null?void 0:a.ulbId);const j=H({api:(h=F)==null?void 0:h.userPermittedRoles,key:"userPermittedRoles",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((d=j==null?void 0:j.data)==null?void 0:d.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{M(""),S(!1),y(!0)},children:"Add More Role Permission"})})}),e.jsx(na,{open:$,setOpen:y,title:R?"Edit Menu":"Add Menu",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,roleList:(n=j==null?void 0:j.data)==null?void 0:n.data,userPermittedRoles:j}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:j.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Role Menu"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(u=(l=(g=j==null?void 0:j.data)==null?void 0:g.data)==null?void 0:l.filter(r=>(r==null?void 0:r.permission_status)==!0))==null?void 0:u.map((r,s)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+s+1}),e.jsx(k,{children:r==null?void 0:r.menu_role_name}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{M(r==null?void 0:r.id),S(!0),y(!0)},children:[e.jsx(be,{})," Edit"]})})]},r==null?void 0:r.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{currentPage:q,totalItems:A,itemsPerPage:p,onPageChange:m,onItemsPerPageChange:D})})]})})})]})})}const ca=z().shape({service_name:T().required("menu name is required")});function ia({open:a,setOpen:v,title:O,edit:i,setEdit:f,serviceList:$,moduleList:y,id:L,menuRoleList:M,moduleId:R,menuRoleId:S,moduleName:q,wardList:N,permittedWardByUsers:p,userId:E}){const A=J({}),m=J({}),D=se({defaultValues:{service_name:""},resolver:le(ca)}),j=async d=>{var n,g,l;try{const u=i?"EditModuleList":"AddmoduleList",r=i&&L?{...d,moduleId:L}:{...d,moduleId:R},s=await A.mutateAsync({api:u,data:r});(n=s==null?void 0:s.data)!=null&&n.success?(w.success((g=s==null?void 0:s.data)==null?void 0:g.message),v(!1),f(!1),$.refetch()):w.error((l=s==null?void 0:s.data)==null?void 0:l.message)}catch(u){w.error(X(u))}},h=async(d,n)=>{var g,l,u,r;console.log(n);try{const s={userId:E,wardList:d?[{permissionStatus:n,wardId:d}]:N.map(V=>({wardId:V.id,permissionStatus:n}))},o=await m.mutateAsync({api:(g=F)==null?void 0:g.addRemoveWard,data:s});(l=o==null?void 0:o.data)!=null&&l.status?(w.success(((u=o==null?void 0:o.data)==null?void 0:u.message)||"Permission updated successfully"),p.refetch()):w.error(((r=o==null?void 0:o.data)==null?void 0:r.message)||"Failed to update permission")}catch(s){w.error(X(s))}};return e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:f,edit:i,children:e.jsx(ge,{methods:D,onSubmit:D.handleSubmit(j),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-4 py-2 rounded-md text-sm font-bold",onClick:()=>h(null,!0),children:"Select All"}),e.jsx("button",{className:"text-red-600 bg-red-200 hover:bg-red-100 px-4 py-2 rounded-md text-sm font-bold",onClick:()=>h(null,!1),children:"Remove All"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Ward No."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(N==null?void 0:N.map((d,n)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:n+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${d.permission_status?"text-green-600":"text-black"}`,children:d.ward_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>h(d.id,!d.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>h(d.id,!d.permission_status),children:"Add"})})]},d.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})]})})})}z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function oa(a){var p,E,A,m,D,j,h;const[v,O]=t.useState(1),[i,f]=t.useState(10),[$,y]=t.useState(!1),[L,M]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(null),t.useState(1),t.useState(10),console.log(a==null?void 0:a.ulbId);const q=H({api:(p=F)==null?void 0:p.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),N=H({api:(E=F)==null?void 0:E.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((A=N==null?void 0:N.data)==null?void 0:A.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{M(""),S(!1),y(!0)},children:"Add More Ward Permission"})})}),e.jsx(ia,{open:$,setOpen:y,title:R?"Edit Ward":"Add Ward",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedWardByUsers:N,wardList:(m=N==null?void 0:N.data)==null?void 0:m.data}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:q.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Wards"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(h=(j=(D=N==null?void 0:N.data)==null?void 0:D.data)==null?void 0:j.filter(d=>(d==null?void 0:d.permission_status)==!0))==null?void 0:h.map((d,n)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+n+1}),e.jsx(k,{children:d==null?void 0:d.ward_name}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{M(d==null?void 0:d.id),S(!0),y(!0)},children:[e.jsx(be,{})," Edit"]})})]},d==null?void 0:d.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"})]})})})]})})}const ua=z().shape({service_name:T().required("menu name is required")});function xa({open:a,setOpen:v,title:O,subtitle:i,edit:f,setEdit:$,serviceList:y,moduleList:L,id:M,menuRoleList:R,moduleId:S,menuRoleId:q,moduleName:N,wardList:p,permittedworkFlowRoleByUser:E,userId:A,workFlowList:m}){const D=J({}),j=J({}),h=se({defaultValues:{service_name:""},resolver:le(ua)}),d=async l=>{var u,r,s;try{const o=f?"EditModuleList":"AddmoduleList",V=f&&M?{...l,moduleId:M}:{...l,moduleId:S},b=await D.mutateAsync({api:o,data:V});(u=b==null?void 0:b.data)!=null&&u.success?(w.success((r=b==null?void 0:b.data)==null?void 0:r.message),v(!1),$(!1),y.refetch()):w.error((s=b==null?void 0:b.data)==null?void 0:s.message)}catch(o){w.error(X(o))}},n=async(l,u)=>{var r,s,o,V;console.log(u);try{const b={userId:A,permissionStatus:u,wfRoleId:l},C=await j.mutateAsync({api:(r=F)==null?void 0:r.AddRemoveWorkFlowRoleByUser,data:b});(s=C==null?void 0:C.data)!=null&&s.status?(w.success(((o=C==null?void 0:C.data)==null?void 0:o.message)||"Permission updated successfully"),E.refetch()):w.error(((V=C==null?void 0:C.data)==null?void 0:V.message)||"Failed to update permission")}catch(b){w.error(X(b))}},g=m==null?void 0:m.some(l=>l.permission_status);return e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:$,subtitle:i,edit:f,children:e.jsx(ge,{methods:h,onSubmit:h.handleSubmit(d),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(m==null?void 0:m.map((l,u)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:u+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${l.permission_status?"text-green-600":"text-black"}`,children:l.role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-bold ${l.permission_status?"text-red-600 bg-red-200 hover:bg-red-100":g?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-green-600 bg-green-200 hover:bg-green-100"}`,onClick:()=>!g||l.permission_status?n(l.id,!l.permission_status):null,disabled:!l.permission_status&&g,children:l.permission_status?"Remove":"Add"})})]},l.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ha(a){var E,A,m,D,j,h,d,n,g;const[v,O]=t.useState(1),[i,f]=t.useState(10),[$,y]=t.useState(!1),[L,M]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(null),t.useState(1),t.useState(10);const q=H({api:(E=F)==null?void 0:E.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),N=H({api:(A=F)==null?void 0:A.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}}),p=H({api:(m=F)==null?void 0:m.workFlowRoleByUser,key:"permittedworkFlowRoleByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((D=N==null?void 0:N.data)==null?void 0:D.data),console.log((j=p==null?void 0:p.data)==null?void 0:j.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{M(""),S(!1),y(!0)},children:"Change Role Permission"})})}),e.jsx(xa,{open:$,setOpen:y,title:R?"Edit Role":"Change Role",subtitle:"You can provide only one workflow role at a time.",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedworkFlowRoleByUser:p,workFlowList:(h=p==null?void 0:p.data)==null?void 0:h.data}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:q.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Workflow Role Name"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(g=(n=(d=p==null?void 0:p.data)==null?void 0:d.data)==null?void 0:n.filter(l=>(l==null?void 0:l.permission_status)==!0))==null?void 0:g.map((l,u)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+u+1}),e.jsx(k,{children:l==null?void 0:l.role_name}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{M(l==null?void 0:l.id),S(!0),y(!0)},children:[e.jsx(be,{})," Edit"]})})]},l==null?void 0:l.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"})]})})})]})})}const ma=z().shape({userType:T().required("User Type is required"),name:T().required("Full Name is required"),mobile:T().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:T().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:T().email("Enter a valid email").required("Email is required"),address:T().required("Address is required"),photo:T().required("User Image is required")});function ja({open:a,setOpen:v,title:O,edit:i,setEdit:f,adminListFun:$,id:y,ulbId:L,userListByUlbId:M}){var A,m,D;const R=J({}),S=t.useRef(null),q=se({defaultValues:{userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:le(ma)}),{reset:N}=q;t.useEffect(()=>{var j,h,d;if(a){if(i&&y){const n=(d=(h=(j=M==null?void 0:M.data)==null?void 0:j.data)==null?void 0:h.data)==null?void 0:d.find(g=>g.id==y);console.log(n,"selectedAdmin"),n&&N({userType:n.user_type||"",name:n.name||"",mobile:n.mobile||"",altMobile:n.alternateMobile||"",email:n.email||"",address:n.address||"",photo:null})}else N({userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});q.setValue("photo",""),S.current&&(S.current.value="")}},[a,i,y,$,N]);const p=async j=>{var h,d,n,g,l;try{const u=i?(h=F)==null?void 0:h.updateAdmin:(d=F)==null?void 0:d.createAdmin,r=i&&y?{...j,id:y}:{...j,ulbId:L},s=new FormData;s.append("name",r.name),s.append("mobile",r.mobile),s.append("altMobile",r.altMobile),s.append("email",r.email),s.append("address",r.address),s.append("userType",r.userType),s.append("photo",q.watch("photo")),i&&y&&s.append("id",y),s.append("ulbId",r.ulbId||"");const o=await R.mutateAsync({api:u,data:s});(n=o==null?void 0:o.data)!=null&&n.status?(w.success((g=o==null?void 0:o.data)==null?void 0:g.message),v(!1),f(!1),M.refetch()):w.error((l=o==null?void 0:o.data)==null?void 0:l.message)}catch(u){w.error(X(u))}},E=H({api:(A=F)==null?void 0:A.createUserType,key:"createUserTypeList",options:{enabled:!0}});return console.log((m=E==null?void 0:E.data)==null?void 0:m.data,"createUserTypeList"),e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:f,edit:i,children:e.jsx(ge,{methods:q,onSubmit:q.handleSubmit(p),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(Ke,{label:"User Type",name:"userType",data:((D=E==null?void 0:E.data)==null?void 0:D.data.map(j=>({value:String(j),label:String(j)})))||[]})}),e.jsx("div",{children:e.jsx(ee,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Full Name"})}),e.jsx("div",{children:e.jsx(ee,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter Mobile No "})}),e.jsx("div",{children:e.jsx(ee,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter Alt Mobile No "})}),e.jsx("div",{children:e.jsx(ee,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(ee,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Fe,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(ae,{}),e.jsx("div",{children:e.jsx(Re,{isLoading:q.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const ga=z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ba(a){var V,b,C,W,U,I,Z,ne,re,P,te,ce,ie,x;const[v,O]=t.useState(1),[i,f]=t.useState(10),$=J({}),[y,L]=t.useState(!1),[M,R]=t.useState(""),[S,q]=t.useState(!1),[N,p]=t.useState(!1),[E,A]=t.useState(!1),[m,D]=t.useState(""),[j,h]=t.useState(""),[d,n]=t.useState(""),g=c=>{D(c)},l=c=>{h(c.target.value)};t.useEffect(()=>{const c=setTimeout(()=>{n(j)},700);return()=>clearTimeout(c)},[j]),console.log(a==null?void 0:a.ulbId);const u=se({resolver:le(ga),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),r=Le({api:`${(V=F)==null?void 0:V.serviceList}?module=${(b=u==null?void 0:u.watch())==null?void 0:b.moduleId}`,key:"serviceMasterList",options:{enabled:!0}}),s=H({api:(C=F)==null?void 0:C.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:i,searchQuery:d,[m]:d},value:[v,i,m],options:{enabled:!0}});t.useEffect(()=>{d&&(O(1),f(10)),s.refetch()},[d]);const o=async(c,B)=>{var Y,ye,ve,Ne;try{const G={id:c,isSuspended:B},de=await $.mutateAsync({api:(Y=F)==null?void 0:Y.enableDisableUserByModule,data:G});(ye=de==null?void 0:de.data)!=null&&ye.status?(w.success(((ve=de==null?void 0:de.data)==null?void 0:ve.message)||"Permission updated successfully"),s.refetch()):w.error(((Ne=de==null?void 0:de.data)==null?void 0:Ne.message)||"Failed to update permission")}catch(G){w.error(X(G))}};return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{open:E,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500  font-bold flex justify-between",children:[e.jsxs("div",{children:["User : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:N==null?void 0:N.name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>A(!1)})})})]}),e.jsxs(De,{defaultValue:"ROLELIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsxs($e,{className:"grid w-auto grid-cols-3 bg-gray-100 rounded-md py-1",children:[e.jsx(Ae,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"ROLELIST",children:"Permitted Roles"}),e.jsx(Ae,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"PERMITTED_WARDS",children:"Permitted Wards"}),e.jsx(Ae,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"PERMITTED_WORKFLOW_ROLE",children:"Permitted Workflow Role"})]})}),e.jsx(Ee,{value:"ROLELIST",children:e.jsx(ra,{selectedULB:N,id:M})}),e.jsx(Ee,{value:"PERMITTED_WARDS",children:e.jsx(oa,{selectedULB:N,id:M})}),e.jsx(Ee,{value:"PERMITTED_WORKFLOW_ROLE",children:e.jsx(ha,{selectedULB:N,id:M})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{R(""),q(!1),L(!0)},children:"Create User"})})}),e.jsx(ja,{open:y,setOpen:L,title:S?"Edit user":"Create User",id:M,edit:S,setEdit:q,ulbId:a==null?void 0:a.ulbId,userListByUlbId:s}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:m,onChange:c=>g(c.target.value),className:"cursor-pointer w-[200px] bg-background border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:j,onChange:l,placeholder:`Search by ${m}`,className:"border p-2 rounded-md",maxLength:m=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Users : ",(U=(W=s==null?void 0:s.data)==null?void 0:W.data)==null?void 0:U.total]}),e.jsx(oe,{children:e.jsx(ue,{children:r.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"User Image"}),e.jsx(_,{className:"",children:"Name"}),e.jsx(_,{className:"",children:"Mobile No"}),e.jsx(_,{className:"",children:"Alt Mobile No"}),e.jsx(_,{className:"",children:"Email"}),e.jsx(_,{className:"",children:"User Type"}),e.jsx(_,{className:"",children:"Address"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(ne=(Z=(I=s==null?void 0:s.data)==null?void 0:I.data)==null?void 0:Z.data)==null?void 0:ne.map((c,B)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+B+1}),e.jsx(k,{children:e.jsx(qe,{src:c.documentUrl,alt:c.name,className:"w-10 h-10 border-2 rounded-full object-cover"})}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.name}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.mobile}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.alternateMobile}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.email}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.user_type}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.address}),e.jsx(k,{children:e.jsxs(Te,{checked:c==null?void 0:c.suspended,onChange:()=>o(c.id,!c.suspended),className:`${c!=null&&c.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${c!=null&&c.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(k,{children:e.jsxs("td",{className:"flex",children:[e.jsxs(Q,{variant:"secondary",onClick:()=>{R(c==null?void 0:c.id),q(!0),L(!0)},children:[e.jsx(be,{})," Edit"]}),e.jsxs(Q,{onClick:()=>{p(c),A(!0),R(c==null?void 0:c.id)},className:"ml-2",variant:"secondary",children:[e.jsx(_e,{})," View"]})]})})]},c==null?void 0:c.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Ve,{page:v,perPage:i,totalPage:(P=(re=s==null?void 0:s.data)==null?void 0:re.data)==null?void 0:P.total,setPage:O,setPerPage:f,hasNextPage:((ce=(te=s==null?void 0:s.data)==null?void 0:te.data)==null?void 0:ce.current_page)>=v,hasPrevPage:(x=(ie=s==null?void 0:s.data)==null?void 0:ie.data)==null?void 0:x.current_page})})]})})})]})})]})}const fa=z().shape({name:T().required("Full Name is required"),mobile:T().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:T().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:T().email("Enter a valid email").required("Email is required"),address:T().required("Address is required"),photo:T().required("User Image is required")});function Na({open:a,setOpen:v,title:O,edit:i,setEdit:f,adminListFun:$,id:y,ulbId:L}){const M=J({}),R=t.useRef(null),S=se({defaultValues:{name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:le(fa)}),{reset:q}=S;t.useEffect(()=>{var p,E,A;if(a){if(i&&y){const m=(A=(E=(p=$==null?void 0:$.data)==null?void 0:p.data)==null?void 0:E.data)==null?void 0:A.find(D=>D.id==y);console.log(m,"selectedAdmin"),m&&q({name:m.name||"",mobile:m.mobile||"",altMobile:m.alternateMobile||"",email:m.email||"",address:m.address||"",photo:null})}else q({name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});S.setValue("photo",""),R.current&&(R.current.value="")}},[a,i,y,$,q,S]);const N=async p=>{var E,A,m,D,j;try{const h=i?(E=F)==null?void 0:E.updateAdmin:(A=F)==null?void 0:A.createAdmin,d=i&&y?{...p,id:y}:{...p,userType:"Admin",role:"ADMIN",ulbId:L},n=new FormData;i&&y&&n.append("id",y),n.append("name",d.name),n.append("mobile",d.mobile),n.append("altMobile",d.altMobile),n.append("email",d.email),n.append("address",d.address),n.append("photo",S.watch("photo")),n.append("userType","Admin"),n.append("role","ADMIN"),n.append("ulbId",d.ulbId||"");const g=await M.mutateAsync({api:h,data:n});(m=g==null?void 0:g.data)!=null&&m.status?(w.success((D=g==null?void 0:g.data)==null?void 0:D.message),v(!1),f(!1),$.refetch()):w.error((j=g==null?void 0:g.data)==null?void 0:j.message)}catch(h){w.error(X(h))}};return e.jsx(fe,{open:a,setOpen:v,title:O,setEdit:f,edit:i,children:e.jsx(ge,{methods:S,onSubmit:S.handleSubmit(N),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(ee,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Full Name"})}),e.jsx("div",{children:e.jsx(ee,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter Mobile No "})}),e.jsx("div",{children:e.jsx(ee,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter Alt Mobile No "})}),e.jsx("div",{children:e.jsx(ee,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(ee,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Fe,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(ae,{}),e.jsx("div",{children:e.jsx(Re,{isLoading:S.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function ya(a){var r,s,o,V,b,C,W,U,I,Z,ne,re,P,te,ce,ie;const[v,O]=t.useState(1),[i,f]=t.useState(10),$=J({}),[y,L]=t.useState(!1),[M,R]=t.useState(""),[S,q]=t.useState(!1),[N,p]=t.useState(!1),[E,A]=t.useState(""),[m,D]=t.useState(""),[j,h]=t.useState(""),d=x=>{A(x)},n=x=>{D(x.target.value)};t.useEffect(()=>{const x=setTimeout(()=>{h(m)},700);return()=>clearTimeout(x)},[m]);const g=H({api:(r=F)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),l=H({api:(s=F)==null?void 0:s.adminList,key:"adminListFun",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:i,parameter:j||"",filterBy:E||""},value:[v,i,E],options:{enabled:!0}});t.useEffect(()=>{j&&(O(1),f(10)),l.refetch()},[j]);const u=async(x,c)=>{var B,Y,ye,ve;try{const Ne={id:x,isSuspended:c},G=await $.mutateAsync({api:(B=F)==null?void 0:B.enableDisableUserByModule,data:Ne});(Y=G==null?void 0:G.data)!=null&&Y.status?(w.success(((ye=G==null?void 0:G.data)==null?void 0:ye.message)||"Permission updated successfully"),l.refetch()):w.error(((ve=G==null?void 0:G.data)==null?void 0:ve.message)||"Failed to update permission")}catch(Ne){w.error(X(Ne))}};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:N,children:[e.jsx(Ce,{}),e.jsx(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsx("div",{children:e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:(o=a==null?void 0:a.selectedULB)==null?void 0:o.ulb_name})]})}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>p(!1)})})})]})})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{R(""),q(!1),L(!0)},children:"Create Admin"})})}),e.jsx(Na,{open:y,setOpen:L,title:S?"Edit Admin":"Create Admin",id:M,edit:S,setEdit:q,ulbId:a==null?void 0:a.ulbId,adminListFun:l,adminListData:(b=(V=l==null?void 0:l.data)==null?void 0:V.data)==null?void 0:b.data}),e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:E,onChange:x=>d(x.target.value),className:"cursor-pointer w-[200px] bg-background border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:m,onChange:n,placeholder:`Search by ${E}`,className:"border p-2 rounded-md",maxLength:E=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Records : ",(W=(C=l==null?void 0:l.data)==null?void 0:C.data)==null?void 0:W.total]}),e.jsx(oe,{className:"",children:e.jsx(ue,{children:g.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"User Image"}),e.jsx(_,{className:"",children:"Name"}),e.jsx(_,{className:"",children:"Mobile No"}),e.jsx(_,{className:"",children:"Alt Mobile No"}),e.jsx(_,{className:"",children:"Email"}),e.jsx(_,{className:"",children:"Address"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Action"})]})}),e.jsx(je,{children:(Z=(I=(U=l==null?void 0:l.data)==null?void 0:U.data)==null?void 0:I.data)==null?void 0:Z.map((x,c)=>e.jsxs(K,{children:[e.jsx(k,{children:v*i-i+c+1}),e.jsx(k,{children:e.jsx(qe,{src:x.documentUrl,alt:x.name,className:"w-10 h-10 border-2 rounded-full object-cover"})}),e.jsx(k,{className:x.suspended?"text-red-600":"text-black",children:x==null?void 0:x.name}),e.jsx(k,{className:x.suspended?"text-red-600":"text-black",children:x==null?void 0:x.mobile}),e.jsx(k,{className:x.suspended?"text-red-600":"text-black",children:x==null?void 0:x.alternateMobile}),e.jsx(k,{className:x.suspended?"text-red-600":"text-black",children:x==null?void 0:x.email}),e.jsx(k,{className:x.suspended?"text-red-600":"text-black",children:x==null?void 0:x.address}),e.jsx(k,{children:e.jsxs(Te,{checked:x==null?void 0:x.suspended,onChange:()=>u(x.id,!x.suspended),className:`${x!=null&&x.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${x!=null&&x.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{R(x==null?void 0:x.id),q(!0),L(!0)},children:[e.jsx(be,{})," Edit"]})})]},x==null?void 0:x.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Ve,{page:v,perPage:i,totalPage:(re=(ne=l==null?void 0:l.data)==null?void 0:ne.data)==null?void 0:re.total,setPage:O,setPerPage:f,hasNextPage:((te=(P=l==null?void 0:l.data)==null?void 0:P.data)==null?void 0:te.current_page)>=v,hasPrevPage:(ie=(ce=l==null?void 0:l.data)==null?void 0:ce.data)==null?void 0:ie.current_page})})]})})})]})})}const va=z().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function Sa(){var b,C,W,U,I,Z,ne,re;const[a,v]=t.useState(1),[O,i]=t.useState(10),[f,$]=t.useState(!1),y=J({}),[L,M]=t.useState(!1),[R,S]=t.useState(""),[q,N]=t.useState(!1),[p,E]=t.useState(""),[A,m]=t.useState(1),[D,j]=t.useState(10),[h,d]=t.useState(!1),n=100,g=P=>{m(P)},l=P=>{j(P),m(1)},u=se({resolver:le(va),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),r=async P=>{E(P.moduleId)},s=H({api:(b=F)==null?void 0:b.getAllJuidcoUlbList,key:"ulbLists",options:{enabled:!0}});console.log((C=s==null?void 0:s.data)==null?void 0:C.data),console.log(p);const o=async(P,te)=>{var ce,ie,x,c;try{const B={ulbId:P,permissionStatus:te},Y=await y.mutateAsync({api:(ce=F)==null?void 0:ce.ulbEnableDisable,data:B});(ie=Y==null?void 0:Y.data)!=null&&ie.status?(w.success(((x=Y==null?void 0:Y.data)==null?void 0:x.message)||"Permission updated successfully"),s.refetch()):w.error(((c=Y==null?void 0:Y.data)==null?void 0:c.message)||"Failed to update permission")}catch(B){w.error(X(B))}},V=(U=(W=s==null?void 0:s.data)==null?void 0:W.data)==null?void 0:U.filter(P=>P.id==p);return e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:h,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:f==null?void 0:f.ulb_name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>d(!1)})})})]}),e.jsxs(ze,{defaultValue:"MENULIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsxs(Ge,{className:"grid w-auto grid-cols-3",children:[e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Permitted Modules"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"SERVICE_LIST",children:"User List"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"ADMIN_LIST",children:"Admin List"})]})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(ta,{ulbId:f==null?void 0:f.id,selectedULB:f})}),e.jsx(Pe,{value:"SERVICE_LIST",children:e.jsx(ba,{ulbId:f==null?void 0:f.id,selectedULB:f})}),e.jsx(Pe,{value:"ADMIN_LIST",children:e.jsx(ya,{ulbId:f==null?void 0:f.id,selectedULB:f})})]})]})]}),e.jsxs(oe,{children:[e.jsx(ge,{methods:u,onSubmit:u.handleSubmit(r),children:e.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[e.jsxs("div",{children:[e.jsx(Xe,{htmlFor:"moduleId",children:"Module name"}),e.jsx(Ye,{className:"cursor-pointer bg-background",name:"moduleId",data:((Z=(I=s==null?void 0:s.data)==null?void 0:I.data)==null?void 0:Z.map(P=>({value:P==null?void 0:P.id,label:P==null?void 0:P.ulb_name})))??[]})]}),e.jsx("div",{className:"mt-6 flex justify-start",children:e.jsx(Re,{variant:"secondary",isLoading:u.formState.isSubmitting,type:"submit",className:"float-right w-auto px-10",children:"Search"})}),e.jsx("div",{className:"mt-6 flex justify-end "}),e.jsx("div",{className:"mt-6 flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{S(""),N(!1),M(!0)},children:"Add New"})})]})}),e.jsx(We,{className:"px-7",children:e.jsx(Ue,{})}),e.jsx(ue,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(xe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"ULB"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(je,{children:(re=(V==null?void 0:V.length)>0?V:(ne=s==null?void 0:s.data)==null?void 0:ne.data)==null?void 0:re.map((P,te)=>e.jsxs(K,{children:[e.jsx(k,{children:a*O-O+te+1}),e.jsx(k,{className:P.active_status?"text-black":"text-red-600",children:P==null?void 0:P.ulb_name}),e.jsx(k,{children:e.jsxs(Te,{checked:P==null?void 0:P.active_status,onChange:()=>o(P.id,!P.active_status),className:`${P!=null&&P.active_status?"bg-green-600":"bg-red-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${P!=null&&P.active_status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{S(P==null?void 0:P.id),$(P),d(!0)},className:"ml-2",children:[e.jsx(_e,{})," View"]})})]},P==null?void 0:P.id))})]}),e.jsx(ae,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ke,{currentPage:A,totalItems:n,itemsPerPage:D,onPageChange:g,onItemsPerPageChange:l})})]})})]})]})})}function Fa(){return e.jsx(Oe,{title:"ULB List",subTitle:"Control all ULB here",children:e.jsx("div",{children:e.jsx(Sa,{})})})}export{Fa as default};
