import{j as e,r as u,G as E,c as D,a as P,L as G,b as x,Q as b,A as O}from"./index-dd1288ad.js";import{P as W}from"./Page-c37fa378.js";import{B as Y}from"./Breadcrumb-5eaf1e4d.js";import{S as h,a as k,L as Q}from"./LoadingButton-8b46375a.js";import"./TextField-b2648471.js";import{C as U}from"./index-20c391bc.js";import{u as Z,F as J,a as K}from"./formik.esm-5fbe598e.js";import{c as X,a as f}from"./index.esm-e655e2bf.js";function V(p){const{formik:r,feeHeadTypeList:c,financialList:m,classList:n,feeHeadNameList:i}=p;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"px-6 mt-2 grid grid-cols-12 lg:grid-cols-3 gap-4 ",children:[e.jsx("div",{className:"mt-2",children:e.jsx(h,{name:"fyId",label:"Select Financial Year",formik:r,isRequiredLabel:!0,size:"xs",children:m&&(m==null?void 0:m.map(t=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.financial_year})))})}),e.jsx("div",{className:"mt-2 ",children:e.jsx(h,{name:"classId",label:"Select Class",formik:r,isRequiredLabel:!0,size:"xs",children:n&&(n==null?void 0:n.map(t=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.class_name})))})}),e.jsx("div",{div:!0,className:"mt-2 ",children:e.jsx(h,{name:"feeHeadType",label:"Select Fee Head Type",formik:r,isRequiredLabel:!0,size:"xs",children:c&&(c==null?void 0:c.map(t=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.fee_head_type})))})}),e.jsx("div",{div:!0,className:"mt-2 ",children:e.jsx(h,{name:"feeHeadName",label:"Select Fee Head Name",formik:r,isRequiredLabel:!0,size:"xs",children:i&&(i==null?void 0:i.map(t=>{if((t==null?void 0:t.id)!==1)return e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.fee_head_name})}))})}),e.jsx("div",{div:!0,className:"mt-2 ",children:e.jsx(k,{type:"number",name:"feeAmount",label:"Fee Amount",placeholder:"Enter Fee Amount",formik:r,isRequiredLabel:!0,size:"xs"})}),e.jsx("div",{div:!0,className:"mt-2 ",children:e.jsx(k,{type:"text",name:"description",label:"Description",placeholder:"Description (Optional)",formik:r,size:"xs"})})]})})}function ee(p){const{formik:r,months:c}=p;u.useEffect(()=>{r.setFieldValue("datas",c.map(n=>(console.log("fhaskjdfhadsjkfhlkasjdfhlkaj",n),{...n,inputValue:1})))},[c]),console.log("heloow month",c);const m=()=>{var i,t;const n=(t=(i=r==null?void 0:r.values)==null?void 0:i.datas)==null?void 0:t.map(a=>r.values.feeHeadType==1?{...a,inputValue:(a==null?void 0:a.month_name)=="August"||(a==null?void 0:a.month_name)=="March"||(a==null?void 0:a.month_name)=="December"?1:0}:r.values.feeHeadType==2?{...a,inputValue:1}:r.values.feeHeadType==3?{...a,inputValue:(a==null?void 0:a.month_name)=="April"?1:0}:{...a,inputValue:0});r.setFieldValue("datas",n)};return u.useEffect(()=>{m()},[r.values.feeHeadType]),e.jsx(e.Fragment,{children:r.values.datas.length>0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"border border-gray-300 mx-6 py-5 my-10 flex items-center justify-center flex-wrap",children:r.values.datas.map((n,i)=>{var t;if(console.log("hello each",n),(n==null?void 0:n.inputValue)==1)return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-[30vh] my-4",children:[e.jsx("h1",{className:"text-[1.8vh] mx-4 px-4  bg-gradient-to-r from-[#ccfbf1] w-[15vh]",children:n==null?void 0:n.month_name}),e.jsxs("h1",{children:[e.jsx("input",{...r.getFieldProps(`datas.${i}.inputValue`),value:n==null?void 0:n.datas,checked:((t=r.values.datas[i])==null?void 0:t.inputValue)==1,onChange:()=>r.setFieldValue(`datas.${i}.inputValue`,n!=null&&n.inputValue?0:1),type:"checkbox",disabled:!0,className:"h-4 w-4 m-1  bg-gradient-to-r from-indigo-300"})," "]})]})})})})}):null})}function se({setOpen:p,open:r}){return e.jsx(U,{isOpen:r,children:e.jsx("div",{id:"defaultModal",tabIndex:-1,"aria-hidden":"true",className:" h-[calc(100%-1rem)] max-h-full ",children:e.jsx("div",{className:" w-full max-w-2xl max-h-full",children:e.jsxs("div",{className:" bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Instruction"}),e.jsxs("button",{onClick:()=>p(!1),type:"button",className:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"defaultModal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("p",{className:"text-base leading-relaxed text-gray-500 dark:text-gray-400",children:"Step 1: select financial year, class, fee head type to know nature of fees."}),e.jsx("p",{className:"text-base leading-relaxed text-gray-500 dark:text-gray-400",children:"Step 2: select fee head name and enter amount. Description box is not mandatory but you can add some description for future reference.."}),e.jsx("p",{className:"text-base leading-relaxed text-gray-500 dark:text-gray-400",children:"Step 3: choose month by click on check box or can select multiple months by using check all button. To clear check box click on clear all button."}),e.jsx("p",{className:"text-base leading-relaxed text-gray-500 dark:text-gray-400",children:"Step 4: after this all steps click on save button"})]})]})})})})}function te(p){return E({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",stroke:"#000",strokeWidth:"2",d:"M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,10 L12,18 M12,6 L12,8"}}]})(p)}function pe(){const{bgSideBar:p}=D(),{api_feeheadtype:r,api_feeheadname:c,api_class:m,api_financialYear:n,api_fetchmonth:i,api_classfeeadd:t}=O;P();const[a,g]=u.useState(!0),[N,y]=u.useState(!1),[w,v]=u.useState(),[j,re]=u.useState([]),[S,C]=u.useState(),[L,H]=u.useState(),[I,_]=u.useState(),M=X({fyId:f().required("Required"),classId:f().required("Required"),feeHeadType:f().required("Required"),feeHeadName:f().required("Required"),feeAmount:f().required("Required")}),o=Z({initialValues:{fyId:1,classId:1,feeHeadType:"",feeHeadName:"",feeAmount:"",description:"",datas:[]},onSubmit:async(s,{setSubmitting:d})=>{var F;let B=(F=s==null?void 0:s.datas)==null?void 0:F.filter(l=>l.inputValue==1).map(l=>({monthId:l==null?void 0:l.id,isMothChecked:l==null?void 0:l.inputValue,monthName:l==null?void 0:l.month_name,fyId:s==null?void 0:s.fyId,classId:s==null?void 0:s.classId,feeHeadTypeId:s==null?void 0:s.feeHeadType,feeHeadId:s==null?void 0:s.feeHeadName,feeAmount:(l==null?void 0:l.inputValue)==1?s.feeAmount:0,description:s==null?void 0:s.description}));q(B)},validationSchema:M}),q=async s=>{o==null||o.setSubmitting(!0);try{const d=await x.post(`${t}`,{datas:s});d.data.status?b.success(d.data.message):b.error(d.data.message)}catch(d){console.log(d),b.error(d==null?void 0:d.error)}o==null||o.setSubmitting(!1)},A=async()=>{try{const s=await x.post(`${r}`,{});s.status==200&&(console.log(s.data),v(s.data.data))}catch(s){console.log(s)}},T=async()=>{try{const s=await x.post(`${c}`,{});s.status==200&&(console.log(s.data),C(s.data.data))}catch(s){console.log(s)}},R=async()=>{try{const s=await x.post(`${m}`,{});s.status==200&&(console.log(s.data),_(s.data.data))}catch(s){console.log(s)}},$=async()=>{try{const s=await x.post(`${n}`,{});s.status==200&&(console.log(s.data),H(s.data.data))}catch(s){console.log(s)}},z=async()=>{try{g(!0);const s=await x.post(`${i}`,{});s.status==200&&(console.log(s.data),o==null||o.setFieldValue("datas",s.data.data.map(d=>({...d,inputValue:0})))),g(!1)}catch(s){console.log(s),g(!1)}};return console.log(j),u.useEffect(()=>{A(),T(),R(),$(),z()},[]),console.log(w,j),e.jsxs(e.Fragment,{children:[e.jsx(se,{setOpen:y,open:N}),e.jsxs(W,{title:"Fee",pageName:"Class Fee Master",children:[e.jsx(Y,{list:[{title:"Home",path:"/home"},{title:"Class fee master list",path:"/fee/table-view"},{title:"Class fee master",path:"/fee/add"}]}),a?e.jsx(G,{}):e.jsx("div",{className:" w-full p-7",children:e.jsxs("div",{className:"  rounded-lg shadow ",children:[e.jsxs("div",{className:`flex items-center justify-between py-3 px-4 border-b rounded-t ${p}`,children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-100 ",children:"Class Wise Fee Master"}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(te,{className:"cursor-pointer text-white",color:"white",size:25,onClick:()=>y(!0)})})]}),e.jsx("div",{className:"w-[100%]",children:e.jsx(J,{value:o,children:e.jsxs(K,{autoComplete:"off",onSubmit:o.handleSubmit,children:[e.jsx(V,{formik:o,feeHeadTypeList:w,financialList:L,classList:I,open:N,setOpen:y,feeHeadNameList:S}),e.jsx(ee,{formik:o,months:j}),e.jsx("div",{className:"flex items-center justify-center mt-1 mb-5 w-full",children:e.jsxs(Q,{color:"primary",type:"submit",className:"rounded-lg",isLoading:o.isSubmitting,size:"xs",children:[" ","Save"," "]})})]})})})]})})]})]})}export{pe as default};
