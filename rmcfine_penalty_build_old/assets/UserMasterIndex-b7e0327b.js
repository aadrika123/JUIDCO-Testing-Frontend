import{r as n,j as t,n as K}from"./index-faef4408.js";import{L as Q}from"./ListTable-8d07bfdb.js";import{C as W}from"./index.esm-e7b598de.js";import{A as F}from"./ApiHeader-6d683756.js";import{u as Fe}from"./useSetTitle-78d55b86.js";import{A}from"./AxiosInterceptors-06ddb7df.js";import{P as Ae}from"./ProjectApiList-919c817c.js";import{n as h,i as X,c as z,a as Ee,b as Re}from"./PowerupFunctions-1c006beb.js";import{S as v}from"./ShimmerEffectInline-e1eb703f.js";import{B as $e}from"./BarLoader-56cc2b49.js";import{B as ze}from"./BottomErrorCard-6b93cab8.js";import{R as He}from"./index.esm-52d56c4d.js";import{c as Me,a as Pe,u as Ve}from"./formik.esm-f68c633c.js";import{F as Ie}from"./index.esm-13201a46.js";import{A as qe}from"./ApiHeader2-b363f7b8.js";import"./index-b7057102.js";import"./index-eab1d8e2.js";import"./index.esm-03dcecfa.js";import"./iconBase-74df04d3.js";import"./index-cc999471.js";const lr=()=>{Fe("Violation Master");const{api_addRole:ee,api_updateRole:re,api_deletedRole:te,api_listRole:H,api_addUser:se,api_updateUser:ie,api_deletedUser:oe,api_listUser:le,api_assignRole:ae}=Ae(),f=n.useRef(),[b,N]=n.useState(!1),[ne,M]=n.useState(!1),[de,ce]=n.useState(""),[me,pe]=n.useState(!1),[c,xe]=n.useState(""),[E,P]=n.useState(null),[w,j]=n.useState([]),[m,he]=n.useState([]),[d,R]=n.useState(null),[fe,V]=n.useState(!1),[s,I]=n.useState("role"),[y,q]=n.useState(null),[C,U]=n.useState(null),[B,k]=n.useState(null),L="border border-sky-800 text-sky-800 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white",ge="border border-amber-700 text-amber-700 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-amber-700 hover:text-white",T="border border-red-400 text-red-400 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-red-800 hover:text-white",D="float-right bg-[#1A4D8C] px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-[#113766] hover:text-white text-white flex items-center",ue="text-gray-800 text-sm",G="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm",be="block w-full border focus:outline-none drop-shadow-sm focus:drop-shadow-md p-1 text-sm text-slate-500 file:mr-4 file:py-1 file:px-4 file:rounded-sm file:border file:text-xs file:font-semibold file:bg-zinc-100 hover:file:bg-zinc-200",we=e=>`px-4 py-1 text-sm bg-${e}-500 hover:bg-${e}-600 select-none rounded-sm hover:drop-shadow-md text-white`,O=e=>`border border-slate-700 ${e?"bg-slate-700 text-white":"text-slate-700 shadow-2xl shadow-slate-700"} mx-1 px-3 py-1 rounded-sm hover:bg-slate-700 hover:text-white text-sm`,g=(e,r)=>{pe(e),ce(r)},u=(e,r=null)=>{switch(xe(e),e){case"add":break;case"edit":R(r),s=="role"&&l.setFieldValue("role",r==null?void 0:r.role_name),s=="user"&&(l.setFieldValue("firstName",(r==null?void 0:r.first_name)||""),l.setFieldValue("middleName",(r==null?void 0:r.middle_name)||""),l.setFieldValue("lastName",(r==null?void 0:r.last_name)||""),l.setFieldValue("mobileNo",r==null?void 0:r.mobile),l.setFieldValue("email",r==null?void 0:r.email),l.setFieldValue("designation",r==null?void 0:r.designation),l.setFieldValue("employeeCode",r==null?void 0:r.employee_code),l.setFieldValue("address",r==null?void 0:r.address),l.setFieldValue("signature",r==null?void 0:r.signature),l.setFieldValue("profile",r==null?void 0:r.profile_image));break;case"delete":P(r);break;case"assign":R(r),P(r==null?void 0:r.id),k((r==null?void 0:r.wf_role_id)||"");break}f.current.showModal()},Ne=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Roles",accessor:"role_name",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.role_name)}},{Header:"Created At",accessor:"date",Cell:({cell:e})=>{var r;return X((r=e.row.original)==null?void 0:r.date)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>t.jsxs("div",{className:"flex flex-row flex-wrap gap-2",children:[t.jsx("button",{onClick:()=>{var r;return u("edit",(r=e==null?void 0:e.row)==null?void 0:r.original)},className:L,children:"Edit"}),t.jsx("button",{onClick:()=>{var r,i;return u("delete",(i=(r=e==null?void 0:e.row)==null?void 0:r.original)==null?void 0:i.id)},className:T,children:"Delete"})]})}],je=[{Header:"#",Cell:({row:e})=>t.jsx("div",{className:"pr-2",children:(e==null?void 0:e.index)+1})},{Header:"Profile",accessor:"profile",Cell:({cell:e})=>{var r,i;return t.jsx(t.Fragment,{children:(r=e.row.original)!=null&&r.profile_image?t.jsx("img",{className:"border drop-shadow-lg h-8 rounded-sm",src:(i=e.row.original)==null?void 0:i.profile_image,alt:"profile",srcset:""}):"N/A"})}},{Header:"Name",accessor:"user_name",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.user_name)}},{Header:"Role",accessor:"role_name",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.role_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.mobile)}},{Header:"E-mail",accessor:"email",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.email)}},{Header:"Employee Code",accessor:"employee_code",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.employee_code)}},{Header:"Designation",accessor:"designation",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.designation)}},{Header:"Address",accessor:"address",Cell:({cell:e})=>{var r;return h((r=e.row.original)==null?void 0:r.address)}},{Header:"Signature",accessor:"signature",Cell:({cell:e})=>{var r,i;return t.jsx(t.Fragment,{children:(r=e.row.original)!=null&&r.signature?t.jsx("img",{className:"border drop-shadow-lg h-8 rounded-sm",src:(i=e.row.original)==null?void 0:i.signature,alt:"signature",srcset:""}):"N/A"})}},{Header:"Created At",accessor:"date",Cell:({cell:e})=>{var r;return X((r=e.row.original)==null?void 0:r.date)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>t.jsxs("div",{className:"flex items-center flex-wrap flex-row gap-1",children:[t.jsx("button",{onClick:()=>{var r;return u("edit",(r=e==null?void 0:e.row)==null?void 0:r.original)},className:L,children:"Edit"}),t.jsx("button",{onClick:()=>{var r,i;return u("delete",(i=(r=e==null?void 0:e.row)==null?void 0:r.original)==null?void 0:i.id)},className:T,children:"Delete"}),t.jsx("button",{onClick:()=>{var r;return u("assign",(r=e==null?void 0:e.row)==null?void 0:r.original)},className:ge,children:"Assign Role"})]})}],_=[{title:"Role",key:"role",width:` w-full ${s=="role"?"block ":"hidden "}`,type:s=="role"?"text":"select",hint:"Enter role",required:!0,options:m,okey:"id",ovalue:"role_name",required:s=="role"&&!0},{title:"First Name",key:"firstName",width:`md:w-[31%] w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter first name",required:s=="user"&&!0},{title:"Middle Name",key:"middleName",width:`md:w-[31%] w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter middle name",required:!1},{title:"Last Name",key:"lastName",width:`md:w-[31%] w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter last name",required:s=="user"&&!0},{title:"Mobile No.",key:"mobileNo",width:`md:w-[48%] w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter mobile no.",required:s=="user"&&!0},{title:"E-Mail",key:"email",width:`md:w-[48%] w-full ${s=="user"?"block ":"hidden "}`,type:"email",hint:"Enter email",required:s=="user"&&!0},{title:"Employee Code",key:"employeeCode",width:`md:w-[48%] w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter employee code",required:s=="user"&&!0},{title:"Designation",key:"designation",width:`md:w-[48%] w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter designation",required:s=="user"&&!0},{title:"Upload Profile Picture",key:"profile",width:`md:w-[48%] w-full ${s=="user"?"block ":"hidden "}`,type:"file",hint:"Enter employee code",required:!1},{title:"Upload Signature",key:"signature",width:`md:w-[48%] w-full ${s=="user"?"block ":"hidden "}`,type:"file",hint:"Enter employee code",required:!1},{title:"Address",key:"address",width:` w-full ${s=="user"?"block ":"hidden "}`,type:"text",hint:"Enter address",required:s=="user"&&!0}],ye=Me().shape([..._].reduce((e,r)=>(r!=null&&r.required&&(e[r.key]=Pe().required(r==null?void 0:r.hint)),e),{})),l=Ve({initialValues:{role:"",firstName:"",middleName:"",lastName:"",mobileNo:"",email:"",designation:"",employeeCode:"",address:"",signature:"",profile:""},enableReinitialize:!0,validationSchema:ye,onSubmit:e=>{J(e)}}),$=()=>{j([]),N(!0);let e;s=="role"&&(e=H),s=="user"&&(e=le),A.post(e,{},F()).then(r=>{var i,o,a;(i=r==null?void 0:r.data)!=null&&i.status?j((o=r==null?void 0:r.data)==null?void 0:o.data):(g(!0,z((a=r==null?void 0:r.data)==null?void 0:a.message)),j([]))}).catch(r=>{g(!0,"Server Error! Please try again later."),j([])}).finally(()=>{N(!1),R(null),q(null),U(null),k(null),f.current.close()})},Ce=(e,r="",i,o="",a="",p=!1,x=[],S="",Se="")=>t.jsxs("div",{className:`flex flex-col ${o} `,children:[r!=""&&t.jsxs("label",{htmlFor:e,className:ue,children:[r," ",p&&t.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),i!="select"&&i!="file"&&t.jsx("input",{...l.getFieldProps(e),type:i,className:G+` ${l.touched[e]&&l.errors[e]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:e,id:"",placeholder:a,pattern:"^[a-zA-Z0-9@\\s.]*$",title:"Special characters are not allowed"}),i=="file"&&t.jsx("input",{type:"file",className:be+`${l.touched[e]&&l.errors[e]?" border-red-200 placeholder:text-red-400 text-red-400 file:border-red-200 file:text-red-400":" focus:border-zinc-300 border-zinc-200 file:border-zinc-300 file:text-gray-600"}`,name:e,id:"",placeholder:a,accept:".jpg, .jpeg, .png"}),i=="select"&&t.jsx("select",{...l.getFieldProps(e),className:G+` ${l.touched[e]&&l.errors[e]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:fe?t.jsx("option",{children:"Loading..."}):t.jsxs(t.Fragment,{children:[t.jsx("option",{value:null,children:"Select"}),typeof x=="object"&&(x==null?void 0:x.map(Z=>t.jsx("option",{className:"",value:Z[S],children:Z[Se]})))]})})]}),J=e=>{M(!0),f.current.close();let r,i,o=new FormData;switch(c){case"add":s=="role"&&(r={roleName:e==null?void 0:e.role},i=ee),s=="user"&&(o.append("firstName",e==null?void 0:e.firstName),o.append("middleName",e==null?void 0:e.middleName),o.append("lastName",e==null?void 0:e.lastName),o.append("mobileNo",e==null?void 0:e.mobileNo),o.append("email",e==null?void 0:e.email),o.append("designation",e==null?void 0:e.designation),o.append("employeeCode",e==null?void 0:e.employeeCode),o.append("address",e==null?void 0:e.address),y&&o.append("signature",y),C&&o.append("profile",C),i=se);break;case"edit":s=="role"&&(r={roleId:d==null?void 0:d.id,roleName:e==null?void 0:e.role},i=re),s=="user"&&(o.append("userId",d==null?void 0:d.id),o.append("firstName",e==null?void 0:e.firstName),o.append("middleName",e==null?void 0:e.middleName),o.append("lastName",e==null?void 0:e.lastName),o.append("mobileNo",e==null?void 0:e.mobileNo),o.append("email",e==null?void 0:e.email),o.append("designation",e==null?void 0:e.designation),o.append("employeeCode",e==null?void 0:e.employeeCode),o.append("address",e==null?void 0:e.address),y&&o.append("signature",y),C&&o.append("profile",C),i=ie);break;case"delete":s=="role"&&(i=te,r={roleId:E}),s=="user"&&(i=oe,o.append("userId",E));break}A.post(i,s=="user"?o:r,s=="user"?qe():F()).then(a=>{var p,x,S;(p=a==null?void 0:a.data)!=null&&p.status?(K.success((x=a==null?void 0:a.data)==null?void 0:x.message),$()):g(!0,z((S=a==null?void 0:a.data)==null?void 0:S.message))}).catch(a=>{g(!0,"Server Error! Please try again later.")}).finally(()=>{M(!1),l.resetForm()})},ke=()=>{V(!0),A.post(H,{},F()).then(e=>{var r,i;(r=e==null?void 0:e.data)!=null&&r.status&&he((i=e==null?void 0:e.data)==null?void 0:i.data)}).catch(e=>{}).finally(()=>{V(!1)})},Y=e=>{var a;const r=e.target.name,i=e.target.value;if(r=="mobileNo"&&l.setFieldValue("mobileNo",Ee(i,l.values.mobileNo,10)),r==="signature"||r==="profile"){let p=(a=e==null?void 0:e.target)==null?void 0:a.files[0];if(!o(p)){alert("Please select a PNG, JPG, or JPEG file."),e.target.value="";return}if(!Re(p)){l.setFieldValue(r,"");return}r==="signature"?q(p):r==="profile"&&U(p)}function o(p){return p?["image/png","image/jpeg","image/jpg"].includes(p.type):!1}r=="roleAssign"&&k(i)},_e=()=>{N(!0);let e={userId:E,roleId:B};A.post(ae,e,F()).then(r=>{var i,o;(i=r==null?void 0:r.data)!=null&&i.status?(K.success("Role Assigned Successfully !!!"),$()):g(!0,z((o=r==null?void 0:r.data)==null?void 0:o.message))}).catch(r=>{g(!0,"Server Error! Please try again later.")}).finally(()=>{N(!1),f.current.close()})};return n.useEffect(()=>{s!="department"&&ke(),$()},[s]),t.jsxs(t.Fragment,{children:[ne&&t.jsx($e,{}),me&&t.jsx(ze,{activateBottomErrorCard:g,errorTitle:de}),t.jsxs("div",{className:"poppins p-4 px-6",children:[t.jsx("div",{className:"uppercase font-semibold text-gray-700 text-2xl py-2 text-center tracking-[0.5rem]",children:"User Role Master"}),t.jsx("div",{className:"w-full h-[0.15rem] bg-gray-400 mb-6"}),t.jsxs("div",{className:"flex gap-1 w-full flex-wrap my-6",children:[t.jsx("button",{onClick:()=>I("role"),className:O(s=="role"),children:"Role Master"}),t.jsx("button",{onClick:()=>I("user"),className:O(s=="user"),children:"User Master"})]}),b&&t.jsx(v,{}),!b&&t.jsx(t.Fragment,{children:(w==null?void 0:w.length)>0?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>u("add"),className:D+"capitalize flex gap-1 items-center",children:[t.jsx(W,{})," Add ",t.jsx("span",{className:"capitalize",children:s})]}),s=="role"&&t.jsx(Q,{columns:Ne,dataList:w}),s=="user"&&t.jsx(Q,{columns:je,dataList:w})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex justify-end mb-2",children:t.jsxs("button",{onClick:()=>u("add"),className:D+"capitalize flex gap-1 items-center",children:[t.jsx(W,{})," Add ",t.jsx("span",{className:"capitalize",children:s})]})}),t.jsx("div",{className:"bg-red-100 text-red-500 py-2 text-lg font-semibold text-center border border-red-500 drop-shadow-sm",children:"Oops! No Data Found."})]})})]}),t.jsxs("dialog",{ref:f,className:`relative overflow-clip animate__animated animate__zoomIn animate__faster w-full ${s=="role"&&"md:w-[21rem]"} ${s=="user"&&c!="delete"&&"md:w-[50rem]"} ${c=="delete"&&"md:w-[21rem]"} ${c=="assign"&&"md:w-[40rem]"}`,children:[c!="delete"&&t.jsx("span",{onClick:()=>(f.current.close(),l.resetForm(),k(null)),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:t.jsx(He,{})}),c!="delete"&&c!="assign"&&t.jsxs("form",{onChange:e=>(l.handleChange(e),Y(e)),onSubmit:l.handleSubmit,className:"p-4 px-8 py-6 shadow-lg",children:[t.jsxs("section",{className:"flex flex-row justify-between gap-4 flex-wrap",children:[t.jsxs("header",{className:"w-full font-semibold text-xl capitalize text-sky-700 border-b pb-1 text-center",children:[c," ",s]}),c=="edit"&&s=="user"&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full grid grid-cols-12 items-center gap-4 mb-4 mt-2",children:[t.jsxs("div",{className:"md:col-span-6 col-span-12 flex gap-2 items-center flex-wrap text-sm",children:["Profile Image : ",t.jsx("img",{src:(d==null?void 0:d.profile_image)||"",className:"ml-4 h-20 border drop-shadow-md rounded-sm p-1",alt:"Profile",srcset:""})]}),t.jsxs("div",{className:"md:col-span-6 col-span-12 flex gap-2 items-center flex-wrap text-sm",children:["Signature : ",t.jsx("img",{src:(d==null?void 0:d.signature)||"",className:"ml-4 h-20 border drop-shadow-md rounded-sm p-1",alt:"Signature",srcset:""})]})]})}),_==null?void 0:_.map(e=>Ce(e==null?void 0:e.key,e==null?void 0:e.title,e==null?void 0:e.type,e==null?void 0:e.width,e==null?void 0:e.hint,e==null?void 0:e.required,e==null?void 0:e.options,e==null?void 0:e.okey,e==null?void 0:e.ovalue))]}),t.jsx("footer",{className:"mt-4 flex justify-center",children:t.jsxs("button",{type:"submit",className:we("green"),children:[c=="add"&&"Add",c=="edit"&&"Update"]})})]}),c=="delete"&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:" z-50 px-6 py-4 flex flex-col gap-4 ",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsx("span",{className:"text-red-500 bg-red-100 p-2 block rounded-full drop-shadow-md shadow-red-300",children:t.jsx(Ie,{size:25})}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("span",{className:"text-xl font-semibold border-b pb-1",children:"Confirmation"}),t.jsx("span",{className:"text-base",children:"Are you sure want to delete ?"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{className:"text-white bg-slate-400 hover:bg-slate-500 px-4 py-1 text-sm ",onClick:()=>f.current.close(),children:"No"}),t.jsx("button",{className:"text-white bg-red-500 hover:bg-red-600 px-4 py-1 text-sm ",onClick:()=>J(),children:"Yes"})]})]})}),c=="assign"&&t.jsx(t.Fragment,{children:t.jsxs("div",{className:"p-4 px-8 py-6 shadow-lg",children:[t.jsxs("header",{className:"w-full font-semibold text-xl capitalize text-sky-700 border-b pb-1 mt-4 text-center",children:["Assign Role to ",t.jsx("span",{className:"text-amber-600",children:d==null?void 0:d.user_name})]}),!b&&Array.isArray(m)&&(m==null?void 0:m.length)>0&&t.jsx("div",{className:" mt-4 animate__animated animate__fadeIn animate__faster",children:t.jsx("button",{onClick:()=>_e(),className:"float-right bg-green-500 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-green-600 hover:text-white text-white flex items-center mb-1",children:"Assign"})}),t.jsxs("div",{className:"flex flex-col h-[40vh] w-full overflow-y-auto md:overflow-x-hidden mt-6",children:[t.jsxs("div",{className:"w-full grid grid-cols-12 items-center gap-2 bg-slate-500 text-white font-semibold border border-slate-200 px-4 py-2",children:[t.jsx("div",{className:"col-span-3",children:"Sl. No."}),t.jsx("div",{className:"col-span-6",children:"Role Name"}),t.jsx("div",{className:"col-span-3 text-end",children:t.jsx("span",{children:"Action"})})]}),b&&t.jsx(v,{}),!b&&Array.isArray(m)&&(m==null?void 0:m.map((e,r)=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full grid grid-cols-12 items-center gap-2 bg-slate-100 border-b hover:bg-white pb-1 p-4 animate__animated animate__fadeIn animate__faster",children:[t.jsx("div",{className:"col-span-1",children:r+1}),t.jsx("div",{className:"col-span-10",children:e==null?void 0:e.role_name}),t.jsx("div",{className:"col-span-1",children:t.jsx("label",{class:"inline-flex items-center px-4",children:t.jsx("input",{type:"radio",name:"roleAssign",checked:B==(e==null?void 0:e.id)||"",value:e==null?void 0:e.id,onChange:Y,class:"cursor-pointer form-radio h-5 w-5 text-slate-800"})})})]},r)}))),!b&&Array.isArray(m)&&(m==null?void 0:m.length)==0&&t.jsx("div",{className:"w-full text-center text-red-400 font-semibold pb-1 p-4",children:"No Roles Available"})]})]})})]})]})};export{lr as default};
