import{a as ie,r as n,j as s,n as oe}from"./index-faef4408.js";import"./index-b7057102.js";import{A as _}from"./ApiHeader-6d683756.js";import{S as P}from"./ShimmerEffectInline-e1eb703f.js";import{A}from"./AxiosInterceptors-06ddb7df.js";import{c as ne,a as le,u as ce}from"./formik.esm-f68c633c.js";import{R as de}from"./index.esm-f80cb93c.js";import{R as he}from"./Hourglass-36f1258b.js";import{P as xe}from"./ProjectApiList-919c817c.js";import{g as H,n as j,d as k,i as pe,c as E}from"./PowerupFunctions-1c006beb.js";import{u as fe}from"./useSetTitle-78d55b86.js";import{F as ue}from"./index.esm-13201a46.js";import{B as me}from"./BottomErrorCard-6b93cab8.js";import{R as ge}from"./index.esm-52d56c4d.js";import{L as be}from"./ListTable-8d07bfdb.js";import"./index-eab1d8e2.js";import"./iconBase-74df04d3.js";import"./index-cc999471.js";import"./index.esm-03dcecfa.js";const He=()=>{var z,V,B;fe("Cash Verification");const{api_cashVerificaionList:M,api_cashVerificaionById:L,api_verifyCash:$}=xe();ie();const m=n.useRef(),q=[{Header:"Sl.No.",Cell:({row:e})=>s.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Officer Name",accessor:"officer_name",Cell:({cell:e})=>{var t;return j((t=e.row.original)==null?void 0:t.officer_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:e})=>{var t;return j((t=e.row.original)==null?void 0:t.mobile)}},{Header:"Total Amount",accessor:"penalty_amount",Cell:({cell:e})=>{var t;return k((t=e.row.original)==null?void 0:t.penalty_amount)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>s.jsx("div",{className:"flex items-center flex-wrap flex-row gap-1",children:s.jsx("button",{onClick:()=>{var t;return se((t=e==null?void 0:e.row)==null?void 0:t.original)},className:Y,children:"View"})})}];n.useState({}),n.useState(0);const[N,I]=n.useState(!1),[a,O]=n.useState(null),[G,W]=n.useState(""),[J,K]=n.useState(!1),[x,g]=n.useState([]),[d,Q]=n.useState([]),[w,C]=n.useState(!1),[b,y]=n.useState(!1),[i,U]=n.useState(null),X="text-gray-800 text-sm",F="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm focus:outline-none",Y="border border-sky-800 text-sky-800 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white focus:outline-none",v=[{title:"Date",key:"date",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""}],Z=(e,t="",r,o="",l="",c=!1,h=[],u="",ae="")=>s.jsxs("div",{className:`flex flex-col ${o} `,children:[t!=""&&s.jsxs("label",{htmlFor:e,className:X,children:[t," ",c&&s.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),r!="select"&&r!="file"&&s.jsx("input",{...p.getFieldProps(e),type:r,className:F+` ${p.touched[e]&&p.errors[e]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:e,id:"",placeholder:l}),r=="select"&&s.jsxs("select",{...p.getFieldProps(e),className:F+` ${p.touched[e]&&p.errors[e]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:[s.jsx("option",{value:"",children:"All"}),h==null?void 0:h.map(T=>s.jsx("option",{className:"",value:T[u],children:T[ae]}))]})]}),D=ne().shape([...v].reduce((e,t)=>(t!=null&&t.required&&(e[t.key]=le().required(t==null?void 0:t.hint)),e),{})),ee={date:H()},p=ce({initialValues:ee,enableReinitialize:!0,validationSchema:D,onSubmit:e=>{S(e)}}),f=(e,t)=>{K(e),W(t)},S=e=>{I(!0);let t={date:e==null?void 0:e.date};A.post(M,t,_()).then(r=>{var o,l,c;(o=r==null?void 0:r.data)!=null&&o.status?Q((l=r==null?void 0:r.data)==null?void 0:l.data):f(!0,E((c=r==null?void 0:r.data)==null?void 0:c.message))}).catch(r=>{f(!0,"Server Error! Please try again later.")}).finally(()=>{I(!1)})};n.useEffect(()=>{S({date:H()})},[]);const se=e=>{U(e),y(!0),m.current.showModal();let t={date:e==null?void 0:e.date,userId:e==null?void 0:e.user_id};A.post(L,t,_()).then(r=>{var o,l,c;(o=r==null?void 0:r.data)!=null&&o.status?O((l=r==null?void 0:r.data)==null?void 0:l.data):(f(!0,E((c=r==null?void 0:r.data)==null?void 0:c.message)),m.current.close())}).catch(r=>{f(!0,"Server Error! Please try again later."),m.current.close()}).finally(()=>{y(!1)})},te=e=>x.some(t=>parseInt(t)==parseInt(e)),R=(e,t="")=>{var c;const r=e.target.name,o=e.target.value,l=e.target.checked;if(r=="cashAll")if(C(l),l){const h=(c=a==null?void 0:a.tranDtl)==null?void 0:c.map(u=>u==null?void 0:u.id);g(h)}else g([]);if(r=="cashSingle"){if(l)g(h=>[...h,o]);else if(!l&&w!=!0){let h=x==null?void 0:x.filter(u=>u!=o);g(h)}}},re=()=>{if((x==null?void 0:x.length)==0)return;y(!0);let e={id:x,tcId:a==null?void 0:a.tcId,date:a==null?void 0:a.date};A.post($,e,_()).then(t=>{var r,o;(r=t==null?void 0:t.data)!=null&&r.status?(oe.success("Cash Verified Successfully !!!"),S({date:a==null?void 0:a.date})):f(!0,E((o=t==null?void 0:t.data)==null?void 0:o.message))}).catch(t=>{f(!0,"Server Error! Please try again later.")}).finally(()=>{y(!1),m.current.close(),C(!1),g([])})};return s.jsxs(s.Fragment,{children:[J&&s.jsx(me,{activateBottomErrorCard:f,errorTitle:G}),s.jsxs("form",{onSubmit:p.handleSubmit,onChange:p.handleChange,className:"bg-white poppins p-4 mb-8",children:[s.jsx("h1",{className:"text-xl font-semibold uppercase text-center text-gray-700 border-b border-gray-400 mb-4 pb-1",children:"Cash Verification"}),s.jsxs("section",{className:"flex gap-4 flex-wrap my-6",children:[v==null?void 0:v.map(e=>Z(e==null?void 0:e.key,e==null?void 0:e.title,e==null?void 0:e.type,e==null?void 0:e.width,e==null?void 0:e.hint,e==null?void 0:e.required,e==null?void 0:e.options,e==null?void 0:e.okey,e==null?void 0:e.ovalue)),s.jsx("div",{className:"mt-4 w-full md:w-[30%] flex flex-row flex-wrap items-center gap-x-4 gap-y-2 md:mt-4",children:s.jsx("div",{className:" ",children:N?s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex justify-center",children:s.jsx(he,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):s.jsxs("button",{type:"submit",className:" flex items-center border border-green-600 bg-green-500 hover:bg-green-600 text-white shadow-md rounded-sm  text-sm px-5 py-1",children:[s.jsx("span",{className:"",children:s.jsx(de,{fontSize:""})}),s.jsx("span",{children:"Search Record"})]})})})]})]}),s.jsxs("dialog",{ref:m,className:"relative overflow-clip animate__animated animate__zoomIn animate__faster focus:outline-none backdrop:backdrop-brightness-75",children:[!N&&s.jsx("span",{onClick:()=>(m.current.close(),g([]),C(!1)),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:s.jsx(ge,{})}),s.jsx("div",{className:" z-50 px-6 py-4 flex flex-col gap-4 ",children:s.jsxs("div",{className:"flex flex-col items-between justify-center",children:[s.jsxs("div",{className:"w-full flex flex-col items-center mb-4 pb-2 border-b",children:[s.jsx("span",{className:"text-green-500 p-2 block rounded-full drop-shadow-md shadow-green-300",children:s.jsx(ue,{size:25})}),s.jsxs("span",{className:"font-semibold",children:[i==null?void 0:i.officer_name," Cash Collection Details"]})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-x-4 gap-y-2 text-sm",children:[s.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Officer Name: "}),s.jsx("div",{className:"col-span-6",children:j(i==null?void 0:i.officer_name)})]}),s.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Mobile No.: "}),s.jsx("div",{className:"col-span-6",children:j(i==null?void 0:i.mobile)})]}),s.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Total Amount: "}),s.jsx("div",{className:"col-span-6",children:k(i==null?void 0:i.penalty_amount)})]})]}),s.jsxs("div",{className:"w-full mt-4 mb-2",children:[s.jsxs("div",{className:"font-semibold ",children:[s.jsxs("span",{children:["Collection List (Date : ",i==null?void 0:i.date,")"]}),!b&&Array.isArray(a==null?void 0:a.tranDtl)&&((z=a==null?void 0:a.tranDtl)==null?void 0:z.length)>0&&s.jsx("button",{onClick:()=>re(),className:"font-normal text-sm float-right bg-green-500 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-green-600 hover:text-white text-white flex items-center mb-1",children:"Verify"})]}),s.jsxs("div",{className:"flex flex-col h-[60vh] w-full overflow-y-auto md:overflow-x-hidden",children:[s.jsxs("div",{className:"w-full grid grid-cols-12 items-center gap-2 bg-slate-500 text-white font-semibold border border-slate-200 px-4 py-2",children:[s.jsx("div",{className:"col-span-2 text-sm",children:"Sl.No."}),s.jsx("div",{className:"col-span-3 text-sm",children:"Transaction No"}),s.jsx("div",{className:"col-span-3 text-sm",children:"Transaction Date"}),s.jsx("div",{className:"col-span-2 text-sm",children:"Amount"}),s.jsxs("div",{className:"col-span-2 text-sm flex",children:[s.jsx("span",{children:"Action"}),!b&&Array.isArray(a==null?void 0:a.tranDtl)&&((V=a==null?void 0:a.tranDtl)==null?void 0:V.length)>0&&s.jsx("label",{class:"inline-flex items-center px-4 animate__animated animate__fadeIn animate__faster",children:s.jsx("input",{type:"checkbox",name:"cashAll",checked:w,onChange:e=>R(e),class:"cursor-pointer form-checkbox h-5 w-5 text-slate-800"})})]})]}),b&&s.jsx(P,{}),!b&&Array.isArray(a==null?void 0:a.tranDtl)&&((B=a==null?void 0:a.tranDtl)==null?void 0:B.map((e,t)=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"w-full text-sm grid grid-cols-12 items-center gap-2 bg-slate-100 border-b hover:bg-white pb-1 p-4 animate__animated animate__fadeIn animate__faster",children:[s.jsx("div",{className:"col-span-2",children:t+1}),s.jsx("div",{className:"col-span-3",children:j(e==null?void 0:e.tran_no)}),s.jsx("div",{className:"col-span-3",children:pe(e==null?void 0:e.tran_date)}),s.jsx("div",{className:"col-span-2",children:k(e==null?void 0:e.total_amount)}),s.jsx("div",{className:"col-span-2",children:s.jsx("label",{class:"inline-flex items-center justify-end px-4",children:s.jsx("input",{type:"checkbox",name:"cashSingle",checked:w||te(e==null?void 0:e.id)?!0:null,value:e==null?void 0:e.id,onChange:r=>R(r,e==null?void 0:e.id),class:"cursor-pointer form-checkbox h-5 w-5 text-slate-800"})})})]},t)}))),!b&&Array.isArray(d)&&(d==null?void 0:d.length)==0&&s.jsx("div",{className:"w-full text-center text-red-400 font-semibold pb-1 p-4",children:"No List Available"})]})]})]})})]}),N&&s.jsx(P,{}),!N&&Array.isArray(d)&&(d==null?void 0:d.length)>0&&s.jsx(be,{dataList:d,columns:q})]})};export{He as default};
