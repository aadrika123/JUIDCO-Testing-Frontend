import{u as J,j as e,b as s,M as me,c as pe,r as N,d as he,A as ue,F as q,Q as M}from"./index-0069139d.js";import{T as xe}from"./ThemeStyle-994f51bc.js";import{u as Ne}from"./formik.esm-61dbd241.js";import{c as ge,a as h}from"./index.esm-51642fe0.js";import{n as g}from"./PowerupFunctions-1fcc6543.js";import{R as ye}from"./RentalApiList-c2e8700a.js";import{u as fe,a as _}from"./useCustomQuery-2790e179.js";import{B as be}from"./index.esm-9027a9ab.js";import{C as Y}from"./CreateConfirmation-adcbc291.js";import{O as ve}from"./OverLayLoader-6aba10c1.js";import{R as we}from"./RotatingLoader-1be2c224.js";import"./hoist-non-react-statics.cjs-0a2889ca.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-449055df.js";function Ce({shopReceiptListData:c}){var u,b,v;const p=J();return c!=null&&c.isLoading?e("div",{className:"w-full h-32    flex justify-center items-center ",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):c!=null&&c.error?e("div",{className:"w-full h-32    flex justify-center items-center ",children:s("div",{className:"text-red-500",children:["Error: ",(u=c==null?void 0:c.error)==null?void 0:u.message]})}):e("div",{className:"p-5",children:(v=(b=c==null?void 0:c.data)==null?void 0:b.data)==null?void 0:v.map((r,w)=>s("div",{className:"w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg ",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Shop Payment Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:s("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Vendor Name."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.allottee})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Amount"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.amount})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.payment_date})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Mode"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.pmt_mode})]})]})}),s("div",{onClick:()=>p(`/shop-payment-receipt/${r==null?void 0:r.id}`),className:"mb-2 mx-4 relative text-white px-2 2xl:px-4 py-[0.3rem] text-xs 2xl:text-sm md:absolute md:bottom-3 2xl:bottom-2 md:right-2 rounded-md bg-indigo-500 border-indigo-400 hover:border-indigo-600 hover:bg-indigo-600 hover:text-white shadow-sm  cursor-pointer poppins md:mt-0 w-max",children:["View Receipt",e(be,{className:"inline font-semibold text-xl"})]})]},w))})}me.setAppElement("#root");function Te(){var E,P,z,k,A,I;const c=J(),{id:p}=pe(),u=fe({}),{api_shopDetailsById:b,api_shopTcPayment:v,api_shop_month_demand:r,api_shop_calculate_price:w,api_shop_payment:K,api_shop_receipt_list:W,api_shop_Payment_chq_dd:X,api_generate_demand_shop:Z}=ye(),{titleColor:L,bgHeaderColor:qe}=xe(),y=(t,l)=>{M.dismiss(),l=="success"&&M.success(t),l=="error"&&M.error(t)},[R,C]=N.useState(!1),[d,ee]=N.useState(),[Me,ae]=N.useState(""),[_e,te]=N.useState(""),[De,se]=N.useState(""),[Se,ne]=N.useState("");N.useState(!1);const x=_({api:r,config:{shopId:p},options:{enabled:!0}}),le=t=>{console.log("==2======",t);const l=new Date,i=t,o=(l.getFullYear()-i.getFullYear())*12+(l.getMonth()-i.getMonth())+1;console.log("==3======",o),ae(o)},de=t=>{console.log("==1======",t);const[l,i,o]=t.split("/"),f=new Date(`${o}/${i}/${l}`);console.log("===1.1= after splitting==",f),le(f)},a=Ne({initialValues:{month:"",amount:0,paymentMode:"",bankName:"",branchName:"",chequeNo:"",chequeDdDate:"",photo:null},validationSchema:ge({month:h().required("Month is required"),paymentMode:h().required("Payment Mode is required"),bankName:h().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>h().required("Bank Name is required")}),branchName:h().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>h().required("Branch Name is required")}),chequeNo:h().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>h().required("Cheque No is required")}),chequeDdDate:h().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>h().required("Cheque/DD Date is required")})}),onSubmit:async t=>{await Y("Are you sure you want to make payment?")?await oe():console.log("cancelled")}});_({api:w,config:{shopId:p,month:a.values.month},value:[a.values.month],options:{enabled:!!a.values.month,onSuccess:t=>{var l;a.setFieldValue("amount",(l=t==null?void 0:t.data)==null?void 0:l.amount)}}});const D=_({api:W,config:{shopId:p},options:{enabled:!!p}}),re=t=>{let l=t.target.name,i=t.target.value;l=="ddmmyy"&&te(i),l=="fromDate"&&se(i),l=="uptoDate"&&ne(i)},oe=async t=>{var l,i,o,f,$,F,H,U,j,B,Q,O,V,T,G;if(a.values.paymentMode=="ONLINE",a.values.paymentMode=="CHEQUE"||a.values.paymentMode=="DD"){const n=new FormData;n.append("shopId",p),n.append("month",a.values.month),n.append("amount",a.values.amount),n.append("paymentMode",a.values.paymentMode),n.append("bankName",a.values.bankName),n.append("branchName",a.values.branchName),n.append("chequeNo",a.values.chequeNo),n.append("chequeDdDate",a.values.chequeDdDate),n.append("photo",a.values.photo);const m=await u.mutateAsync({api:X,data:n});(l=m==null?void 0:m.data)!=null&&l.status?(y("Payment done successfully","success"),c(`/payment-response?response=${(o=(i=m==null?void 0:m.data)==null?void 0:i.data)==null?void 0:o.tranId}&module=shop&id=${($=(f=m==null?void 0:m.data)==null?void 0:f.data)==null?void 0:$.tranId}&tran-no=${(H=(F=m==null?void 0:m.data)==null?void 0:F.data)==null?void 0:H.tranNo}`,{replace:!0})):y("Payment failed","error")}else{const n=await(u==null?void 0:u.mutateAsync({api:K,data:{shopId:p,month:a.values.month,paymentMode:a.values.paymentMode}}));(U=n==null?void 0:n.data)!=null&&U.status?(y((j=n==null?void 0:n.data)==null?void 0:j.message,"success"),c(`/payment-response?response=${(Q=(B=n==null?void 0:n.data)==null?void 0:B.data)==null?void 0:Q.tranId}&module=shop&id=${(V=(O=n==null?void 0:n.data)==null?void 0:O.data)==null?void 0:V.tranId}&tran-no=${(G=(T=n==null?void 0:n.data)==null?void 0:T.data)==null?void 0:G.tranNo}`,{replace:!0})):y(n==null?void 0:n.message,"error")}},ce=()=>{if(!a.values.month)return y("Please select month","error");c(`/shop-demand-details?shop_id=${p}&month=${a.values.month}`)};N.useEffect(()=>{S()},[]);const S=()=>{C(!0);const t={shopId:p};he.post(b,t,ue()).then(l=>{l.data.status&&(ee(l.data.data),de(l.data.data.payment_upto)),C(!1)}).catch(l=>{C(!1)})},ie=async()=>{var t,l,i;if(await Y("Are you sure you want to generate demand?")){const o=await u.mutateAsync({api:Z,data:{shopId:p}});(t=o==null?void 0:o.data)!=null&&t.status?(y((l=o==null?void 0:o.data)==null?void 0:l.message,"success"),S(),x==null||x.refetch(),D.refetch()):y((i=o==null?void 0:o.data)==null?void 0:i.message,"error")}};return R?e(we,{}):s(q,{children:[u.isLoading&&e(ve,{}),s("div",{className:"bg-[#eff2f0]",children:[s("div",{className:"col-span-12",children:[" ",e("h1",{className:`font-bold ${L} text-xl px-4 py-2 text-gray-600`,children:"Shop Details"})]}),e("div",{className:"flex justify-center items-center  overflow-hidden p-4",children:s("div",{className:"w-full md:w-1/3 rounded-lg bg-[#fdfdfd] shadow-indigo-50 shadow-md",children:[s("div",{className:"bg-[#6c68f0] rounded-lg p-4 text-white",children:[s("p",{className:"text-sm text-center font-semibold ",children:["Shop No. : ",e("span",{children:g(d==null?void 0:d.shop_no)})]}),e("p",{className:"text-center py-1",children:s("span",{className:"text-sm justify-center text-gray-50 flex",children:[e("span",{className:"",children:"Payable Amount : "}),a.values.amount]})}),((P=(E=x==null?void 0:x.data)==null?void 0:E.data)==null?void 0:P.length)>0?e(q,{children:s("form",{onSubmit:a.handleSubmit,onChange:re,children:[s("div",{className:"space-x-2 py-1",children:[s("select",{name:"paymentMode",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.paymentMode,children:[e("option",{value:"",children:"Select Payment Mode"}),e("option",{value:"CASH",children:"Cash"}),e("option",{value:"ONLINE",children:"Online"}),e("option",{value:"CHEQUE",children:"Cheque"}),e("option",{value:"DD",children:"DD"})]}),e("span",{className:"text-red-400 text-sm",children:a.touched.paymentMode&&a.errors.paymentMode})]}),((z=a==null?void 0:a.values)==null?void 0:z.paymentMode)=="CHEQUE"||((k=a==null?void 0:a.values)==null?void 0:k.paymentMode)=="DD"?s(q,{children:[s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Bank Name"}),e("input",{type:"text",name:"bankName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.bankName}),e("span",{className:"text-red-400 text-sm",children:a.touched.bankName&&a.errors.bankName})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Branch Name"}),e("input",{type:"text",name:"branchName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.branchName}),e("span",{className:"text-red-400 text-sm",children:a.touched.branchName&&a.errors.branchName})]})]}),s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque No."}),e("input",{type:"text",name:"chequeNo",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeNo}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeNo&&a.errors.chequeNo})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque/DD Date"}),e("input",{type:"date",name:"chequeDdDate",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeDdDate}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeDdDate&&a.errors.chequeDdDate})]})]}),e("div",{className:"flex space-x-2  py-1",children:s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Upload Photo"}),e("input",{type:"file",name:"photo",onChange:t=>a.setFieldValue("photo",t.target.files[0])}),e("span",{className:"text-red-400 text-sm",children:a.touched.photo&&a.errors.photo})]})})]}):null,e("div",{className:"flex space-x-2 py-1  ",children:s("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"Select Month"}),s("select",{name:"month",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.month,children:[e("option",{value:"",children:"Select Month"}),(I=(A=x==null?void 0:x.data)==null?void 0:A.data)==null?void 0:I.map(t=>e("option",{value:t==null?void 0:t.monthly,children:t==null?void 0:t.monthly},t==null?void 0:t.id))]}),e("span",{className:"text-red-400 text-sm",children:a.touched.month&&a.errors.month})]})}),s("div",{className:"flex gap-5",children:[e("button",{type:"button",onClick:ce,className:"bg-green-400 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Demand Detail"}),e("button",{type:"submit",className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Pay Now"})]})]})}):e("div",{className:"text-center ",children:e("button",{onClick:()=>{ie()},className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Generate Demand"})})]}),e("div",{className:"bg-white shadow-lg rounded-lg  w-full mt-4",children:e("div",{children:s("ul",{children:[s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["sairat Name :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.allottee)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Present occupier :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.present_occupier)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["Contact no. :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.contact_no)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["circle :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.circle_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["market :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.market_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["monthly rent :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.rate)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["last demand :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(d==null?void 0:d.last_payment_amount)})]})]})})})]})}),e(Ce,{shopReceiptListData:D})]})]})}export{Te as default};
