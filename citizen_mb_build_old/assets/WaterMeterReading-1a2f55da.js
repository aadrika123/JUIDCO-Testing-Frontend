import{r as i,c as R,b as r,F as M,j as e,a as h}from"./index-0069139d.js";import{C as F}from"./ConsumerButtons-034602ee.js";import{h as _}from"./moment-a9aaa855.js";import{W as U}from"./WaterApiList-6e4db4b0.js";import{u as I}from"./formik.esm-61dbd241.js";import{c as k,e as E,a as C}from"./index.esm-51642fe0.js";import{F as W}from"./LoadingButton-5fb774e8.js";import"./hoist-non-react-statics.cjs-0a2889ca.js";import"./ThemeStyle-994f51bc.js";import"./index.esm-88163b48.js";const z=()=>{var m,c,p,g,x,u,b;const[t,f]=i.useState();i.useState();const{id:n}=R(),{api_waterListDemand:N,api_waterGenerateDemand:y,header:d}=U(),v=()=>{h.post(N,{ConsumerId:n},d).then(s=>{console.log("Fetched Water Demand List",s.data.data),f(s.data.data)}).catch(s=>{console.log("Exception while fetching Water Demand",s)})};i.useEffect(()=>{v()},[n]);const w=s=>{const o=new FormData;o.append("consumerId",n),o.append("demandUpto",s.demandUpto),o.append("finalRading",s.meterReading),o.append("document",s.meterImage),h.post(y,o,d).then(l=>{l.data.status?(setRefetchData(D=>D+1),console.log("Demand Generate Date Saved",l)):console.log("Error Demand Generate",l)}).catch(l=>{console.log("Exception While going to generate Demand",l)})};k({meterReading:E().required("Enter Meter Reading").min(((m=t==null?void 0:t.meterDetails)==null?void 0:m.final_meter_reading)+1,`Reading must be greater previous ${(c=t==null?void 0:t.meterDetails)==null?void 0:c.final_meter_reading}`),demandUpto:C().required("Select Upto Data")});const a=I({enableReinitialize:!0,initialValues:{demandUpto:"",meterReading:"",meterImage:null},onSubmit:async(s,{resetForm:o})=>{await w(s)}});return r(M,{children:[e(F,{active:"meter"}),r("h1",{className:"px-1 mt-3 text-center font-semibold text-gray-700",children:[" ","Meter/Fixed Connection Details"]}),e("p",{className:"border-b border-gray-700 mx-5"}),r("div",{className:"py-6 mt-2 m-2 bg-white rounded-lg shadow-xl p-4 space-y-5",children:[r("div",{className:"flex space-x-5 pl-4 ",children:[r("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-sm",children:(p=t==null?void 0:t.meterDetails)==null?void 0:p.connectionName}),e("div",{className:"text-gray-500 text-xs",children:"Connection Type"})]}),r("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:(g=t==null?void 0:t.meterDetails)==null?void 0:g.meter_no}),e("div",{className:"text-gray-500 text-xs",children:"Meter No."})]})]}),r("div",{className:"flex space-x-5 pl-4 ",children:[r("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:(x=t==null?void 0:t.meterDetails)!=null&&x.final_meter_reading?(u=t==null?void 0:t.meterDetails)==null?void 0:u.final_meter_reading:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Last Meter Reading"})]}),r("div",{className:"flex-1",children:[r("div",{className:"font-semibold text-md",children:[_((b=t==null?void 0:t.meterDetails)==null?void 0:b.connection_date,"YYYY-MM-DD").format("DD-MMM-yy")," "]}),e("div",{className:"text-gray-500 text-xs",children:"Meter Connection Date"})]})]})]}),e("p",{className:"border-b"}),e("div",{className:"py-2 bg-white rounded-lg shadow-xl p-4",children:r(W,{formik:a,children:[r("div",{className:"space-y-5 ",children:[e("div",{className:"flex-1",children:r("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[r("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Upload Meter Image"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{onChange:s=>a.setFieldValue("meterImage",s.target.files[0]),name:"meterImage",type:"file",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter Meter Reading"}),e("span",{className:"text-red-600 absolute text-xs",children:a.touched.meterImage&&a.errors.meterImage?a.errors.meterImage:null})]})}),e("div",{className:"flex-1",children:r("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[r("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:["Final Meter Reading"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...a.getFieldProps("meterReading"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter Meter Reading"}),e("span",{className:"text-red-600 absolute text-xs",children:a.touched.meterReading&&a.errors.meterReading?a.errors.meterReading:null})]})}),e("div",{className:"flex-1",children:r("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[r("label",{className:"form-label inline-block mb-1 text-gray-900 text-sm font-semibold",children:["Demand Upto Date"," ",e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]}),e("input",{...a.getFieldProps("demandUpto"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer"}),e("span",{className:"text-red-600 absolute text-xs",children:a.touched.demandUpto&&a.errors.demandUpto?a.errors.demandUpto:null})]})})]}),e("div",{className:"flex justify-center",children:e("button",{type:"submit",className:"bg-indigo-700 px-6 py-2 text-sm text-white rounded",children:"Generate Demand"})})]})})]})};export{z as default};
