import{r as m,u as I,j as e,b as s,M as X,c as Y,d as D,A as J,F as K,Q as y}from"./index-0069139d.js";import{T as P}from"./ThemeStyle-994f51bc.js";import{u as Z}from"./formik.esm-61dbd241.js";import{c as L,a as N}from"./index.esm-51642fe0.js";import{n as i}from"./PowerupFunctions-1fcc6543.js";import{R as ee}from"./RentalApiList-c2e8700a.js";import{_ as ae}from"./index-311085b4.js";import{B as se}from"./index.esm-9027a9ab.js";import{u as te,a as re}from"./useCustomQuery-2790e179.js";import{C as oe}from"./CreateConfirmation-adcbc291.js";import{O as ne}from"./OverLayLoader-6aba10c1.js";import{R as de}from"./RotatingLoader-1be2c224.js";import"./hoist-non-react-statics.cjs-0a2889ca.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-449055df.js";function le(){const[o]=ae();return{handleRzpPayment:m.useCallback(async h=>{const c={key:"rzp_test_NXHWEn0nSMDcnm",amount:"2000",currency:"INR",name:"Acme Corp",order_id:"order_DaaS6LOUAASb7Y",description:"Test Transaction",image:"https://example.com/your_logo",handler:function(r){alert(r.razorpay_payment_id)},prefill:{name:"Piyush Garg",email:"youremail@example.com",contact:"9999999999"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}},x=new o(c);return x.open(),x},[o])}}function ce({tollPaymentListData:o}){var h,c,x;const u=I();return o!=null&&o.isLoading?e("div",{className:"w-full h-32    flex justify-center items-center ",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):o!=null&&o.error?e("div",{className:"w-full h-32    flex justify-center items-center ",children:s("div",{className:"text-red-500",children:["Error: ",(h=o==null?void 0:o.error)==null?void 0:h.message]})}):e("div",{className:"p-5",children:(x=(c=o==null?void 0:o.data)==null?void 0:c.data)==null?void 0:x.map((r,f)=>s("div",{className:"w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg ",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Toll Payment Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:s("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Vendor Name."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.vendor_name})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Amount"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.amount})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Mode"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.pmt_mode})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"From Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.from_date})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"To Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:r==null?void 0:r.to_date})]})]})}),s("div",{onClick:()=>u(`/toll-payment-receipt/${r==null?void 0:r.id}`),className:"mb-2 mx-4 relative text-white px-2 2xl:px-4 py-[0.3rem] text-xs 2xl:text-sm md:absolute md:bottom-3 2xl:bottom-2 md:right-2 rounded-md bg-indigo-500 border-indigo-400 hover:border-indigo-600 hover:bg-indigo-600 hover:text-white shadow-sm  cursor-pointer poppins md:mt-0 w-max",children:["View Receipt",e(se,{className:"inline font-semibold text-xl"})]})]},f))})}X.setAppElement("#root");function Se(){var _,C,z;const o=I(),u=te({}),{handleRzpPayment:h}=le(),{id:c}=Y();console.log("id.....",c);const{api_tollDetailsById:x,api_tollTcPayment:r,api_list_shop_demand:f}=ee(),{titleColor:E}=P(),b=(t,l)=>{y.dismiss(),l=="success"&&y.success(t),l=="error"&&y.error(t)},[F,g]=m.useState(!1),[a,$]=m.useState();m.useState("");const[ie,j]=m.useState(""),[q,O]=m.useState(""),[v,U]=m.useState("");m.useState(!1);const B=re({api:f,config:{tollId:c},options:{enabled:!!c}}),w=()=>{const t=new Date(q);return`${new Date(v).getDate()-t.getDate()+1}`},n=Z({initialValues:{amount:"",fromDate:"",uptoDate:"",paymentMode:""},validationSchema:L({fromDate:N().required("Required"),uptoDate:N().required("Required"),paymentMode:N().required("Required")}),onSubmit:async(t,{resetForm:l})=>{await oe("Are you sure you want to make payment?")?await H(t,l):console.log("cancelled")}}),V=t=>{console.log("target value",t.target.value),console.log("target value",t.target.name);let l=t.target.name,p=t.target.value;console.log("value to ...",p),l=="ddmmyy"&&j(p),l=="fromDate"&&O(p),l=="uptoDate"&&U(p)},H=async(t,l)=>{var R,S,M,A,T,k;let p;if(p={tollId:c,dateFrom:t==null?void 0:t.fromDate,dateUpto:t==null?void 0:t.uptoDate,paymentMode:t==null?void 0:t.paymentMode},((R=n.values)==null?void 0:R.paymentMode)=="ONLINE"){alert("Under Development");const d={amount:`${a==null?void 0:a.rate}`*w(),order_id:"order_Ef",handler:W=>{console.log(W)}},Q=await h(d);console.log("res",Q)}else{const d=await u.mutateAsync({api:r,data:p});(S=d==null?void 0:d.data)!=null&&S.status?(b(d==null?void 0:d.message,"success"),o(`/payment-response?response=${(A=(M=d==null?void 0:d.data)==null?void 0:M.data)==null?void 0:A.tollId}&module=toll&id=${(k=(T=d==null?void 0:d.data)==null?void 0:T.data)==null?void 0:k.tollId}`,{replace:!0}),l()):b(d==null?void 0:d.message,"error")}};m.useEffect(()=>{G()},[]);const G=()=>{g(!0);const t={tollId:c};D.post(x,t,J()).then(l=>{l.data.status&&$(l.data.data),g(!1)}).catch(l=>{console.log(l),g(!1)})};return F?e(de,{}):s(K,{children:[(u==null?void 0:u.isLoading)&&e(ne,{}),s("div",{className:"bg-[#eff2f0]",children:[s("div",{className:"col-span-12",children:[" ",e("h1",{className:`font-semibold  ${E} text-xl px-4 py-2 text-gray-600`,children:"Toll Details"})]}),e("div",{className:" flex justify-center items-center  overflow-hidden p-4 ",children:s("div",{className:"  w-full md:w-1/3 rounded-lg bg-[#fdfdfd] shadow-indigo-50 shadow-md",children:[s("div",{className:"bg-[#6c68f0] rounded-lg p-4 text-white",children:[s("p",{className:"text-sm text-center font-semibold ",children:["Toll No. : ",e("span",{children:i(a==null?void 0:a.toll_no)})]}),e("p",{className:"text-center py-1",children:s("span",{className:"text-sm justify-center text-gray-50 flex",children:[e("span",{className:"",children:"Payable Amount : "}),v?s("p",{children:["Rs. ",`${a==null?void 0:a.rate}`*w()]}):s("h1",{children:["Rs. ",a==null?void 0:a.rate]})]})}),s("form",{onSubmit:n.handleSubmit,onChange:V,children:[s("div",{className:"space-x-2 py-1",children:[s("select",{name:"paymentMode",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:n.handleChange,value:n.values.paymentMode,children:[e("option",{value:"",children:"Select Payment Mode"}),e("option",{value:"CASH",children:"Cash"}),e("option",{value:"ONLINE",children:"Online"})]}),e("span",{className:"text-red-400 text-sm",children:n.touched.paymentMode&&n.errors.paymentMode})]}),s("div",{className:"flex space-x-2 py-1  ",children:[s("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"date from"}),e("input",{type:"date",name:"fromDate",className:"px-2 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:n.handleChange,value:n.values.fromDate,min:(z=(C=(_=a==null?void 0:a.payment_upto)==null?void 0:_.split("-"))==null?void 0:C.reverse())==null?void 0:z.join("-"),max:n.values.uptoDate}),e("span",{className:"text-red-400 text-sm",children:n.touched.fromDate&&n.errors.fromDate})]}),s("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"date upto"}),e("input",{type:"date",disabled:!n.values.fromDate,name:"uptoDate",className:"px-2 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:n.handleChange,value:n.values.uptoDate,min:n.values.fromDate}),e("span",{className:"text-red-400 text-sm",children:n.touched.uptoDate&&n.errors.uptoDate})]})]}),e("div",{className:"",children:e("button",{type:"submit",className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Pay Now"})})]})]}),e("div",{className:"bg-white shadow-lg rounded-lg  w-full mt-4",children:e("div",{children:s("ul",{children:[s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["vendor Name :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.vendor_name)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Address :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.address)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["Circle :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.circle_name)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["market :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.market_name)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Rate :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.rate)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Last Payment date :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.last_payment_date)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Last payment amt. :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.last_payment_amount)})]}),s("li",{className:"p-2 px-5 text-sm text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Payment Upto :",e("span",{className:"px-4 text-sm text-gray-500 uppercase",children:i(a==null?void 0:a.payment_upto)})]})]})})})]})})]}),e(ce,{tollPaymentListData:B})]})}export{Se as default};
