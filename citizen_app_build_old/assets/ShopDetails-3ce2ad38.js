import{u as V,j as e,b as s,M as de,c as oe,r as N,d as ce,A as ie,F as q,Q as M}from"./index-02f90fa3.js";import{T as me}from"./ThemeStyle-994f51bc.js";import{u as pe}from"./formik.esm-ac1f6228.js";import{c as he,a as p}from"./index.esm-5c2f65fb.js";import{n as g}from"./PowerupFunctions-46ced432.js";import{R as ue}from"./RentalApiList-a02a0e03.js";import{u as xe,a as _}from"./useCustomQuery-f7224d32.js";import{B as Ne}from"./index.esm-8fb2a5eb.js";import{C as O}from"./CreateConfirmation-d89373b0.js";import{O as ge}from"./OverLayLoader-07e4c7d7.js";import{R as ye}from"./RotatingLoader-56026349.js";import"./hoist-non-react-statics.cjs-6e0de22a.js";import"./ApiHeader2-b363f7b8.js";import"./Hourglass-8d1547f1.js";function fe({shopReceiptListData:c}){var h,b,v;const m=V();return c!=null&&c.isLoading?e("div",{className:"w-full h-32    flex justify-center items-center ",children:e("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):c!=null&&c.error?e("div",{className:"w-full h-32    flex justify-center items-center ",children:s("div",{className:"text-red-500",children:["Error: ",(h=c==null?void 0:c.error)==null?void 0:h.message]})}):e("div",{className:"p-5",children:(v=(b=c==null?void 0:c.data)==null?void 0:b.data)==null?void 0:v.map((d,w)=>s("div",{className:"w-full relative rounded-lg pb-2 mb-4 cursor-pointer shadow-lg ",children:[e("div",{className:"font-semibold bg-[#838FCE] px-4 py-2 text-white rounded-t-lg text-sm",children:"Shop Payment Details"}),e("div",{className:"w-full rounded-lg p-4 space-b-2",children:s("div",{className:"flex flex-row flex-wrap gap-x-4 gap-y-2 w-full",children:[s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Vendor Name."}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.allottee})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Amount"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.amount})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Date"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.payment_date})]}),s("div",{className:"w-full md:w-[40%] grid grid-cols-12",children:[e("div",{className:"col-span-6 text-xs text-gray-600",children:"Payment Mode"}),e("div",{className:"col-span-6 font-semibold text-gray-700 2xl:text-base text-xs",children:d==null?void 0:d.pmt_mode})]})]})}),s("div",{onClick:()=>m(`/shop-payment-receipt/${d==null?void 0:d.id}`),className:"mb-2 mx-4 relative text-white px-2 2xl:px-4 py-[0.3rem] text-xs 2xl:text-sm md:absolute md:bottom-3 2xl:bottom-2 md:right-2 rounded-md bg-indigo-500 border-indigo-400 hover:border-indigo-600 hover:bg-indigo-600 hover:text-white shadow-sm  cursor-pointer poppins md:mt-0 w-max",children:["View Receipt",e(Ne,{className:"inline font-semibold text-xl"})]})]},w))})}de.setAppElement("#root");function Be(){var E,P,z,k,A,I;const c=V(),{id:m}=oe(),h=xe({}),{api_shopDetailsById:b,api_shopTcPayment:v,api_shop_month_demand:d,api_shop_calculate_price:w,api_shop_payment:T,api_shop_receipt_list:G,api_shop_Payment_chq_dd:Y,api_generate_demand_shop:J}=ue(),{titleColor:K,bgHeaderColor:be}=me(),y=(t,l)=>{M.dismiss(),l=="success"&&M.success(t),l=="error"&&M.error(t)},[W,C]=N.useState(!1),[r,X]=N.useState(),[ve,Z]=N.useState(""),[we,L]=N.useState(""),[Ce,R]=N.useState(""),[qe,ee]=N.useState("");N.useState(!1);const u=_({api:d,config:{shopId:m},options:{enabled:!0}}),ae=t=>{console.log("==2======",t);const l=new Date,i=t,o=(l.getFullYear()-i.getFullYear())*12+(l.getMonth()-i.getMonth())+1;console.log("==3======",o),Z(o)},te=t=>{console.log("==1======",t);const[l,i,o]=t.split("/"),f=new Date(`${o}/${i}/${l}`);console.log("===1.1= after splitting==",f),ae(f)},a=pe({initialValues:{month:"",amount:0,paymentMode:"",bankName:"",branchName:"",chequeNo:"",chequeDdDate:"",photo:null},validationSchema:he({month:p().required("Month is required"),paymentMode:p().required("Payment Mode is required"),bankName:p().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>p().required("Bank Name is required")}),branchName:p().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>p().required("Branch Name is required")}),chequeNo:p().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>p().required("Cheque No is required")}),chequeDdDate:p().when("paymentMode",{is:t=>t=="CHEQUE"||t=="DD",then:()=>p().required("Cheque/DD Date is required")})}),onSubmit:async t=>{await O("Are you sure you want to make payment?")?await ne():console.log("cancelled")}});_({api:w,config:{shopId:m,month:a.values.month},value:[a.values.month],options:{enabled:!!a.values.month,onSuccess:t=>{var l;a.setFieldValue("amount",(l=t==null?void 0:t.data)==null?void 0:l.amount)}}});const D=_({api:G,config:{shopId:m},options:{enabled:!!m}}),se=t=>{let l=t.target.name,i=t.target.value;l=="ddmmyy"&&L(i),l=="fromDate"&&R(i),l=="uptoDate"&&ee(i)},ne=async t=>{var l,i,o,f,$,F,H,U,j,B,Q;if(a.values.paymentMode=="ONLINE",a.values.paymentMode=="CHEQUE"||a.values.paymentMode=="DD"){const n=new FormData;n.append("shopId",m),n.append("month",a.values.month),n.append("amount",a.values.amount),n.append("paymentMode",a.values.paymentMode),n.append("bankName",a.values.bankName),n.append("branchName",a.values.branchName),n.append("chequeNo",a.values.chequeNo),n.append("chequeDdDate",a.values.chequeDdDate),n.append("photo",a.values.photo);const x=await h.mutateAsync({api:Y,data:n});(l=x==null?void 0:x.data)!=null&&l.status?(y("Payment done successfully","success"),c(`/payment-response?response=${(o=(i=x==null?void 0:x.data)==null?void 0:i.data)==null?void 0:o.tranId}&module=shop&id=${($=(f=x==null?void 0:x.data)==null?void 0:f.data)==null?void 0:$.tranId}`,{replace:!0})):y("Payment failed","error")}else{const n=await(h==null?void 0:h.mutateAsync({api:T,data:{shopId:m,month:a.values.month,paymentMode:a.values.paymentMode}}));(F=n==null?void 0:n.data)!=null&&F.status?(y((H=n==null?void 0:n.data)==null?void 0:H.message,"success"),c(`/payment-response?response=${(j=(U=n==null?void 0:n.data)==null?void 0:U.data)==null?void 0:j.tranId}&module=shop&id=${(Q=(B=n==null?void 0:n.data)==null?void 0:B.data)==null?void 0:Q.tranId}`,{replace:!0})):y(n==null?void 0:n.message,"error")}},le=()=>{if(!a.values.month)return y("Please select month","error");c(`/shop-demand-details?shop_id=${m}&month=${a.values.month}`)};N.useEffect(()=>{S()},[]);const S=()=>{C(!0);const t={shopId:m};ce.post(b,t,ie()).then(l=>{l.data.status&&(X(l.data.data),te(l.data.data.payment_upto)),C(!1)}).catch(l=>{C(!1)})},re=async()=>{var t,l,i;if(await O("Are you sure you want to generate demand?")){const o=await h.mutateAsync({api:J,data:{shopId:m}});(t=o==null?void 0:o.data)!=null&&t.status?(y((l=o==null?void 0:o.data)==null?void 0:l.message,"success"),S(),u==null||u.refetch(),D.refetch()):y((i=o==null?void 0:o.data)==null?void 0:i.message,"error")}};return W?e(ye,{}):s(q,{children:[h.isLoading&&e(ge,{}),s("div",{className:"bg-[#eff2f0]",children:[s("div",{className:"col-span-12",children:[" ",e("h1",{className:`font-bold ${K} text-xl px-4 py-2 text-gray-600`,children:"Shop Details"})]}),e("div",{className:"flex justify-center items-center  overflow-hidden p-4",children:s("div",{className:"w-full md:w-1/3 rounded-lg bg-[#fdfdfd] shadow-indigo-50 shadow-md",children:[s("div",{className:"bg-[#6c68f0] rounded-lg p-4 text-white",children:[s("p",{className:"text-sm text-center font-semibold ",children:["Shop No. : ",e("span",{children:g(r==null?void 0:r.shop_no)})]}),e("p",{className:"text-center py-1",children:s("span",{className:"text-sm justify-center text-gray-50 flex",children:[e("span",{className:"",children:"Payable Amount : "}),a.values.amount]})}),((P=(E=u==null?void 0:u.data)==null?void 0:E.data)==null?void 0:P.length)>0?e(q,{children:s("form",{onSubmit:a.handleSubmit,onChange:se,children:[s("div",{className:"space-x-2 py-1",children:[s("select",{name:"paymentMode",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.paymentMode,children:[e("option",{value:"",children:"Select Payment Mode"}),e("option",{value:"CASH",children:"Cash"}),e("option",{value:"ONLINE",children:"Online"}),e("option",{value:"CHEQUE",children:"Cheque"}),e("option",{value:"DD",children:"DD"})]}),e("span",{className:"text-red-400 text-sm",children:a.touched.paymentMode&&a.errors.paymentMode})]}),((z=a==null?void 0:a.values)==null?void 0:z.paymentMode)=="CHEQUE"||((k=a==null?void 0:a.values)==null?void 0:k.paymentMode)=="DD"?s(q,{children:[s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Bank Name"}),e("input",{type:"text",name:"bankName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.bankName}),e("span",{className:"text-red-400 text-sm",children:a.touched.bankName&&a.errors.bankName})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Branch Name"}),e("input",{type:"text",name:"branchName",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.branchName}),e("span",{className:"text-red-400 text-sm",children:a.touched.branchName&&a.errors.branchName})]})]}),s("div",{className:"flex space-x-2  py-1",children:[s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque No."}),e("input",{type:"text",name:"chequeNo",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeNo}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeNo&&a.errors.chequeNo})]}),s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Cheque/DD Date"}),e("input",{type:"date",name:"chequeDdDate",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.chequeDdDate}),e("span",{className:"text-red-400 text-sm",children:a.touched.chequeDdDate&&a.errors.chequeDdDate})]})]}),e("div",{className:"flex space-x-2  py-1",children:s("div",{className:"w-1/2",children:[e("p",{className:"capitalize text-xs",children:"Upload Photo"}),e("input",{type:"file",name:"photo",onChange:t=>a.setFieldValue("photo",t.target.files[0])}),e("span",{className:"text-red-400 text-sm",children:a.touched.photo&&a.errors.photo})]})})]}):null,e("div",{className:"flex space-x-2 py-1  ",children:s("div",{className:"w-full",children:[e("p",{className:"capitalize text-xs",children:"Select Month"}),s("select",{name:"month",className:"p-1 text-gray-800 border border-gray-300 rounded-sm w-full",onChange:a.handleChange,value:a.values.month,children:[e("option",{value:"",children:"Select Month"}),(I=(A=u==null?void 0:u.data)==null?void 0:A.data)==null?void 0:I.map(t=>e("option",{value:t==null?void 0:t.monthly,children:t==null?void 0:t.monthly},t==null?void 0:t.id))]}),e("span",{className:"text-red-400 text-sm",children:a.touched.month&&a.errors.month})]})}),s("div",{className:"flex gap-5",children:[e("button",{type:"button",onClick:le,className:"bg-green-400 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Demand Detail"}),e("button",{type:"submit",className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Pay Now"})]})]})}):e("div",{className:"text-center ",children:e("button",{onClick:()=>{re()},className:"bg-amber-500 mt-1 py-2 px-2 rounded-sm capitalize text-xs w-full ",children:"Generate Demand"})})]}),e("div",{className:"bg-white shadow-lg rounded-lg  w-full mt-4",children:e("div",{children:s("ul",{children:[s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["sairat Name :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.allottee)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["Present occupier :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.present_occupier)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize  border-b shadow-sm",children:["Contact no. :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.contact_no)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["circle :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.circle_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["market :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.market_name)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["monthly rent :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.rate)})]}),s("li",{className:"p-2 px-5 text-xs text-gray-600 font-semibold capitalize border-b shadow-sm ",children:["last demand :",e("span",{className:"px-4 text-xs text-gray-500 uppercase",children:g(r==null?void 0:r.last_payment_amount)})]})]})})})]})}),e(fe,{shopReceiptListData:D})]})]})}export{Be as default};
