import{r,u as Pt,s as Tt,b as kt,A as b,e as v,Q as g,j as t,a9 as Mt,aa as Ht,a3 as $t,R as Vt,T as qt,a4 as Gt,a5 as Ot,O as Rt,B as pt,D as Jt,L as Ut,P as zt,n as Q,J as Kt,l as Qt,g as Yt}from"./index-de640f8f.js";import{B as Zt}from"./BottomErrorCard-511fba4a.js";const se=()=>{const[n,_]=r.useState([]),[h,N]=r.useState(!1),[C,Wt]=r.useState(!0),[Y,d]=r.useState(!1),[E,Xt]=r.useState(!1),[Z,W]=r.useState([]),[X,te]=r.useState(null),[f,I]=r.useState(null),[tt,y]=r.useState(!1),[F,et]=r.useState(),[D,at]=r.useState([]),[st,lt]=r.useState([]),[S,A]=r.useState(1),[w,ct]=r.useState(10),[it,B]=r.useState(),[rt,L]=r.useState(),[dt,ot]=r.useState(!1),[nt,ut]=r.useState(),{api_postSubjectGroupData:mt,api_deleteSubjectGroupData:ht,api_searchSubjectGroupData:ft,api_getactiveClassData:xt,api_editSubjectGroupData:jt,api_section_group_map:bt,api_getSubjectGroupData:vt}=Yt();Pt(),Tt("Class Master");const u=[{id:1,fee_head:10,fee_head_type:10,desc:"hello"},{id:2,fee_head:10,fee_head_type:10,desc:"hello"},{id:3,fee_head:10,fee_head_type:10,desc:"hello"},{id:4,fee_head:10,fee_head_type:10,desc:"hello"},{id:5,fee_head:10,fee_head_type:10,desc:"hello"}],c=kt({initialValues:{classId:"",sectionData:[],subject:[{subjectName:""}]},onSubmit:(e,s)=>{console.log("at submit ",e,st);let l=[];e.sectionData.map(i=>e.subject.map(o=>l.push({...o,...i,classId:c.values.classId})));const a=l.map(i=>({subjectName:i.subjectName,section:i.section_name,sectionId:i.id,classId:parseInt(i.classId)}));console.log(a,l),yt(a),c.resetForm()}});console.log(c.values.classId,c.values.sectionData);const gt=n;console.log(n);const Nt=e=>{ct(parseInt(e)),N(!0)},St=e=>{A(e-1)},wt=e=>{A(e+1)};r.useEffect(()=>{S&&h&&m()},[S,h]),r.useEffect(()=>{w&&h&&m()},[w,h]);const yt=e=>{console.log(e),d(!0);let s,l,a={subjectGroupMap:e};f!==null?(s=jt,l=a,l.id=f):(e==null?void 0:e.bankName)!==""&&f==null&&(s=mt,l=a),b.post(s,l,v()).then(function(i){var o,x,j;console.log("bank master..",(o=i==null?void 0:i.data)==null?void 0:o.data),((x=i==null?void 0:i.data)==null?void 0:x.status)===!0?(g.success(f!==null?"Data Updated Successfully!":"Data Added Successfully"),m(),I(null)):g.error(`${(j=i==null?void 0:i.data)==null?void 0:j.message}`),d(!1)}).catch(function(i){console.log("==2 error list...",i),g.warning("Error occured in submitting form."),d(!1)})},Dt=e=>{let s=[];for(let l=0;l<e.length;l++)s.push({section_name:e[l].section_name,sectionName:e[l].sectionName});lt(s)};r.useState(()=>{Dt([c.values.sectionData])},[c.values.sectionData]);const _t=[{Header:"Sl No.",Cell:({cell:e})=>t.jsx("span",{children:Q(e.row.index+1)})},{Header:"Class",accessor:"class_name"},{Header:"Section",accessor:"section_name"},{Header:"Subject",accessor:"subject_name"},{Header:"Status",Cell:({cell:e})=>{var s,l;return t.jsx("span",{className:((s=e.row.original)==null?void 0:s.status)==="Active"?"text-[green]":"text-[red]",children:Q((l=e.row.original)==null?void 0:l.status)})}},{Header:"Created Date",accessor:"date"},{Header:"Created Time",accessor:"time"},{Header:"Action",Cell:({cell:e})=>{var s,l;return t.jsx("div",{className:"flex",children:t.jsx("button",{onClick:()=>{var a,i;I((a=e.row.original)==null?void 0:a.id),et(((i=e.row.original)==null?void 0:i.status)==="Active"?"deactive":"active"),y(!0)},className:`${((s=e.row.original)==null?void 0:s.status)=="Active"?"deactivate-button-master":"deactivate-second-button-master"}`,children:((l=e.row.original)==null?void 0:l.status)==="Active"?"Deactivate":"Activate"})})}}],Ct=()=>{d(!0),y(!1);let e={id:f,status:F};b.post(ht,e,v()).then(function(s){var l,a;((l=s==null?void 0:s.data)==null?void 0:l.status)===!0?m():activateBottomErrorCard(!0,`${(a=s==null?void 0:s.data)==null?void 0:a.message}`),d(!1)}).catch(function(s){activateBottomErrorCard(!0,"Error occured in deletion.1"),d(!1)})},m=(e=null)=>{console.log(e);let s,l;e===null?(l={perPage:w,page:S},s=vt):(l={search:e},s=ft),d(!0),b.post(s,l,v()).then(function(a){var i,o,x,j,P,T,k,M,H,$,V,q,G,O,R,p,J,U,z,K;((i=a==null?void 0:a.data)==null?void 0:i.status)===!0?((x=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:x.total)===0||((P=(j=a==null?void 0:a.data)==null?void 0:j.data)==null?void 0:P.data.length)===0?(g.error("Data not Found"),_((k=(T=a==null?void 0:a.data)==null?void 0:T.data)==null?void 0:k.data),B((H=(M=a==null?void 0:a.data)==null?void 0:M.data)==null?void 0:H.last_page),L((V=($=a==null?void 0:a.data)==null?void 0:$.data)==null?void 0:V.total),N(!1)):(console.log("class section map data",(G=(q=a==null?void 0:a.data)==null?void 0:q.data)==null?void 0:G.data),_((R=(O=a==null?void 0:a.data)==null?void 0:O.data)==null?void 0:R.data),B((J=(p=a==null?void 0:a.data)==null?void 0:p.data)==null?void 0:J.last_page),L((z=(U=a==null?void 0:a.data)==null?void 0:U.data)==null?void 0:z.total),N(!1)):g.error(`${(K=a==null?void 0:a.data)==null?void 0:K.message}`),d(!1)}).catch(function(a){activateBottomErrorCard(!0,"Error occured while fetching data.2"),d(!1)})},Et=()=>{d(!0),b.post(xt,{},v()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),at(e==null?void 0:e.data.data)):activateBottomErrorCard(!0,"Error occured while fetching data.3"),d(!1)}).catch(function(e){console.log("==2 error list...",e),activateBottomErrorCard(!0,"Error occured while fetching data.4"),d(!1)})},It=e=>{d(!0),b.post(bt,{classId:e},v()).then(function(s){var l,a,i;((l=s==null?void 0:s.data)==null?void 0:l.status)===!0?(console.log(s==null?void 0:s.data),c.setFieldValue("sectionData",(i=(a=s==null?void 0:s.data)==null?void 0:a.data)==null?void 0:i.map(o=>({...o,sectionName:!0})))):activateBottomErrorCard(!0,"Error occured while fetching data.5"),d(!1)}).catch(function(s){console.log("==2 error list...",s),activateBottomErrorCard(!0,"Error occured while fetching data.6"),d(!1)})};r.useEffect(()=>{c.values.classId!=""&&It(parseInt(c.values.classId))},[c.values.classId]),r.useEffect(()=>{m(),Et()},[]);const Ft=e=>{e.target.name},At=(e,s)=>{let l=e.target.name,a=e.target.value;l==`subject.${s}.subjectName`&&c.setFieldValue(`subject.${s}.subjectName`,Kt(a,c.values.subject[s].subjectName,50))};r.useEffect(()=>{const e=n.map(s=>{const{id:l,...a}=s;return a});console.log(e),W(e)},[n]);const Bt=[{title:"Class",feild:"class_name"},{title:"Section",feild:"section_name"},{title:"Subject",feild:"subject_name"},{title:"Created Date  ",feild:"date"},{title:"Created Time ",feild:"time"},{title:"Status",feild:"status"}],Lt=()=>{const e=new Qt;e.text("Subject Map Details",10,10),e.autoTable({theme:"grid",columns:Bt.map(s=>({...s,dataKey:s.feild})),body:n}),e.save("SubjectMap.pdf")};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full h-[76vh] lg:h-auto overflow-auto ",children:[t.jsxs("div",{className:"flex items-start justify-start flex-col mt-5 ml-5 ",children:[t.jsx("h1",{className:"text-4xl font-semibold text-gray-700",children:"Subject Master Form"}),t.jsx("h1",{className:"common-header-smalltext",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]}),t.jsx("div",{className:" mt-3 ml-3 mr-3 ",children:t.jsx("div",{className:"flex h-auto  items-start justify-start w-full",children:t.jsxs("div",{className:"grid grid-cols-12 w-full  ml-3 mr-3",children:[t.jsx("div",{className:"col-span-12 lg:col-span-5 w-full flex justify-center",children:t.jsxs("div",{className:"mt-5 border border-teal-300 w-full  rounded-md relative",children:[t.jsxs("div",{className:"bg-white px-3 ",children:[" ",t.jsx("h1",{className:" absolute text-2xl bg-white flex font-semibold  -mt-4 text-[#0F766E] ml-9",children:"Add"})]}),t.jsxs("div",{className:"w-full mb-6 mt-[4vh] pb-10  ",children:[t.jsx(Mt,{value:c,children:t.jsxs(Ht,{onSubmit:c.handleSubmit,onChange:Ft,children:[t.jsxs("div",{className:"grid grid-cols-12",children:[t.jsx("div",{className:" col-span-12 lg:col-span-3",children:t.jsxs("label",{className:"  text-teal-900 text-sm w-[10vw]   font-semibold",htmlFor:"",children:["Class Name",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})}),t.jsxs("div",{className:"col-span-12 lg:col-span-9",children:[t.jsxs("select",{...c.getFieldProps("classId"),className:"common-input-css",type:"text",placeholder:"Enter class",children:[t.jsx("option",{value:"",children:"Select"}),D==null?void 0:D.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.class_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:c.touched.classId&&c.errors.classId?c.errors.classId:null})]})]}),c.values.sectionData.length>0&&t.jsx("div",{className:"col-span-12 mt-4",children:t.jsx("div",{className:"overflow-x-auto pt-4 ",children:t.jsx("div",{className:"w-[95%] ml-5 flex items-center  justify-center border border-teal-300 ",children:t.jsxs("div",{className:"w-full   relative",children:[t.jsxs("div",{className:"absolute",children:[" ",t.jsxs("h1",{className:" bg-white text-teal-900 text-sm font-semibold items-start justify-start px-2 mt-[-10px] ml-7 ",children:[" ","Section"," ",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})]}),t.jsx("div",{className:"w-full h-[10vh] flex items-center justify-start",children:c.values.sectionData&&c.values.sectionData.map((e,s)=>t.jsxs("div",{className:"mx-10",children:[t.jsx("input",{name:"sectionName",value:e==null?void 0:e.section_name,checked:c.values.sectionData[s].sectionName===!0,onChange:()=>c.setFieldValue(`sectionData.${s}.sectionName`,!(e!=null&&e.sectionName)),type:"checkbox",className:"text-slat-500  ml-[10px]  text-teal-900 w-5 h-5 font-bold mt-2   "})," ",t.jsx("span",{className:"ml-2 -mt-6",children:e.section_name})]}))})]})})})}),c.values.sectionData.length>0?t.jsx(t.Fragment,{children:t.jsx("div",{className:"w-[95%] ml-5 flex items-center mt-8 justify-center border border-teal-300  h-[34vh] overflow-auto",children:t.jsx("div",{className:"w-full  relative",children:t.jsxs("div",{className:"h-[32vh] overflow-auto",children:[" ",t.jsx("div",{className:"w-full ",children:t.jsx($t,{name:"subject",children:e=>t.jsx(t.Fragment,{children:(c==null?void 0:c.values.subject.length)>0&&(c==null?void 0:c.values.subject.map((s,l)=>t.jsx(Vt.Fragment,{children:t.jsx("div",{className:"w-full h-auto overflow-auto flex items-center justify-center",children:t.jsxs("div",{className:"flex mt-[4vh] max-[700px]:block",children:[t.jsx(qt,{formik:c,label:"Subject Name",name:`subject.${l}.subjectName`,isDynamic:!0,placeholder:"Enter subject name",onChange:a=>At(a,l)}),t.jsxs("div",{className:" px-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add & Remove Subject"}),l>0&&t.jsx("button",{className:"mt-1",type:"button",onClick:()=>e.remove(l),children:t.jsx(Gt,{className:"inline-block w-9 h-9 text-red-600"})}),"|",t.jsx("button",{type:"button",className:"mt-1",onClick:()=>{if(s.subjectName==="")return activateBottomErrorCard(!0,"fill the subject name");e.push({subjectName:""})},children:t.jsx(Ot,{className:"inline-block w-9 h-9 text-blue-600"})})]})]})})},l)))})})})]})})})}):null,t.jsx("div",{className:"mt-3",children:t.jsx("button",{type:"submit",className:"save-button",children:"Save"})})]})}),t.jsx("div",{className:"mandatorytext",children:t.jsxs("h1",{children:["Note : (*) is a mandatory field, Section Name must be character (A-Z,a-z)"," "]})})]})]})}),t.jsx("div",{className:" col-span-12 lg:col-span-7 w-full lg:ml-2 ",children:t.jsxs("div",{className:"mt-5 border border-teal-300   rounded-md relative",children:[t.jsxs("div",{className:"bg-white px-3 ",children:[" ",t.jsx("h1",{className:" absolute text-2xl bg-white flex font-semibold  -mt-4 text-gray-500 ml-9",children:"View List"})]}),t.jsx("div",{className:"mt-5  ",children:t.jsx(Rt,{generatePdf:Lt,enable:dt,setenable:ot,csvdata:Z,readymadeListData:n,fetchMasterList:m,setSearchTableData:ut,searchTableData:nt})}),t.jsx("div",{className:"-mt-5 main-div",children:t.jsxs("div",{className:" rounded-md h-[80vh] 2xl:p-6 p-4 overflow-y-auto",children:[Y&&t.jsx(pt,{}),E&&t.jsx(Zt,{activateBottomErrorCard,errorTitle:X}),E&&t.jsxs("div",{className:"alert-msg",role:"alert",children:[t.jsx("strong",{className:"sorry-msg",children:"Sorry! "}),t.jsx("span",{className:"some-error-msg",children:"Some error occured while fetching list. Please try again later"}),t.jsx("span",{className:"absolute-span"})]}),tt&&t.jsx(Jt,{setdeleteStatus:y,deleteItem:Ct,deactivate:F}),t.jsx("div",{className:"h-[55vh] overflow-auto",children:C&&(u==null?void 0:u.length)!=0&&t.jsxs(t.Fragment,{children:[t.jsx(Ut,{filter:!1,exportStatus:!1,assessmentType:!1,columns:_t,dataList:gt,pageNumber:rt}),t.jsx(zt,{ChangePage:Nt,number:S,lastPage:it,nextPage:wt,prevPage:St,postperpage:w,blockToast:h,setBlockToast:N})]})}),C&&(u==null?void 0:u.length)==0&&t.jsx("div",{className:"data-not-found",children:"Data Not Found"})]})})]})})]})})})]})})};export{se as default};
