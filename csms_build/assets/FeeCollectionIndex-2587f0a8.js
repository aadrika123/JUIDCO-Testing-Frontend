import{r,c as T,a as V,u as Y,b as R,j as e,B as Z,A as j,e as N,Q as U,g as H}from"./index-de640f8f.js";import{B as _}from"./BottomErrorCard-511fba4a.js";const q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFIElEQVR4nO1aW2hcRRie8dJo1bZpkp3ZNLaltUUC3thk5/83i3moQvCKD0W0giASFNtaNTlnEx/ikxpUJFLFC3iplwexBGoJ1iptzWUmYYs+2IdoS+yDWuOlNEbwgl2Zs6e5bC67s9nuOWfdD/6XmTPf/893/vl3Zs4SkgMsIXfboFI5mVATtpCfdERVPSkQNJcF8oDDnWMcOuZC+Se2kN05CzBlctIWMl4A33GHy9S/kN2kcEhRW8inTIOwQJ5pbxxuyHvyUXWdJdRv5uKrni6SuoAUGpaQOy2Q/xpmws/5LIdE4/BmC9QpQ19nLVAWOZ9oh6FtNsi/zdJRfZ9oGNmQqw+7KbnWFvKkUbYJ9Y+N6gFSDLTj8BaTguSuyZN6Ytm4O2FojQXyhGm9SQh5CykmEjjSaAk1blgTRjuEZAtxPh5JVlsgjxlm168WDsaIF2iLDWy0hTpuKMJXiXh/ZSZXV1StsEAlDSf/XQcOXk28RGckGdaTMluvcqir+dDlU5OPJJdbQh4xFPLYkw0jVxI/4NHmL1fZIL8wLFoHd7T0VejxFqgOszWv+ufLIk+xo6WvwgL1kWFh7O1qPnRRayR5sS3kxzkKt09nDPEjtm798EIb1Otmqaze1ZuWrvqvl+ktdJal844Wi/gbqXx2jS/rkfrN6vRe4JkezU2CAgvUdqNdo5BP63F2JLnSFurodJ88a0VVm9fzKSNv1MEaEopvyMv02MCCi4cpg3HKMbUkYzBOODxEAoUQ3OsG/ydl2E85HszLGA44HBxThIm7SVBAOQw5QYehaclkYRFPi4kDxHcI4RYSxtZMoxx+pxwmpp+DayiH3aQOVmflrIpd4Txbizeca9JcmnM+X04MnoCJ9VnW7umpCTB4Lp3GcHt2XrzNfeMvzBh/ejFfpFpsIkVHbex6N4BvKIdnZ5mz9qcFIBxvpAz7SDhSnZWXx2sox09nLh9HAKcWZPhxfGNKx0I8E4BBb2aXG/C0AEvEQnzat/cCcByjDF6bbfhX2jLb87UF+LRvHwiQ8to8FgAGSQhu8sK0b1/WgGLBHzWAlQXoNRavvn4ZCcM2yvElbYTH7nPa/hcZUC02UYajczdOOEpqGzeXtgB1cCnl+K1bPD/XhyYSwnsoh8/ctuP6mdIVIAQPumMO6Phn9FC9U0wfoLC1ZAWgHN9yAg6JO+Z0MrzV5dtTugIw2OMEzKFlTmdI3Owugw9KVgDCcOdCk6QM33PFeax0BaiMrKQcf3Sr/tvOia8GY5TDm+6vwSmyrnlV6QqgwSBKOfw0791fqAmIAYIpgIa+GWKYoBz3aSMh6CS1jVXEEMEVoEAIngDs2st0tScc7p9zt6fb9CkvHFleegJc1VJBOXZThn9k/w6gn4Fn9JjSEGBd8yWUwRF3gpPpn7vMu72pO7730zfKjhCHs4kQCAEowxfdCR0lNbGNWXmrYrWU47DL/XywBVgbr3Tu8vQ3AibW58wdEoxyPKNvghfbF/hfgDDc5b79V03pKcc30ueG2J3BFYDB9vT2Fp8w5ufYlv6Ygo8EV4Aw7EofcWGXMX8OYwMjAGX4C+VwwsicMYEXQMTPfd7Oz2BisS/M/hfgPKMsACtnQK8vlwDl0OMWssP6Dw+z2vI1hq8EJgMoh/1uIRubIcD+pf1ZCvcGRoBioSwAK2dAry+XAF1qwSuhIpgqmJWL4Fz4NgOKhbIAzA8ZwHGy4AUvZ9O+vRJgdXQF5fBDwYuduY3pWPKdx3/lUsB8H5IGuQAAAABJRU5ErkJggg==",le=()=>{var y,A;let g=new Date().toISOString().slice(0,10);console.log(g),r.useState("");const[w,S]=r.useState(!1),[F,E]=r.useState(null),[C,h]=r.useState(!1),[$,M]=r.useState([]),{api_master_fee_collection_search:I,api_payment_mode_active_all:P,api_fee_collection_store:ee,api_fetch_fee_collection:B}=H(),[f,k]=r.useState([]),[c,u]=r.useState([]),[b,O]=r.useState(0),[l,W]=r.useState(),[se,D]=r.useState([]),[v,Q]=r.useState(!1),X=T({admissionNo:V().required("Admission number is required feild")}),z=Y(),d=R({initialValues:{admissionNo:"",paymentModeId:"1"},onSubmit:async s=>{console.log("at submit ",s),await L(s),Q(!v)},validationSchema:X}),J=async()=>{var s,t;try{const a=await j.post(P,{},N());console.log("paymentMode",a==null?void 0:a.data),((s=a==null?void 0:a.data)==null?void 0:s.status)===!0&&k((t=a==null?void 0:a.data)==null?void 0:t.data)}catch(a){console.log("paymentMode",a),p(!0,"Error occured in submitting form.")}},L=async s=>{var t,a,n,i,x;h(!0);try{const o=await j.post(I,{admissionNo:s.admissionNo},N());console.log("paymentMode",o==null?void 0:o.data),((t=o==null?void 0:o.data)==null?void 0:t.status)===!0?(W((n=(a=o==null?void 0:o.data)==null?void 0:a.data)==null?void 0:n.studentDetails),u((x=(i=o==null?void 0:o.data)==null?void 0:i.data)==null?void 0:x.monthly_fee.map(m=>({...m,isPaid:!1})))):(console.log("==2 error list...",error),U.warning("Error occured in submitting form"),h(!1)),h(!1)}catch(o){console.log("paymentMode",o),p(!0,"Error occured in submitting form."),h(!1)}},G=s=>{},p=(s,t)=>{E(t),S(s)};console.log(l),r.useEffect(()=>{D(c.reduce((s,t)=>{var a;return t.isPaid?[...s,{admissionNo:l==null?void 0:l.admissionNo,monthName:t==null?void 0:t.month_name,totalFee:t==null?void 0:t.total,isPaid:t!=null&&t.isPaid?1:0,paymentDate:g,paymentModeId:parseInt((a=d==null?void 0:d.values)==null?void 0:a.paymentModeId),grandTotal:b}]:s},[])),O(c.reduce((s,t)=>t.isPaid?s+t.total:s,0))},[c,(y=d==null?void 0:d.values)==null?void 0:y.paymentModeId]);const K=async()=>{var s,t;try{const a=await j.post(B,{admissionNo:l==null?void 0:l.admissionNo},N());console.log("fetchFeeColl",a==null?void 0:a.data),((s=a==null?void 0:a.data)==null?void 0:s.status)==!0&&(M((t=a==null?void 0:a.data)==null?void 0:t.data),u(n=>n.map(i=>{var x,o;return{...i,isPaid:(o=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:o.some(m=>(m==null?void 0:m.month_name)==(i==null?void 0:i.month_name))}})))}catch(a){console.log("paymentMode",a),p(!0,"Error occured in submitting form.")}};return r.useEffect(()=>{K()},[v]),r.useEffect(()=>{J()},[(A=d==null?void 0:d.values)==null?void 0:A.paymentModeId]),e.jsxs(e.Fragment,{children:[C&&e.jsx(Z,{}),w&&e.jsx(_,{activateBottomErrorCard:p,errorTitle:F}),e.jsx("form",{onSubmit:d.handleSubmit,onChange:G,children:e.jsxs("div",{className:"px-3 w-[70%] m-auto space-y-5 h-[80vh] overflow-auto",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-[32px] font-semibold text-gray-700",children:"Fee Collection"}),e.jsx("p",{className:"text-teal-600",children:"Securing a Bright Future: Collecting Fees to Support Education Excellence"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg shadow-lg w-full m-auto p-5 ",children:[e.jsxs("div",{className:"flex items-center justify-center gap-14 flex-wrap ",children:[e.jsx("div",{children:e.jsx("p",{className:"text-2xl font-semibold text-teal-900",children:"Date"})}),e.jsx("div",{children:e.jsx("input",{disabled:!0,type:"text",className:"border rounded-lg shadow-md w-full h-10 px-8 block -mt-1 ",placeholder:"",value:g})}),e.jsx("div",{children:e.jsxs("p",{className:"text-2xl font-semibold text-teal-900",children:["Admission No"," ",e.jsx("small",{className:"mt-1 -ml-1 text-lg font-semibold text-red-600 inline ",children:"*"})]})}),e.jsxs("div",{children:[" ",e.jsx("input",{...d.getFieldProps("admissionNo"),type:"text",className:"border rounded-lg shadow-md w-full h-10 px-8 block -mt-1 ",placeholder:"Enter admission no"})]}),e.jsxs("div",{children:[" ",e.jsx("button",{type:"submit",className:"text-white bg-[#0F766E] w-full px-10 mr-9 rounded-lg font-semibold py-2",children:"Search"})]})]}),e.jsx("span",{className:"text-red-600 ml-[45vh]  text-sm mt-2",children:d.touched.admissionNo&&d.errors.admissionNo?d.errors.admissionNo:null})]}),c.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("p",{className:"ml-5 text-gray-700 font-bold text-xl",children:["Name - ",l==null?void 0:l.fullName]}),e.jsxs("div",{className:"flex justify-between rounded-lg shadow-lg border border-gray-200 p-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Admission No"}),e.jsx("p",{className:"text-[18px] font-medium text-gray-500",children:l==null?void 0:l.admissionNo})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Class"}),e.jsx("p",{className:"text-[18px] font-medium text-gray-500 text-center",children:l==null?void 0:l.className})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Sec"}),e.jsx("p",{className:"text-[18px] font-medium text-gray-500 text-center",children:l==null?void 0:l.sectionName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl text-gray-700",children:"Status"}),e.jsx("p",{className:"text-[18px] font-medium text-green-500 text-center",children:l==null?void 0:l.status})]}),e.jsx("div",{children:e.jsx("img",{src:q,alt:"Id Card",className:"opacity-80 h-12"})})]}),e.jsxs("div",{className:"m-auto mt-5 overflow-auto",children:[e.jsxs("div",{className:"grid grid-cols-12 font-semibold text-lg text-gray-700",children:[e.jsx("div",{className:"col-span-3 ml-5",children:"Months"}),e.jsx("div",{className:"col-span-3 ml-3",children:"Fees"}),e.jsx("div",{className:"col-span-2",children:"Amount"}),e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-2 mx-auto flex justify-start items-center",children:e.jsx("input",{type:"checkbox",className:"w-6 h-6",onChange:s=>{const t=c.map(a=>({...a,isPaid:s.target.checked}));u(t)},checked:(c==null?void 0:c.filter(s=>(s==null?void 0:s.isPaid)==!0).length)==(c==null?void 0:c.length)})})]}),e.jsxs("div",{className:" rounded-lg shadow-lg border border-gray-200 px-5",children:[c&&c.map((s,t)=>{var a;return e.jsxs("div",{className:"grid grid-cols-12 text-gray-600 border-b py-2",children:[e.jsx("div",{className:"col-span-3 ",children:s.month_name}),e.jsxs("div",{className:"col-span-3",children:[s.fee.map(n=>e.jsx(e.Fragment,{children:e.jsx("div",{children:n.fee_head})})),e.jsx("div",{className:"font-bold text-black",children:"Total "})]}),e.jsxs("div",{className:"col-span-2",children:[s.fee.map(n=>e.jsxs("p",{children:["₹ ",n.amount]})),e.jsxs("p",{className:" text-black font-bold w-full px-10",children:["₹ ",s.total]})]}),e.jsx("div",{className:"col-span-1 border-r-2 border-gray-200 my-2"}),e.jsx("div",{className:"col-span-2 m-auto text-center",children:e.jsx("input",{type:"checkbox",onChange:n=>{const i=c.map((x,o)=>o==t?{...x,isPaid:n.target.checked}:o>t?{...x,isPaid:!1}:x);u(i)},checked:s==null?void 0:s.isPaid,className:"w-6 h-6  content-center",disabled:t==0?!1:!((a=c[t-1])!=null&&a.isPaid)})})]},t)}),e.jsxs("div",{className:"grid grid-cols-12 mt-4 mb-4",children:[e.jsx("div",{className:"col-span-6",children:e.jsxs("p",{className:"font-bold text-lg text-black",children:[" ","Sub Total"," "]})}),e.jsx("div",{className:"col-span-4",children:e.jsxs("p",{className:" px-3 w-1/2  font-bold text-black",children:["₹ ",b]})})]})]})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg shadow-xl w-full m-auto p-5 ",children:[e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-x-5",children:[e.jsx("div",{children:e.jsx("p",{className:"font-bold text-lg text-gray-700",children:"Payment Mode"})}),e.jsx("div",{children:e.jsx("select",{className:"border rounded-lg shadow-md w-full h-10 px-8 ",...d==null?void 0:d.getFieldProps("paymentModeId"),children:f==null?void 0:f.map(s=>e.jsx("option",{value:s==null?void 0:s.id,children:s==null?void 0:s.payment_mode_name}))})})]}),e.jsx("div",{className:"mt-3 ",children:e.jsx("div",{className:"flex justify-center py-5",children:e.jsx("button",{type:"button",className:"bg-green-700 px-3 py-1 text-white font-semibold rounded shadow",onClick:()=>z("/receipt"),children:"Pay Now"})})})]})]}):e.jsx("span",{children:"No record found"})]})})]})};export{le as default};
