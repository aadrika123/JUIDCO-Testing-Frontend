import{a as b,u as ce,j as e,B as me,C as xe,e as N,_ as f,i as be,h as Ne,I as le}from"./index-Bkq7pC9t.js";import{r as y,u as ve,i as we}from"./router-DWxcwEcu.js";import{P as ke}from"./index-DJwAPkdW.js";import{C as p,b as ne}from"./card-CM9Ojm8U.js";import{S as re}from"./separator-dyZX5VRq.js";import{S as j}from"./SkeletonLoader-xYERdTcX.js";import{u as he,F as ue,c as fe,a as u,o as ge}from"./switch-Dgrtwke-.js";import{R as oe}from"./RHFTextField-B7MddfO2.js";import{R as pe}from"./RHFTextArea-DZb-3pC6.js";import{B as je}from"./ButtonLoading-mtaXmgkN.js";import{R as Ce}from"./SelectField-BnDhvzbC.js";import"./headlessui-DlCzxctq.js";import"./axios-BrYcoDUu.js";const Fe=fe().shape({reminderDate:u().required().label("Reminder Date"),reminderTime:u().required().label("Reminder Time"),remarks:u().required().label("Remarks")});function Ae({open:l,setOpen:c,title:n,aptData:x}){const{user:r}=b(),i=ce({}),t=()=>c(!l),a=he({resolver:ge(Fe),defaultValues:{reminderDate:"",reminderTime:"",remarks:""}}),h=async d=>{xe("Are you sure?","Please confirm",async()=>{try{const o=await i.mutateAsync({api:N.postReminder,data:{...d,userId:r==null?void 0:r.id,consumerId:x}});o.data.status?(f.success(o.data.msg),c(!1)):f.error(o.data.msg)}catch(o){f.error(o.msg)}})};return e.jsxs("div",{children:[l&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(l?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:n!=null?n:"Add Reminder"}),e.jsxs("button",{style:{background:"none"},onClick:t,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs(ue,{methods:a,onSubmit:a.handleSubmit(h),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(oe,{name:"reminderDate",label:"Reminder Date",type:"date",isRequired:!0,min:new Date().toISOString().split("T")[0]})}),e.jsx("div",{children:e.jsx(oe,{name:"reminderTime",label:"Reminder Time",type:"time",isRequired:!0})}),e.jsx("div",{className:"col-span-2",children:e.jsx(pe,{name:"remarks",label:"Remarks",isRequired:!0})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 mb-2",children:[e.jsx(me,{size:"sm",type:"button",onClick:t,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(je,{isLoading:i.isLoading,disabled:i.isLoading,size:"sm",type:"submit",className:"w-20",children:"SUBMIT"})]})]})})]})})})]})}const Re=[{value:"Door Closed",label:"Door Closed"},{value:"No Response from CitizenCitizen Will Pay Next Month",label:"No Response from Citizen"},{value:"Citizen Will Pay Next Day",label:"Citizen Will Pay Next Day"},{value:"Citizen Will Pay Next Month",label:"Citizen Will Pay Next Month"},{value:"Refuses to Pay",label:"Refuses to Pay"},{value:"other",label:"Other"}],$e=fe().shape({denyList:u().required("Deny List is required"),latitude:u(),longitude:u(),remarks:u().required("Remarks is required")});function Le({open:l,setOpen:c,title:n,aptData:x}){const r=ce({}),{user:i}=b(),{coords:t,isGeolocationEnabled:a}=be(),h=()=>c(!l),d=he({resolver:ge($e),defaultValues:{denyList:"",latitude:"",longitude:"",remarks:""}}),o=async g=>{c(!1),xe("Are you sure?","Please confirm",async()=>{try{const m=await r.mutateAsync({api:N.postPaymentDeny,data:{...g,userId:i==null?void 0:i.id,consumerId:x}});m.data.status?(f.success(m.data.msg),c(!1)):f.error(m.data.msg)}catch(m){f.error(m.msg)}})};return y.useEffect(()=>{x&&(d.setValue("latitude",String(t==null?void 0:t.latitude)),d.setValue("longitude",String(t==null?void 0:t.longitude))),d.watch("denyList")!=="other"&&d.setValue("remarks",d.watch("denyList")),d.watch("denyList")==="other"&&d.setValue("remarks","")},[d.watch("denyList")]),e.jsxs("div",{children:[l&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(l?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:n!=null?n:"Add Deny"}),e.jsxs("button",{style:{background:"none"},onClick:h,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:a?e.jsxs(ue,{methods:d,onSubmit:d.handleSubmit(o),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(Ce,{name:"denyList",label:"Deny List",data:Re,isRequired:!0})}),d.watch("denyList")==="other"&&e.jsx("div",{className:"col-span-2",children:e.jsx(pe,{name:"remarks",label:"Remarks",isRequired:!0})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 mb-2",children:[e.jsx(me,{size:"sm",type:"button",onClick:h,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(je,{isLoading:r.isLoading,disabled:r.isLoading,size:"sm",type:"submit",className:"w-20",children:"SUBMIT"})]})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("h1",{className:"text-sm font-semibold text-red-600",children:"Please enable location to continue"})})})]})})})]})}const Me=[{title:"View & Pay",icon:"/icons/grid.svg",link:"/juidco-swm-app/consumer-payment",bg:"bg-gradient-to-tl from-[#EEF2FF] to-[#9CC6F7]",accessMenu:["4","5"]},{title:"Transaction History",icon:"/icons/history.svg",link:"/juidco-swm-app/tran-history",bg:"bg-gradient-to-tl from-[#FFEFE4] to-[#FFBC96]",accessMenu:["4","5"]},{title:"Geo Map",icon:"/icons/location.svg",link:"/juidco-swm-app/con-geo-map",bg:"bg-gradient-to-tl from-[#E4F6FF] to-[#9ADCFF]",accessMenu:["4","5"]},{title:"Reminder",icon:"/icons/bells.svg",link:"/juidco-swm-app/details",bg:"bg-gradient-to-tl from-[#FEE8FF] to-[#E4AFFF]",accessMenu:["4","5"]},{title:"Deny",icon:"/icons/deniel2.svg",link:"/juidco-swm-app/details",bg:"bg-gradient-to-tl from-[#FFECEC] to-[#FECACA]",accessMenu:["4","5"]},{title:"Geo Tagging",icon:"/icons/location.svg",link:"/juidco-swm-app/con-geo-tagging",bg:"bg-gradient-to-tl from-[#E1FFC3] to-[#C9F98D]",accessMenu:["4","5"]},{title:"Update Consumer",icon:"/icons/update.svg",link:"/juidco-swm-app/update-consumer",bg:"bg-gradient-to-tl from-[#EAD9FF] to-[#C291FF]",accessMenu:["4"]},{title:"Deactivate Consumer",icon:"/icons/deactivate.svg",link:"/juidco-swm-app/con-deactivated",bg:"bg-gradient-to-tl from-[#FFECEC] to-[#FECACA]",accessMenu:["4"]},{title:"Payment Adjustment",icon:"/icons/cur.svg",bg:"bg-gradient-to-tl from-[#FFF5CE] to-[#FCD451]",link:"/juidco-swm-app/demand-con-adjust",accessMenu:["4"]},{title:"Print Demand",icon:"/icons/denial.svg",bg:"bg-gradient-to-tl from-[#E1FFC3] to-[#C9F98D]",link:"/juidco-swm-app/print-demand-con",accessMenu:["4"]},{title:"Add Renter",icon:"/icons/add-consumer.svg",bg:"bg-gradient-to-tl from-[#E4F6FF] to-[#9ADCFF]",link:"/juidco-swm-app/add-renter",accessMenu:["4"]}];function Ue(){var h,d,o,g,m,v,w,k,C,F,A,R,$,L,M,E,P,S,T,I,z,B,q,O,V,H,W,G,U,_,D,Y,J,K,Q,X,Z,ee,ae,se,te;const{user:l}=b(),[c,n]=y.useState(!1),[x,r]=y.useState(!1),i=ve(),{id:t}=we(),a=Ne({api:"".concat(N.getConsumerDetailsById,"/").concat(t),options:{enabled:!!t}});return a!=null&&a.isLoading?e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm",children:e.jsx(p,{children:e.jsxs(ne,{children:[e.jsx(j,{}),e.jsx(j,{}),e.jsx(j,{})]})})}):e.jsxs(ke,{title:"Consumer Action",children:[c&&e.jsx(Ae,{open:c,setOpen:n,aptData:(h=a==null?void 0:a.data)==null?void 0:h.data[0].id}),x&&e.jsx(Le,{open:x,setOpen:r,aptData:(d=a==null?void 0:a.data)==null?void 0:d.data[0].id}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(le,{src:"/assets/image/category.png",alt:"Add Consumer",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"Consumer Action"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Consumer action details here."})]})]}),e.jsx(re,{}),e.jsx(p,{children:e.jsx(ne,{children:e.jsxs("div",{className:"flex flex-wrap",children:[e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer No:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(g=(o=a==null?void 0:a.data)==null?void 0:o.data[0])==null?void 0:g.consumerNo})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer Name:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(v=(m=a==null?void 0:a.data)==null?void 0:m.data[0])==null?void 0:v.consumerName})}),((k=(w=a==null?void 0:a.data)==null?void 0:w.data[0])==null?void 0:k.holdingNo)!=""&&((F=(C=a==null?void 0:a.data)==null?void 0:C.data[0])==null?void 0:F.holdingNo)!=null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Holding No:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:($=(R=(A=a==null?void 0:a.data)==null?void 0:A.data[0])==null?void 0:R.holdingNo)!=null?$:"--"})})]}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer Mobile:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(M=(L=a==null?void 0:a.data)==null?void 0:L.data[0])==null?void 0:M.mobileNo})}),((P=(E=a==null?void 0:a.data)==null?void 0:E.data[0])==null?void 0:P.monthlyDemand)>"0"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Monthly Demand/Rate:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(T=(S=a==null?void 0:a.data)==null?void 0:S.data[0])==null?void 0:T.monthlyDemand})})]}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Outstanding Demand:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(z=(I=a==null?void 0:a.data)==null?void 0:I.data[0])==null?void 0:z.totalDemand})}),((q=(B=a==null?void 0:a.data)==null?void 0:B.data[0])==null?void 0:q.totalDemand)>"0"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Demand from:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(V=(O=a==null?void 0:a.data)==null?void 0:O.data[0])==null?void 0:V.demandFrom})})]}),((W=(H=a==null?void 0:a.data)==null?void 0:H.data[0])==null?void 0:W.totalDemand)>"0"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Demand upto:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(U=(G=a==null?void 0:a.data)==null?void 0:G.data[0])==null?void 0:U.demandUpto})})]}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer type:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(D=(_=a==null?void 0:a.data)==null?void 0:_.data[0])==null?void 0:D.cansumerType})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Address:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(J=(Y=a==null?void 0:a.data)==null?void 0:Y.data[0])==null?void 0:J.Address})}),((Q=(K=a==null?void 0:a.data)==null?void 0:K.data[0])==null?void 0:Q.applyDate)!=null&&((Z=(X=a==null?void 0:a.data)==null?void 0:X.data[0])==null?void 0:Z.applyDate)!=""&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Apply date:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(ae=(ee=a==null?void 0:a.data)==null?void 0:ee.data[0])==null?void 0:ae.applyDate})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs font-semibold",children:"Apply By:"})}),e.jsx("div",{className:"flex flex-col cursor-pointer mt-3 w-1/2",children:e.jsx("h1",{className:"text-xs",children:(te=(se=a==null?void 0:a.data)==null?void 0:se.data[0])==null?void 0:te.applyBy})})]})]})})}),e.jsx(re,{}),e.jsx("div",{className:"flex flex-wrap",children:Me.map((s,ye)=>s.accessMenu.includes("".concat(l==null?void 0:l.userTypeId))&&e.jsxs("div",{className:"flex items-center flex-col cursor-pointer mt-4 w-1/3",children:[e.jsx(p,{onClick:()=>{var ie,de;s.title==="View & Pay"&&i("".concat(s.link,"/").concat(t)),s.title=="Update Consumer"&&i("".concat(s.link,"/").concat(t)),s.title=="All Flats List"&&i("".concat(s.link,"/").concat(t)),s.title=="Transaction History"&&i("".concat(s.link,"?id=").concat(t,"&tranType=consumerId")),s.title=="Update Apartment"&&i("".concat(s.link,"/").concat(t)),s.title=="Payment Adjustment"&&i("".concat(s.link,"/").concat(t)),s.title=="Deactivate Apartment"&&i("".concat(s.link,"/").concat(t)),s.title=="Geo Tagging"&&i("".concat(s.link,"/").concat(t)),s.title=="Geo Map"&&i("".concat(s.link,"/").concat(t)),s.title=="Reminder"&&n(!0),s.title=="Deny"&&r(!0),s.title=="Adjust Demand"&&i("".concat(s.link,"/").concat(t)),s.title=="Add Renter"&&i("".concat(s.link,"/").concat(t)),s.title=="Deactivate Consumer"&&i("".concat(s.link,"/").concat(t)),s.title=="Print Demand"&&(((de=(ie=a==null?void 0:a.data)==null?void 0:ie.data[0])==null?void 0:de.totalDemand)>"0"?i("".concat(s.link,"/").concat(t)):f.error("Outstanding demand is 0, so you can not print demand."))},className:"w-[52px] h-[52px] flex items-center justify-center bg-[#12743B] rounded-2xl",children:e.jsx(le,{src:s.icon,alt:"icon"})}),e.jsx("p",{className:"text-xs font-bold text-gray-800 mt-2 text-center",children:s.title})]},ye+1))})]})]})}export{Ue as default};
