import{j as e,_ as I,m as F,r as t,B as Q}from"./index-CN_yBJeq.js";import{a as Oe}from"./index-0qDIXVAa.js";import{C as ce,d as ie,b as we,a as Ue,c as We}from"./card-TqYYswqf.js";import{a as oe,T as ue,b as xe,c as K,d as _,e as he,f as k,S as B}from"./Spinner-CxNBWiLx.js";import{u as Y,b as H,a as Re}from"./useCustomQuery-evZbl-nJ.js";import{g as J}from"./services-KQnp_8oA.js";import{u as Qe,C as He,a as ee,o as ae,F as me,c as X,b as T,R as Ke,B as _e,S as Ye}from"./SelectField-B8hVbjqK.js";import{I as Je}from"./input-DQjPs7rI.js";import{L as Xe}from"./label-Bxenu6LX.js";import{D as Se,c as pe,F as je,b as Ce,X as Me,a as ke,P as Te}from"./dialog-D2M_B8AV.js";import{D as ge}from"./index-DFOvG1-m.js";import{T as De,a as $e,f as Ie,g as Pe,b as Ae,c as Ee,d as ze,e as Ge}from"./tabs-KPjgUyc9.js";import{P as Ve}from"./index-B7CexgYh.js";import{R as Z}from"./RHFTextField-qw0lwjzl.js";import{I as qe}from"./Image-BBASn0RA.js";import{q as Le}from"./switch-C2X50QtX.js";import"./createLucideIcon-GsbXppMf.js";function Fe({name:a,label:v,isDynamic:O,isRequired:u,...f}){const{control:$,setValue:N}=Qe();return e.jsx(He,{name:a,control:$,render:({field:{ref:L},fieldState:{error:C}})=>e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-200",htmlFor:v,children:[v," ",u&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(Je,{type:"file",onChange:R=>{N(a,R.target.files?R.target.files[0]:null)},ref:L,className:`mt-1 ${C?"border-red-400":null}`,...f}),C&&e.jsx("span",{className:"text-red-400 text-xs",children:C.message})]})})}const Ze=X().shape({service_name:T().required("menu name is required")});function Be({open:a,setOpen:v,title:O,edit:u,setEdit:f,serviceList:$,moduleList:N,id:L,menuRoleList:C,moduleId:R,menuRoleId:S,moduleName:V,roleList:y,userPermittedRoles:P,userId:M,permittedModule:A,ulbId:g,permittedModuleListByUlb:D}){var l;const m=Y({}),b=Y({}),d=ee({defaultValues:{service_name:""},resolver:ae(Ze)}),i=async n=>{var r,s,o;try{const q=u?"EditModuleList":"AddmoduleList",j=u&&L?{...n,moduleId:L}:{...n,moduleId:R},w=await m.mutateAsync({api:q,data:j});(r=w==null?void 0:w.data)!=null&&r.success?(I.success((s=w==null?void 0:w.data)==null?void 0:s.message),v(!1),f(!1),$.refetch()):I.error((o=w==null?void 0:w.data)==null?void 0:o.message)}catch(q){I.error(J(q))}},x=async(n,r)=>{var s,o,q,j;console.log(r);try{const w={ulbId:g,moduleList:[{permissionStatus:r,moduleId:n}]},U=await b.mutateAsync({api:(s=F)==null?void 0:s.addRemoveModuleToUlb,data:w});(o=U==null?void 0:U.data)!=null&&o.status?(I.success(((q=U==null?void 0:U.data)==null?void 0:q.message)||"Permission updated successfully"),D.refetch()):I.error(((j=U==null?void 0:U.data)==null?void 0:j.message)||"Failed to update permission")}catch(w){I.error(J(w))}};return H({api:(l=F)==null?void 0:l.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),console.log(A),e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:f,edit:u,children:e.jsx(me,{methods:d,onSubmit:d.handleSubmit(i),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Module Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(A==null?void 0:A.map((n,r)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:r+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${n.permission_status?"text-green-600":"text-black"}`,children:n.module_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:n.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>x(n.id,!n.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>x(n.id,!n.permission_status),children:"Add"})})]},n.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}const ea=X().shape({service_name:T().required("menu name is required")});function aa({open:a,setOpen:v,title:O,edit:u,setEdit:f,serviceList:$,moduleList:N,id:L,menuRoleList:C,moduleId:R,menuRoleId:S,moduleName:V,roleList:y,userPermittedRoles:P,userId:M,permittedModule:A,ulbId:g,permittedModuleListByUlb:D,getServicesByUlbModule:m,permittedServices:b}){var r;const d=Y({}),i=Y({}),x=ee({defaultValues:{service_name:""},resolver:ae(ea)}),l=async s=>{var o,q,j;try{const w=u?"EditModuleList":"AddmoduleList",U=u&&L?{...s,moduleId:L}:{...s,moduleId:R},W=await d.mutateAsync({api:w,data:U});(o=W==null?void 0:W.data)!=null&&o.success?(I.success((q=W==null?void 0:W.data)==null?void 0:q.message),v(!1),f(!1),$.refetch()):I.error((j=W==null?void 0:W.data)==null?void 0:j.message)}catch(w){I.error(J(w))}},n=async(s,o)=>{var q,j,w,U;console.log(o);try{const W={ulbId:g,serviceList:[{permissionStatus:o,serviceId:s}]},p=await i.mutateAsync({api:(q=F)==null?void 0:q.addRemoveServiceByUlbModule,data:W});(j=p==null?void 0:p.data)!=null&&j.status?(I.success(((w=p==null?void 0:p.data)==null?void 0:w.message)||"Permission updated successfully"),m.refetch()):I.error(((U=p==null?void 0:p.data)==null?void 0:U.message)||"Failed to update permission")}catch(W){I.error(J(W))}};return H({api:(r=F)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),console.log(A),e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:f,edit:u,children:e.jsx(me,{methods:x,onSubmit:x.handleSubmit(l),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Service Route"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(b==null?void 0:b.map((s,o)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:o+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.services}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${s.permission_status?"text-green-600":"text-black"}`,children:s.path}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>n(s.id,!s.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>n(s.id,!s.permission_status),children:"Add"})})]},s.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}const sa=X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function la(a){var d,i,x,l,n,r,s,o,q;const[v,O]=t.useState(1),[u,f]=t.useState(10),[$,N]=t.useState(!1),[L,C]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(!1),t.useState(null);const[V,y]=t.useState(!1),[P,M]=t.useState("");t.useState("");const[A,g]=t.useState("");t.useState(1),t.useState(10),console.log(a==null?void 0:a.ulbId);const D=ee({resolver:ae(sa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),m=Re({api:`${(d=F)==null?void 0:d.serviceList}?module=${(i=D==null?void 0:D.watch())==null?void 0:i.moduleId}`,key:"serviceMasterList",options:{enabled:!0}});H({api:(x=F)==null?void 0:x.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:u,searchQuery:A,[P]:A},value:[v,u,P,A],options:{enabled:!!(a!=null&&a.ulbId)}});const b=H({api:(l=F)==null?void 0:l.getServicesByUlbModule,key:"getServicesByUlbModule",config:{ulbId:a==null?void 0:a.ulbId,moduleId:a==null?void 0:a.moduleId},options:{enabled:!!(a!=null&&a.ulbId)}});return console.log(a==null?void 0:a.moduleId),console.log((n=b==null?void 0:b.data)==null?void 0:n.data),e.jsxs(e.Fragment,{children:[e.jsx(Se,{open:V,children:e.jsx(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll"})}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),S(!1),N(!0)},children:"Restrict More Services"})})}),e.jsx(aa,{open:$,setOpen:N,title:R?"Edit Restrict Service":"Add Restrict Service",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,ulbId:a==null?void 0:a.ulbId,getServicesByUlbModule:b,permittedServices:(r=b==null?void 0:b.data)==null?void 0:r.data}),e.jsx(ce,{children:e.jsx(ie,{children:m.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Service Name"}),e.jsx(_,{className:"",children:"Service Route"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(q=(o=(s=b==null?void 0:b.data)==null?void 0:s.data)==null?void 0:o.filter(j=>(j==null?void 0:j.permission_status)==!0))==null?void 0:q.map((j,w)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+w+1}),e.jsx(k,{children:j==null?void 0:j.services}),e.jsx(k,{children:j==null?void 0:j.path}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{C(j==null?void 0:j.id),S(!0),N(!0)},children:[e.jsx(je,{})," Edit"]})})]},j==null?void 0:j.id))})]}),e.jsx(B,{className:"mb-2 mt-4"})]})})})]})})]})}X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ta(a){var r,s,o,q,j,w,U,W;const[v,O]=t.useState(1),[u,f]=t.useState(10),[$,N]=t.useState(!1),[L,C]=t.useState(""),[R,S]=t.useState(!1),[V,y]=t.useState(!1),[P,M]=t.useState(null),[A,g]=t.useState(1),[D,m]=t.useState(10),b=100,d=p=>{g(p)},i=p=>{m(p),g(1)};console.log(a==null?void 0:a.ulbId);const x=H({api:(r=F)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),l=H({api:(s=F)==null?void 0:s.getModuleByUlbId,key:"permittedModuleListByUlb",config:{ulbId:a==null?void 0:a.ulbId},options:{enabled:!!(a!=null&&a.ulbId)}});console.log((o=l==null?void 0:l.data)==null?void 0:o.data);const n=p=>{M(p),y(!0)};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:V,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:(q=a==null?void 0:a.selectedULB)==null?void 0:q.ulb_name})]}),e.jsxs("div",{children:["Module Name : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:P==null?void 0:P.module_name})]})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>y(!1)})})})]}),e.jsxs(De,{defaultValue:"MENULIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsx($e,{className:"grid w-auto grid-cols-2",children:e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Restricted Services"})})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(la,{ulbId:a==null?void 0:a.ulbId,moduleId:L,viewService:P})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),S(!1),N(!0)},children:"Add More Module"})})}),e.jsx(Be,{open:$,setOpen:N,title:R?"Edit Module":"Add Module",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedModule:(j=l==null?void 0:l.data)==null?void 0:j.data,permittedModuleListByUlb:l,ulbId:a==null?void 0:a.ulbId}),e.jsx(ce,{className:"",children:e.jsx(ie,{children:x.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Module"}),e.jsx(_,{className:"",children:"Path"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(W=(U=(w=l==null?void 0:l.data)==null?void 0:w.data)==null?void 0:U.filter(p=>(p==null?void 0:p.permission_status)==!0))==null?void 0:W.map((p,G)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+G+1}),e.jsx(k,{children:p==null?void 0:p.module_name}),e.jsx(k,{children:p==null?void 0:p.url}),e.jsxs(k,{children:[e.jsxs(Q,{variant:"secondary",onClick:()=>{C(p==null?void 0:p.id),S(!0),N(!0)},children:[e.jsx(je,{})," Edit"]}),e.jsxs(Q,{onClick:()=>{n(p),C(p==null?void 0:p.id)},className:"ml-2",variant:"secondary",children:[e.jsx(ke,{})," View"]})]})]},p==null?void 0:p.id))})]}),e.jsx(B,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Te,{currentPage:A,totalItems:b,itemsPerPage:D,onPageChange:d,onItemsPerPageChange:i})})]})})})]})})}const da=X().shape({service_name:T().required("menu name is required")});function na({open:a,setOpen:v,title:O,edit:u,setEdit:f,serviceList:$,moduleList:N,id:L,menuRoleList:C,moduleId:R,menuRoleId:S,moduleName:V,roleList:y,userPermittedRoles:P,userId:M}){const A=Y({}),g=Y({}),D=ee({defaultValues:{service_name:""},resolver:ae(da)}),m=async d=>{var i,x,l;try{const n=u?"EditModuleList":"AddmoduleList",r=u&&L?{...d,moduleId:L}:{...d,moduleId:R},s=await A.mutateAsync({api:n,data:r});(i=s==null?void 0:s.data)!=null&&i.success?(I.success((x=s==null?void 0:s.data)==null?void 0:x.message),v(!1),f(!1),$.refetch()):I.error((l=s==null?void 0:s.data)==null?void 0:l.message)}catch(n){I.error(J(n))}},b=async(d,i)=>{var x,l,n,r;console.log(i);try{const s={userId:M,permissionStatus:i,menuRoleId:d},o=await g.mutateAsync({api:(x=F)==null?void 0:x.addMenuRoleUser,data:s});(l=o==null?void 0:o.data)!=null&&l.status?(I.success(((n=o==null?void 0:o.data)==null?void 0:n.message)||"Permission updated successfully"),P.refetch()):I.error(((r=o==null?void 0:o.data)==null?void 0:r.message)||"Failed to update permission")}catch(s){I.error(J(s))}};return e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:f,edit:u,children:e.jsx(me,{methods:D,onSubmit:D.handleSubmit(m),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(y==null?void 0:y.map((d,i)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:i+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${d.permission_status?"text-green-600":"text-black"}`,children:d.menu_role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>b(d.id,!d.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>b(d.id,!d.permission_status),children:"Add"})})]},d.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ra(a){var b,d,i,x,l,n;const[v,O]=t.useState(1),[u,f]=t.useState(10),[$,N]=t.useState(!1),[L,C]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(null);const[V,y]=t.useState(1),[P,M]=t.useState(10),A=100,g=r=>{y(r)},D=r=>{M(r),y(1)};console.log(a==null?void 0:a.ulbId);const m=H({api:(b=F)==null?void 0:b.userPermittedRoles,key:"userPermittedRoles",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((d=m==null?void 0:m.data)==null?void 0:d.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),S(!1),N(!0)},children:"Add More Role Permission"})})}),e.jsx(na,{open:$,setOpen:N,title:R?"Edit Menu":"Add Menu",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,roleList:(i=m==null?void 0:m.data)==null?void 0:i.data,userPermittedRoles:m}),e.jsx(ce,{className:"",children:e.jsx(ie,{children:m.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Role Menu"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(n=(l=(x=m==null?void 0:m.data)==null?void 0:x.data)==null?void 0:l.filter(r=>(r==null?void 0:r.permission_status)==!0))==null?void 0:n.map((r,s)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+s+1}),e.jsx(k,{children:r==null?void 0:r.menu_role_name}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{C(r==null?void 0:r.id),S(!0),N(!0)},children:[e.jsx(je,{})," Edit"]})})]},r==null?void 0:r.id))})]}),e.jsx(B,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Te,{currentPage:V,totalItems:A,itemsPerPage:P,onPageChange:g,onItemsPerPageChange:D})})]})})})]})})}const ca=X().shape({service_name:T().required("menu name is required")});function ia({open:a,setOpen:v,title:O,edit:u,setEdit:f,serviceList:$,moduleList:N,id:L,menuRoleList:C,moduleId:R,menuRoleId:S,moduleName:V,wardList:y,permittedWardByUsers:P,userId:M}){const A=Y({}),g=Y({}),D=ee({defaultValues:{service_name:""},resolver:ae(ca)}),m=async d=>{var i,x,l;try{const n=u?"EditModuleList":"AddmoduleList",r=u&&L?{...d,moduleId:L}:{...d,moduleId:R},s=await A.mutateAsync({api:n,data:r});(i=s==null?void 0:s.data)!=null&&i.success?(I.success((x=s==null?void 0:s.data)==null?void 0:x.message),v(!1),f(!1),$.refetch()):I.error((l=s==null?void 0:s.data)==null?void 0:l.message)}catch(n){I.error(J(n))}},b=async(d,i)=>{var x,l,n,r;console.log(i);try{const s={userId:M,wardList:[{permissionStatus:i,wardId:d}]},o=await g.mutateAsync({api:(x=F)==null?void 0:x.addRemoveWard,data:s});(l=o==null?void 0:o.data)!=null&&l.status?(I.success(((n=o==null?void 0:o.data)==null?void 0:n.message)||"Permission updated successfully"),P.refetch()):I.error(((r=o==null?void 0:o.data)==null?void 0:r.message)||"Failed to update permission")}catch(s){I.error(J(s))}};return e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:f,edit:u,children:e.jsx(me,{methods:D,onSubmit:D.handleSubmit(m),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(y==null?void 0:y.map((d,i)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:i+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${d.permission_status?"text-green-600":"text-black"}`,children:d.ward_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:d.permission_status?e.jsx("button",{className:"text-red-600  bg-red-200 hover:bg-red-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>b(d.id,!d.permission_status),children:"Remove"}):e.jsx("button",{className:"text-green-600 bg-green-200 hover:bg-green-100 px-2 py-1 rounded-md text-xs font-bold",onClick:()=>b(d.id,!d.permission_status),children:"Add"})})]},d.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function oa(a){var P,M,A,g,D,m,b;const[v,O]=t.useState(1),[u,f]=t.useState(10),[$,N]=t.useState(!1),[L,C]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(null),t.useState(1),t.useState(10),console.log(a==null?void 0:a.ulbId);const V=H({api:(P=F)==null?void 0:P.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),y=H({api:(M=F)==null?void 0:M.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((A=y==null?void 0:y.data)==null?void 0:A.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),S(!1),N(!0)},children:"Add More Ward Permission"})})}),e.jsx(ia,{open:$,setOpen:N,title:R?"Edit Menu":"Add Menu",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedWardByUsers:y,wardList:(g=y==null?void 0:y.data)==null?void 0:g.data}),e.jsx(ce,{className:"",children:e.jsx(ie,{children:V.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Wards"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(b=(m=(D=y==null?void 0:y.data)==null?void 0:D.data)==null?void 0:m.filter(d=>(d==null?void 0:d.permission_status)==!0))==null?void 0:b.map((d,i)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+i+1}),e.jsx(k,{children:d==null?void 0:d.ward_name}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{C(d==null?void 0:d.id),S(!0),N(!0)},children:[e.jsx(je,{})," Edit"]})})]},d==null?void 0:d.id))})]}),e.jsx(B,{className:"mb-2 mt-4"})]})})})]})})}const ua=X().shape({service_name:T().required("menu name is required")});function xa({open:a,setOpen:v,title:O,subtitle:u,edit:f,setEdit:$,serviceList:N,moduleList:L,id:C,menuRoleList:R,moduleId:S,menuRoleId:V,moduleName:y,wardList:P,permittedworkFlowRoleByUser:M,userId:A,workFlowList:g}){const D=Y({}),m=Y({}),b=ee({defaultValues:{service_name:""},resolver:ae(ua)}),d=async l=>{var n,r,s;try{const o=f?"EditModuleList":"AddmoduleList",q=f&&C?{...l,moduleId:C}:{...l,moduleId:S},j=await D.mutateAsync({api:o,data:q});(n=j==null?void 0:j.data)!=null&&n.success?(I.success((r=j==null?void 0:j.data)==null?void 0:r.message),v(!1),$(!1),N.refetch()):I.error((s=j==null?void 0:j.data)==null?void 0:s.message)}catch(o){I.error(J(o))}},i=async(l,n)=>{var r,s,o,q;console.log(n);try{const j={userId:A,permissionStatus:n,wfRoleId:l},w=await m.mutateAsync({api:(r=F)==null?void 0:r.AddRemoveWorkFlowRoleByUser,data:j});(s=w==null?void 0:w.data)!=null&&s.status?(I.success(((o=w==null?void 0:w.data)==null?void 0:o.message)||"Permission updated successfully"),M.refetch()):I.error(((q=w==null?void 0:w.data)==null?void 0:q.message)||"Failed to update permission")}catch(j){I.error(J(j))}},x=g==null?void 0:g.some(l=>l.permission_status);return e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:$,subtitle:u,edit:f,children:e.jsx(me,{methods:b,onSubmit:b.handleSubmit(d),children:e.jsx("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-sm",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Sl."}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Role Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Permission"})]})}),e.jsx("tbody",{children:(g==null?void 0:g.map((l,n)=>e.jsxs("tr",{className:"hover:bg-gray-100 text-sm",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:n+1}),e.jsx("td",{className:`border border-gray-300 px-4 py-2 ${l.permission_status?"text-green-600":"text-black"}`,children:l.role_name}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx("button",{className:`px-2 py-1 rounded-md text-xs font-bold ${l.permission_status?"text-red-600 bg-red-200 hover:bg-red-100":x?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-green-600 bg-green-200 hover:bg-green-100"}`,onClick:()=>!x||l.permission_status?i(l.id,!l.permission_status):null,disabled:!l.permission_status&&x,children:l.permission_status?"Remove":"Add"})})]},l.id)))||e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No data available"})})})]})})})})})}X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ha(a){var M,A,g,D,m,b,d,i,x;const[v,O]=t.useState(1),[u,f]=t.useState(10),[$,N]=t.useState(!1),[L,C]=t.useState(""),[R,S]=t.useState(!1);t.useState(!1),t.useState(null),t.useState(1),t.useState(10);const V=H({api:(M=F)==null?void 0:M.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),y=H({api:(A=F)==null?void 0:A.permittedWardByUser,key:"permittedWardByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}}),P=H({api:(g=F)==null?void 0:g.workFlowRoleByUser,key:"permittedworkFlowRoleByUser",config:{userId:a==null?void 0:a.id},options:{enabled:!0}});return console.log((D=y==null?void 0:y.data)==null?void 0:D.data),console.log((m=P==null?void 0:P.data)==null?void 0:m.data),e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{C(""),S(!1),N(!0)},children:"Change Role Permission"})})}),e.jsx(xa,{open:$,setOpen:N,title:R?"Edit Role":"Change Role",subtitle:"You can provide only one workflow role at a time.",id:L,edit:R,setEdit:S,moduleId:a==null?void 0:a.moduleId,userId:a==null?void 0:a.id,moduleName:a==null?void 0:a.moduleName,permittedworkFlowRoleByUser:P,workFlowList:(b=P==null?void 0:P.data)==null?void 0:b.data}),e.jsx(ce,{className:"",children:e.jsx(ie,{children:V.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"Workflow Role Name"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(x=(i=(d=P==null?void 0:P.data)==null?void 0:d.data)==null?void 0:i.filter(l=>(l==null?void 0:l.permission_status)==!0))==null?void 0:x.map((l,n)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+n+1}),e.jsx(k,{children:l==null?void 0:l.role_name}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{C(l==null?void 0:l.id),S(!0),N(!0)},children:[e.jsx(je,{})," Edit"]})})]},l==null?void 0:l.id))})]}),e.jsx(B,{className:"mb-2 mt-4"})]})})})]})})}const ma=X().shape({userType:T().required("User Type is required"),name:T().required("Full Name is required"),mobile:T().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:T().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:T().email("Enter a valid email").required("Email is required"),address:T().required("Address is required"),photo:T().required("User Image is required")});function ja({open:a,setOpen:v,title:O,edit:u,setEdit:f,adminListFun:$,id:N,ulbId:L,userListByUlbId:C}){var A,g,D;const R=Y({}),S=t.useRef(null),V=ee({defaultValues:{userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:ae(ma)}),{reset:y}=V;t.useEffect(()=>{var m,b,d;if(a){if(u&&N){const i=(d=(b=(m=C==null?void 0:C.data)==null?void 0:m.data)==null?void 0:b.data)==null?void 0:d.find(x=>x.id==N);console.log(i,"selectedAdmin"),i&&y({userType:i.user_type||"",name:i.name||"",mobile:i.mobile||"",altMobile:i.alternate_mobile||"",email:i.email||"",address:i.address||"",photo:null})}else y({userType:"",name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});V.setValue("photo",""),S.current&&(S.current.value="")}},[a,u,N,$,y]);const P=async m=>{var b,d,i,x,l;try{const n=u?(b=F)==null?void 0:b.updateAdmin:(d=F)==null?void 0:d.createAdmin,r=u&&N?{...m,id:N}:{...m,ulbId:L},s=new FormData;s.append("name",r.name),s.append("mobile",r.mobile),s.append("altMobile",r.altMobile),s.append("email",r.email),s.append("address",r.address),s.append("userType",r.userType),s.append("photo",V.watch("photo")),u&&N&&s.append("id",N),s.append("ulbId",r.ulbId||"");const o=await R.mutateAsync({api:n,data:s});(i=o==null?void 0:o.data)!=null&&i.status?(I.success((x=o==null?void 0:o.data)==null?void 0:x.message),v(!1),f(!1),C.refetch()):I.error((l=o==null?void 0:o.data)==null?void 0:l.message)}catch(n){I.error(J(n))}},M=H({api:(A=F)==null?void 0:A.createUserType,key:"createUserTypeList",options:{enabled:!0}});return console.log((g=M==null?void 0:M.data)==null?void 0:g.data,"createUserTypeList"),e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:f,edit:u,children:e.jsx(me,{methods:V,onSubmit:V.handleSubmit(P),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(Ke,{label:"User Type",name:"userType",data:((D=M==null?void 0:M.data)==null?void 0:D.data.map(m=>({value:String(m),label:String(m)})))||[]})}),e.jsx("div",{children:e.jsx(Z,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter full name"})}),e.jsx("div",{children:e.jsx(Z,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter mobile no "})}),e.jsx("div",{children:e.jsx(Z,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter module url "})}),e.jsx("div",{children:e.jsx(Z,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(Z,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Fe,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(B,{}),e.jsx("div",{children:e.jsx(_e,{isLoading:V.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}const ga=X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function ba(a){var q,j,w,U,W,p,G,E,se,te,de,ne,re,h;const[v,O]=t.useState(1),[u,f]=t.useState(10),$=Y({}),[N,L]=t.useState(!1),[C,R]=t.useState(""),[S,V]=t.useState(!1),[y,P]=t.useState(!1),[M,A]=t.useState(!1),[g,D]=t.useState(""),[m,b]=t.useState(""),[d,i]=t.useState(""),x=c=>{D(c)},l=c=>{b(c.target.value)};t.useEffect(()=>{const c=setTimeout(()=>{i(m)},700);return()=>clearTimeout(c)},[m]),console.log(a==null?void 0:a.ulbId);const n=ee({resolver:ae(ga),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),r=Re({api:`${(q=F)==null?void 0:q.serviceList}?module=${(j=n==null?void 0:n.watch())==null?void 0:j.moduleId}`,key:"serviceMasterList",options:{enabled:!0}}),s=H({api:(w=F)==null?void 0:w.userListByULBId,key:"userListByUlbId",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:u,searchQuery:d,[g]:d},value:[v,u,g],options:{enabled:!0}});t.useEffect(()=>{d&&(O(1),f(10)),s.refetch()},[d]);const o=async(c,be)=>{var Ne,ye,ve,fe;try{const z={id:c,isSuspended:be},le=await $.mutateAsync({api:(Ne=F)==null?void 0:Ne.enableDisableUserByModule,data:z});(ye=le==null?void 0:le.data)!=null&&ye.status?(I.success(((ve=le==null?void 0:le.data)==null?void 0:ve.message)||"Permission updated successfully"),s.refetch()):I.error(((fe=le==null?void 0:le.data)==null?void 0:fe.message)||"Failed to update permission")}catch(z){I.error(J(z))}};return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{open:M,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500  font-bold flex justify-between",children:[e.jsxs("div",{children:["User : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:y==null?void 0:y.name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>A(!1)})})})]}),e.jsxs(De,{defaultValue:"ROLELIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsxs($e,{className:"grid w-auto grid-cols-3 bg-gray-100 rounded-md py-1",children:[e.jsx(Ae,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"ROLELIST",children:"Permitted Roles"}),e.jsx(Ae,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"PERMITTED_WARDS",children:"Permitted Wards"}),e.jsx(Ae,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white rounded-md text-gray-400 px-2",value:"PERMITTED_WORKFLOW_ROLE",children:"Permitted Workflow Role"})]})}),e.jsx(Ee,{value:"ROLELIST",children:e.jsx(ra,{selectedULB:y,id:C})}),e.jsx(Ee,{value:"PERMITTED_WARDS",children:e.jsx(oa,{selectedULB:y,id:C})}),e.jsx(Ee,{value:"PERMITTED_WORKFLOW_ROLE",children:e.jsx(ha,{selectedULB:y,id:C})})]})]})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{R(""),V(!1),L(!0)},children:"Create User"})})}),e.jsx(ja,{open:N,setOpen:L,title:S?"Edit user":"Create User",id:C,edit:S,setEdit:V,ulbId:a==null?void 0:a.ulbId,userListByUlbId:s}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:g,onChange:c=>x(c.target.value),className:"cursor-pointer w-[200px] bg-background border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:m,onChange:l,placeholder:`Search by ${g}`,className:"border p-2 rounded-md",maxLength:g=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Users : ",(W=(U=s==null?void 0:s.data)==null?void 0:U.data)==null?void 0:W.total]}),e.jsx(ce,{children:e.jsx(ie,{children:r.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"User Image"}),e.jsx(_,{className:"",children:"Name"}),e.jsx(_,{className:"",children:"Mobile No"}),e.jsx(_,{className:"",children:"Email"}),e.jsx(_,{className:"",children:"User Type"}),e.jsx(_,{className:"",children:"Address"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(E=(G=(p=s==null?void 0:s.data)==null?void 0:p.data)==null?void 0:G.data)==null?void 0:E.map((c,be)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+be+1}),e.jsx(k,{children:e.jsx(qe,{src:c.documentUrl,alt:c.name,className:"w-10 h-10 border-2 rounded-full object-cover"})}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.name}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.mobile}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.email}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.user_type}),e.jsx(k,{className:c.suspended?"text-red-600":"text-black",children:c==null?void 0:c.address}),e.jsx(k,{children:e.jsxs(Le,{checked:c==null?void 0:c.suspended,onChange:()=>o(c.id,!c.suspended),className:`${c!=null&&c.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${c!=null&&c.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(k,{children:e.jsxs("td",{className:"",children:[e.jsxs(Q,{variant:"secondary",onClick:()=>{R(c==null?void 0:c.id),V(!0),L(!0)},children:[e.jsx(je,{})," Edit"]}),e.jsxs(Q,{onClick:()=>{P(c),A(!0),R(c==null?void 0:c.id)},className:"ml-2",variant:"secondary",children:[e.jsx(ke,{})," View"]})]})})]},c==null?void 0:c.id))})]}),e.jsx(B,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Ve,{page:v,perPage:u,totalPage:(te=(se=s==null?void 0:s.data)==null?void 0:se.data)==null?void 0:te.total,setPage:O,setPerPage:f,hasNextPage:((ne=(de=s==null?void 0:s.data)==null?void 0:de.data)==null?void 0:ne.current_page)>=v,hasPrevPage:(h=(re=s==null?void 0:s.data)==null?void 0:re.data)==null?void 0:h.current_page})})]})})})]})})]})}const fa=X().shape({name:T().required("Full Name is required"),mobile:T().matches(/^\d{10}$/,"Mobile number must be 10 digits").required("Mobile number is required"),altMobile:T().matches(/^\d{10}$/,"Alternate mobile number must be 10 digits").nullable(),email:T().email("Enter a valid email").required("Email is required"),address:T().required("Address is required"),photo:T().required("User Image is required")});function Na({open:a,setOpen:v,title:O,edit:u,setEdit:f,adminListFun:$,id:N,ulbId:L}){const C=Y({}),R=t.useRef(null),S=ee({defaultValues:{name:"",mobile:"",altMobile:"",email:"",address:"",photo:null},resolver:ae(fa)}),{reset:V}=S;t.useEffect(()=>{var P,M,A;if(a){if(u&&N){const g=(A=(M=(P=$==null?void 0:$.data)==null?void 0:P.data)==null?void 0:M.data)==null?void 0:A.find(D=>D.id==N);console.log(g,"selectedAdmin"),g&&V({name:g.name||"",mobile:g.mobile||"",altMobile:g.alternateMobile||"",email:g.email||"",address:g.address||"",photo:null})}else V({name:"",mobile:"",altMobile:"",email:"",address:"",photo:null});S.setValue("photo",""),R.current&&(R.current.value="")}},[a,u,N,$,V,S]);const y=async P=>{var M,A,g,D,m;try{const b=u?(M=F)==null?void 0:M.updateAdmin:(A=F)==null?void 0:A.createAdmin,d=u&&N?{...P,id:N}:{...P,userType:"Admin",role:"ADMIN",ulbId:L},i=new FormData;u&&N&&i.append("id",N),i.append("name",d.name),i.append("mobile",d.mobile),i.append("altMobile",d.altMobile),i.append("email",d.email),i.append("address",d.address),i.append("photo",S.watch("photo")),i.append("userType","Admin"),i.append("role","ADMIN"),i.append("ulbId",d.ulbId||"");const x=await C.mutateAsync({api:b,data:i});(g=x==null?void 0:x.data)!=null&&g.status?(I.success((D=x==null?void 0:x.data)==null?void 0:D.message),v(!1),f(!1),$.refetch()):I.error((m=x==null?void 0:x.data)==null?void 0:m.message)}catch(b){I.error(J(b))}};return e.jsx(ge,{open:a,setOpen:v,title:O,setEdit:f,edit:u,children:e.jsx(me,{methods:S,onSubmit:S.handleSubmit(y),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(Z,{label:"Full Name",name:"name",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter full name"})}),e.jsx("div",{children:e.jsx(Z,{label:"Mobile No",name:"mobile",inputValidation:["mobile","number"],placeholder:"Enter mobile no "})}),e.jsx("div",{children:e.jsx(Z,{label:"Alt Mobile No",name:"altMobile",inputValidation:["mobile","number"],placeholder:"Enter module url "})}),e.jsx("div",{children:e.jsx(Z,{label:"Email",name:"email",inputValidation:["email"],placeholder:"Enter Email "})}),e.jsx("div",{children:e.jsx(Z,{label:"Address",name:"address",inputValidation:["CapitalFirstLetter","removeDoubleSpace"],placeholder:"Enter Address "})}),e.jsx("div",{children:e.jsx(Fe,{label:"User Image",name:"photo"},a?"open":"closed")}),e.jsx(B,{}),e.jsx("div",{children:e.jsx(_e,{isLoading:S.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function ya(a){var r,s,o,q,j,w,U,W,p,G,E,se,te,de,ne,re;const[v,O]=t.useState(1),[u,f]=t.useState(10),$=Y({}),[N,L]=t.useState(!1),[C,R]=t.useState(""),[S,V]=t.useState(!1),[y,P]=t.useState(!1),[M,A]=t.useState(""),[g,D]=t.useState(""),[m,b]=t.useState(""),d=h=>{A(h)},i=h=>{D(h.target.value)};t.useEffect(()=>{const h=setTimeout(()=>{b(g)},700);return()=>clearTimeout(h)},[g]);const x=H({api:(r=F)==null?void 0:r.userManagementModuleList,key:"permittedModuleList",options:{enabled:!0}}),l=H({api:(s=F)==null?void 0:s.adminList,key:"adminListFun",config:{ulbId:a==null?void 0:a.ulbId,page:v,perPage:u,parameter:m||"",filterBy:M||""},value:[v,u,M],options:{enabled:!0}});t.useEffect(()=>{m&&(O(1),f(10)),l.refetch()},[m]);const n=async(h,c)=>{var be,Ne,ye,ve;try{const fe={id:h,isSuspended:c},z=await $.mutateAsync({api:(be=F)==null?void 0:be.enableDisableUserByModule,data:fe});(Ne=z==null?void 0:z.data)!=null&&Ne.status?(I.success(((ye=z==null?void 0:z.data)==null?void 0:ye.message)||"Permission updated successfully"),l.refetch()):I.error(((ve=z==null?void 0:z.data)==null?void 0:ve.message)||"Failed to update permission")}catch(fe){I.error(J(fe))}};return e.jsx("main",{className:"grid items-start ",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:y,children:[e.jsx(Ce,{}),e.jsx(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsx("div",{children:e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:(o=a==null?void 0:a.selectedULB)==null?void 0:o.ulb_name})]})}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>P(!1)})})})]})})]}),e.jsx("div",{children:e.jsx("div",{className:"flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{R(""),V(!1),L(!0)},children:"Create Admin"})})}),e.jsx(Na,{open:N,setOpen:L,title:S?"Edit Admin":"Create Admin",id:C,edit:S,setEdit:V,ulbId:a==null?void 0:a.ulbId,adminListFun:l,adminListData:(j=(q=l==null?void 0:l.data)==null?void 0:q.data)==null?void 0:j.data}),e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("select",{value:M,onChange:h=>d(h.target.value),className:"cursor-pointer w-[200px] bg-background border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"mobile",children:"Mobile"})]}),e.jsx("input",{type:"text",value:g,onChange:i,placeholder:`Search by ${M}`,className:"border p-2 rounded-md",maxLength:M=="mobile"?10:void 0})]}),e.jsxs("div",{className:"px-2 font-semibold text-gray-500",children:["Total Records : ",(U=(w=l==null?void 0:l.data)==null?void 0:w.data)==null?void 0:U.total]}),e.jsx(ce,{className:"",children:e.jsx(ie,{children:x.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"User Image"}),e.jsx(_,{className:"",children:"Name"}),e.jsx(_,{className:"",children:"Mobile No"}),e.jsx(_,{className:"",children:"Alt Mobile No"}),e.jsx(_,{className:"",children:"Email"}),e.jsx(_,{className:"",children:"Address"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Action"})]})}),e.jsx(he,{children:(G=(p=(W=l==null?void 0:l.data)==null?void 0:W.data)==null?void 0:p.data)==null?void 0:G.map((h,c)=>e.jsxs(K,{children:[e.jsx(k,{children:v*u-u+c+1}),e.jsx(k,{children:e.jsx(qe,{src:h.documentUrl,alt:h.name,className:"w-10 h-10 border-2 rounded-full object-cover"})}),e.jsx(k,{className:h.suspended?"text-red-600":"text-black",children:h==null?void 0:h.name}),e.jsx(k,{className:h.suspended?"text-red-600":"text-black",children:h==null?void 0:h.mobile}),e.jsx(k,{className:h.suspended?"text-red-600":"text-black",children:h==null?void 0:h.alternateMobile}),e.jsx(k,{className:h.suspended?"text-red-600":"text-black",children:h==null?void 0:h.email}),e.jsx(k,{className:h.suspended?"text-red-600":"text-black",children:h==null?void 0:h.address}),e.jsx(k,{children:e.jsxs(Le,{checked:h==null?void 0:h.suspended,onChange:()=>n(h.id,!h.suspended),className:`${h!=null&&h.suspended?"bg-red-600":"bg-green-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${h!=null&&h.suspended?"translate-x-1":"translate-x-6"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{R(h==null?void 0:h.id),V(!0),L(!0)},children:[e.jsx(je,{})," Edit"]})})]},h==null?void 0:h.id))})]}),e.jsx(B,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Ve,{page:v,perPage:u,totalPage:(se=(E=l==null?void 0:l.data)==null?void 0:E.data)==null?void 0:se.total,setPage:O,setPerPage:f,hasNextPage:((de=(te=l==null?void 0:l.data)==null?void 0:te.data)==null?void 0:de.current_page)>=v,hasPrevPage:(re=(ne=l==null?void 0:l.data)==null?void 0:ne.data)==null?void 0:re.current_page})})]})})})]})})}const va=X().shape({ulbId:T(),moduleId:T(),complaintRefNo:T()});function Sa(){var o,q,j,w,U,W,p,G;const[a,v]=t.useState(1),[O,u]=t.useState(10),[f,$]=t.useState(!1),N=Y({}),[L,C]=t.useState(!1),[R,S]=t.useState(""),[V,y]=t.useState(!1),[P,M]=t.useState(1),[A,g]=t.useState(10),[D,m]=t.useState(!1),b=100,d=E=>{M(E)},i=E=>{g(E),M(1)},x=ee({resolver:ae(va),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}}),l=async E=>{r==null||r.refetch()},n=H({api:(o=F)==null?void 0:o.getAllJuidcoUlbList,key:"ulbLists",options:{enabled:!0}});console.log((q=n==null?void 0:n.data)==null?void 0:q.data);const r=Re({api:`${(j=F)==null?void 0:j.serviceList}?module=${(w=x==null?void 0:x.watch())==null?void 0:w.moduleId}`,key:"serviceList",options:{enabled:!0}}),s=async(E,se)=>{var te,de,ne,re;try{const h={ulbId:E,permissionStatus:se},c=await N.mutateAsync({api:(te=F)==null?void 0:te.ulbEnableDisable,data:h});(de=c==null?void 0:c.data)!=null&&de.status?(I.success(((ne=c==null?void 0:c.data)==null?void 0:ne.message)||"Permission updated successfully"),n.refetch()):I.error(((re=c==null?void 0:c.data)==null?void 0:re.message)||"Failed to update permission")}catch(h){I.error(J(h))}};return e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs(Se,{open:D,children:[e.jsx(Ce,{}),e.jsxs(pe,{className:"sm:max-w-[1200px] h-[700px] max-h-[700px] overflow-scroll",children:[e.jsxs(we,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:[e.jsxs("div",{children:["ULB : ",e.jsx("span",{className:"font-bold text-lg text-yellow-500",children:f==null?void 0:f.ulb_name})]}),e.jsx("div",{children:e.jsx("span",{children:e.jsx(Me,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>m(!1)})})})]}),e.jsxs(ze,{defaultValue:"MENULIST",className:"w-full",children:[e.jsx("div",{className:"py-4 flex justify-between",children:e.jsxs(Ge,{className:"grid w-auto grid-cols-3",children:[e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"MENULIST",children:"Permitted Modules"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"SERVICE_LIST",children:"User List"}),e.jsx(Ie,{className:"data-[state=active]:bg-yellow-400 data-[state=active]:text-white",value:"ADMIN_LIST",children:"Admin List"})]})}),e.jsx(Pe,{value:"MENULIST",children:e.jsx(ta,{ulbId:f==null?void 0:f.id,selectedULB:f})}),e.jsx(Pe,{value:"SERVICE_LIST",children:e.jsx(ba,{ulbId:f==null?void 0:f.id,selectedULB:f})}),e.jsx(Pe,{value:"ADMIN_LIST",children:e.jsx(ya,{ulbId:f==null?void 0:f.id,selectedULB:f})})]})]})]}),e.jsxs(ce,{children:[e.jsx(me,{methods:x,onSubmit:x.handleSubmit(l),children:e.jsxs("div",{className:"grid grid-cols-4 gap-x-2 gap-y-4 bg-background px-10 pt-4",children:[e.jsxs("div",{children:[e.jsx(Xe,{htmlFor:"moduleId",children:"Module name"}),e.jsx(Ye,{className:"cursor-pointer bg-background",name:"moduleId",data:((W=(U=n==null?void 0:n.data)==null?void 0:U.data)==null?void 0:W.map(E=>({value:E==null?void 0:E.id,label:E==null?void 0:E.ulb_name})))??[]})]}),e.jsx("div",{className:"mt-6 flex justify-start",children:e.jsx(_e,{variant:"secondary",isLoading:x.formState.isSubmitting,type:"submit",className:"float-right w-auto px-10",children:"Search"})}),e.jsx("div",{className:"mt-6 flex justify-end "}),e.jsx("div",{className:"mt-6 flex justify-end ",children:e.jsx(Q,{type:"button",className:"flex items-center gap-2",onClick:()=>{S(""),y(!1),C(!0)},children:"Add New"})})]})}),e.jsx(Ue,{className:"px-7",children:e.jsx(We,{})}),e.jsx(ie,{children:r.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(K,{children:[e.jsx(_,{className:"",children:"#"}),e.jsx(_,{className:"",children:"ULB"}),e.jsx(_,{className:"",children:"Status"}),e.jsx(_,{className:"",children:"Actions"})]})}),e.jsx(he,{children:(G=(p=n==null?void 0:n.data)==null?void 0:p.data)==null?void 0:G.map((E,se)=>e.jsxs(K,{children:[e.jsx(k,{children:a*O-O+se+1}),e.jsx(k,{className:E.active_status?"text-black":"text-red-600",children:E==null?void 0:E.ulb_name}),e.jsx(k,{children:e.jsxs(Le,{checked:E==null?void 0:E.active_status,onChange:()=>s(E.id,!E.active_status),className:`${E!=null&&E.active_status?"bg-green-600":"bg-red-600"} relative inline-flex h-6 w-11 items-center rounded-full`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${E!=null&&E.active_status?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white`})]})}),e.jsx(k,{children:e.jsxs(Q,{variant:"secondary",onClick:()=>{S(E==null?void 0:E.id),$(E),m(!0)},className:"ml-2",children:[e.jsx(ke,{})," View"]})})]},E==null?void 0:E.id))})]}),e.jsx(B,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Te,{currentPage:P,totalItems:b,itemsPerPage:A,onPageChange:d,onItemsPerPageChange:i})})]})})]})]})})}function Fa(){return e.jsx(Oe,{title:"ULB List",subTitle:"Control all ULB here",children:e.jsx("div",{children:e.jsx(Sa,{})})})}export{Fa as default};
