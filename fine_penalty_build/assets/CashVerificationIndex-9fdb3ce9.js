import{a as ie,r as o,j as s,A as _,n as ne,P as oe}from"./index-5a588281.js";import"./index-f2df240c.js";import{S as P}from"./ShimmerEffectInline-58a923c6.js";import{A}from"./AxiosInterceptors-aea314b9.js";import"./FileSaver.min-b39665b6.js";import{c as le,a as ce,u as de}from"./formik.esm-4d73a438.js";import{R as he}from"./index.esm-9e4b28f6.js";import{R as xe}from"./Hourglass-78fa0571.js";import{g as H,n as j,d as k,i as pe,c as E}from"./PowerupFunctions-79d5c0b2.js";import{u as fe}from"./useSetTitle-1d9b5759.js";import{F as ue}from"./index.esm-68fb1568.js";import{B as me}from"./BottomErrorCard-2656355b.js";import{R as ge}from"./index.esm-241dd1f8.js";import{L as be}from"./ListTable-803e9f6c.js";import"./index-f5252c61.js";import"./index-51275a9e.js";import"./index.esm-ddcfd483.js";const Te=()=>{var z,V,B;fe("Cash Verification");const{api_cashVerificaionList:M,api_cashVerificaionById:L,api_verifyCash:$}=oe();ie();const m=o.useRef(),q=[{Header:"Sl.No.",Cell:({row:e})=>s.jsx("div",{children:(e==null?void 0:e.index)+1})},{Header:"Officer Name",accessor:"officer_name",Cell:({cell:e})=>{var t;return j((t=e.row.original)==null?void 0:t.officer_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:e})=>{var t;return j((t=e.row.original)==null?void 0:t.mobile)}},{Header:"Total Amount",accessor:"penalty_amount",Cell:({cell:e})=>{var t;return k((t=e.row.original)==null?void 0:t.penalty_amount)}},{Header:"Action",accessor:"id",Cell:({cell:e})=>s.jsx("div",{className:"flex items-center flex-wrap flex-row gap-1",children:s.jsx("button",{onClick:()=>{var t;return se((t=e==null?void 0:e.row)==null?void 0:t.original)},className:Y,children:"View"})})}];o.useState({}),o.useState(0);const[N,I]=o.useState(!1),[r,O]=o.useState(null),[G,W]=o.useState(""),[J,K]=o.useState(!1),[x,g]=o.useState([]),[d,Q]=o.useState([]),[w,C]=o.useState(!1),[b,y]=o.useState(!1),[i,U]=o.useState(null),X="text-gray-800 text-sm",F="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm focus:outline-none",Y="border border-sky-800 text-sky-800 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white focus:outline-none",v=[{title:"Date",key:"date",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""}],Z=(e,t="",a,n="",l="",c=!1,h=[],u="",re="")=>s.jsxs("div",{className:`flex flex-col ${n} `,children:[t!=""&&s.jsxs("label",{htmlFor:e,className:X,children:[t," ",c&&s.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),a!="select"&&a!="file"&&s.jsx("input",{...p.getFieldProps(e),type:a,className:F+` ${p.touched[e]&&p.errors[e]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:e,id:"",placeholder:l}),a=="select"&&s.jsxs("select",{...p.getFieldProps(e),className:F+` ${p.touched[e]&&p.errors[e]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:[s.jsx("option",{value:"",children:"All"}),h==null?void 0:h.map(T=>s.jsx("option",{className:"",value:T[u],children:T[re]}))]})]}),D=le().shape([...v].reduce((e,t)=>(t!=null&&t.required&&(e[t.key]=ce().required(t==null?void 0:t.hint)),e),{})),ee={date:H()},p=de({initialValues:ee,enableReinitialize:!0,validationSchema:D,onSubmit:e=>{S(e)}}),f=(e,t)=>{K(e),W(t)},S=e=>{I(!0);let t={date:e==null?void 0:e.date};A.post(M,t,_()).then(a=>{var n,l,c;(n=a==null?void 0:a.data)!=null&&n.status?Q((l=a==null?void 0:a.data)==null?void 0:l.data):f(!0,E((c=a==null?void 0:a.data)==null?void 0:c.message))}).catch(a=>{f(!0,"Server Error! Please try again later.")}).finally(()=>{I(!1)})};o.useEffect(()=>{S({date:H()})},[]);const se=e=>{U(e),y(!0),m.current.showModal();let t={date:e==null?void 0:e.date,userId:e==null?void 0:e.user_id};A.post(L,t,_()).then(a=>{var n,l,c;(n=a==null?void 0:a.data)!=null&&n.status?O((l=a==null?void 0:a.data)==null?void 0:l.data):(f(!0,E((c=a==null?void 0:a.data)==null?void 0:c.message)),m.current.close())}).catch(a=>{f(!0,"Server Error! Please try again later."),m.current.close()}).finally(()=>{y(!1)})},te=e=>x.some(t=>parseInt(t)==parseInt(e)),R=(e,t="")=>{var c;const a=e.target.name,n=e.target.value,l=e.target.checked;if(a=="cashAll")if(C(l),l){const h=(c=r==null?void 0:r.tranDtl)==null?void 0:c.map(u=>u==null?void 0:u.id);g(h)}else g([]);if(a=="cashSingle"){if(l)g(h=>[...h,n]);else if(!l&&w!=!0){let h=x==null?void 0:x.filter(u=>u!=n);g(h)}}},ae=()=>{if((x==null?void 0:x.length)==0)return;y(!0);let e={id:x,tcId:r==null?void 0:r.tcId,date:r==null?void 0:r.date};A.post($,e,_()).then(t=>{var a,n;(a=t==null?void 0:t.data)!=null&&a.status?(ne.success("Cash Verified Successfully !!!"),S({date:r==null?void 0:r.date})):f(!0,E((n=t==null?void 0:t.data)==null?void 0:n.message))}).catch(t=>{f(!0,"Server Error! Please try again later.")}).finally(()=>{y(!1),m.current.close(),C(!1),g([])})};return s.jsxs(s.Fragment,{children:[J&&s.jsx(me,{activateBottomErrorCard:f,errorTitle:G}),s.jsxs("form",{onSubmit:p.handleSubmit,onChange:p.handleChange,className:"bg-white poppins p-4 mb-8",children:[s.jsx("h1",{className:"text-xl font-semibold uppercase text-center text-gray-700 border-b border-gray-400 mb-4 pb-1",children:"Cash Verification"}),s.jsxs("section",{className:"flex gap-4 flex-wrap my-6",children:[v==null?void 0:v.map(e=>Z(e==null?void 0:e.key,e==null?void 0:e.title,e==null?void 0:e.type,e==null?void 0:e.width,e==null?void 0:e.hint,e==null?void 0:e.required,e==null?void 0:e.options,e==null?void 0:e.okey,e==null?void 0:e.ovalue)),s.jsx("div",{className:"mt-4 w-full md:w-[30%] flex flex-row flex-wrap items-center gap-x-4 gap-y-2 md:mt-4",children:s.jsx("div",{className:" ",children:N?s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex justify-center",children:s.jsx(xe,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):s.jsxs("button",{type:"submit",className:" flex items-center border border-green-600 bg-green-500 hover:bg-green-600 text-white shadow-md rounded-sm  text-sm px-5 py-1",children:[s.jsx("span",{className:"",children:s.jsx(he,{fontSize:""})}),s.jsx("span",{children:"Search Record"})]})})})]})]}),s.jsxs("dialog",{ref:m,className:"relative overflow-clip animate__animated animate__zoomIn animate__faster focus:outline-none backdrop:backdrop-brightness-75",children:[!N&&s.jsx("span",{onClick:()=>(m.current.close(),g([]),C(!1)),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:s.jsx(ge,{})}),s.jsx("div",{className:" z-50 px-6 py-4 flex flex-col gap-4 ",children:s.jsxs("div",{className:"flex flex-col items-between justify-center",children:[s.jsxs("div",{className:"w-full flex flex-col items-center mb-4 pb-2 border-b",children:[s.jsx("span",{className:"text-green-500 p-2 block rounded-full drop-shadow-md shadow-green-300",children:s.jsx(ue,{size:25})}),s.jsxs("span",{className:"font-semibold",children:[i==null?void 0:i.officer_name," Cash Collection Details"]})]}),s.jsxs("div",{className:"grid grid-cols-12 items-center gap-x-4 gap-y-2 text-sm",children:[s.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Officer Name: "}),s.jsx("div",{className:"col-span-6",children:j(i==null?void 0:i.officer_name)})]}),s.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Mobile No.: "}),s.jsx("div",{className:"col-span-6",children:j(i==null?void 0:i.mobile)})]}),s.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[s.jsx("div",{className:"col-span-6 font-semibold",children:"Total Amount: "}),s.jsx("div",{className:"col-span-6",children:k(i==null?void 0:i.penalty_amount)})]})]}),s.jsxs("div",{className:"w-full mt-4 mb-2",children:[s.jsxs("div",{className:"font-semibold ",children:[s.jsxs("span",{children:["Collection List (Date : ",i==null?void 0:i.date,")"]}),!b&&Array.isArray(r==null?void 0:r.tranDtl)&&((z=r==null?void 0:r.tranDtl)==null?void 0:z.length)>0&&s.jsx("button",{onClick:()=>ae(),className:"font-normal text-sm float-right bg-green-500 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-green-600 hover:text-white text-white flex items-center mb-1",children:"Verify"})]}),s.jsxs("div",{className:"flex flex-col h-[60vh] w-full overflow-y-auto md:overflow-x-hidden",children:[s.jsxs("div",{className:"w-full grid grid-cols-12 items-center gap-2 bg-slate-500 text-white font-semibold border border-slate-200 px-4 py-2",children:[s.jsx("div",{className:"col-span-2 text-sm",children:"Sl.No."}),s.jsx("div",{className:"col-span-3 text-sm",children:"Transaction No"}),s.jsx("div",{className:"col-span-3 text-sm",children:"Transaction Date"}),s.jsx("div",{className:"col-span-2 text-sm",children:"Amount"}),s.jsxs("div",{className:"col-span-2 text-sm flex",children:[s.jsx("span",{children:"Action"}),!b&&Array.isArray(r==null?void 0:r.tranDtl)&&((V=r==null?void 0:r.tranDtl)==null?void 0:V.length)>0&&s.jsx("label",{class:"inline-flex items-center px-4 animate__animated animate__fadeIn animate__faster",children:s.jsx("input",{type:"checkbox",name:"cashAll",checked:w,onChange:e=>R(e),class:"cursor-pointer form-checkbox h-5 w-5 text-slate-800"})})]})]}),b&&s.jsx(P,{}),!b&&Array.isArray(r==null?void 0:r.tranDtl)&&((B=r==null?void 0:r.tranDtl)==null?void 0:B.map((e,t)=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"w-full text-sm grid grid-cols-12 items-center gap-2 bg-slate-100 border-b hover:bg-white pb-1 p-4 animate__animated animate__fadeIn animate__faster",children:[s.jsx("div",{className:"col-span-2",children:t+1}),s.jsx("div",{className:"col-span-3",children:j(e==null?void 0:e.tran_no)}),s.jsx("div",{className:"col-span-3",children:pe(e==null?void 0:e.tran_date)}),s.jsx("div",{className:"col-span-2",children:k(e==null?void 0:e.total_amount)}),s.jsx("div",{className:"col-span-2",children:s.jsx("label",{class:"inline-flex items-center justify-end px-4",children:s.jsx("input",{type:"checkbox",name:"cashSingle",checked:w||te(e==null?void 0:e.id)?!0:null,value:e==null?void 0:e.id,onChange:a=>R(a,e==null?void 0:e.id),class:"cursor-pointer form-checkbox h-5 w-5 text-slate-800"})})})]},t)}))),!b&&Array.isArray(d)&&(d==null?void 0:d.length)==0&&s.jsx("div",{className:"w-full text-center text-red-400 font-semibold pb-1 p-4",children:"No List Available"})]})]})]})})]}),N&&s.jsx(P,{}),!N&&Array.isArray(d)&&(d==null?void 0:d.length)>0&&s.jsx(be,{dataList:d,columns:q})]})};export{Te as default};
