import{j as e,_ as c,c as g,b as N,P as f}from"./index-K9wnwIEh.js";import{h as v,e as P}from"./router-WshRxXk2.js";import{S as C,a as _,u as S,F as M}from"./TextArea-wmoREJF1.js";import{c as k,a as y}from"./index.esm-Wdru5IDi.js";import{u as A,b as w}from"./useCustomQuery-5jXXRIIF.js";import{r as u}from"./tailwind-Ucrx0-S6.js";import{C as F,O as R}from"./CreateConfirmation-m8LcWMgm.js";import"./reactQuery-2daanlHr.js";import"./reactQueryDevtools-6dm9iask.js";import"./axios-YpSsR79r.js";import"./reactLazyLoadImageComponent-2lnvQYCj.js";import"./reactIcons-UnuJhE_7.js";import"./headlessui-oHdMYZDI.js";function q({challanDetail:s,formik:d}){var a,t,m,l,n,i;return e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"",children:e.jsx("h1",{className:"text-base font-semibold text-blue-gray-500",children:"Payment Challan"})}),e.jsx(u.Card,{className:"mt-2",children:e.jsx(u.CardBody,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Challan No"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Name"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Date:"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Amount:"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Type:"}),e.jsx("h1",{className:"text-sm font-semibold text-blue-gray-500 mt-2",children:"Status:"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(a=s==null?void 0:s.data)==null?void 0:a.challan_no}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(t=s==null?void 0:s.data)==null?void 0:t.full_name}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(m=s==null?void 0:s.data)==null?void 0:m.challan_date}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(l=s==null?void 0:s.data)==null?void 0:l.amount}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(n=s==null?void 0:s.data)==null?void 0:n.challan_type}),e.jsx("p",{className:"text-sm  text-blue-gray-500 mt-2",children:(i=s==null?void 0:s.data)!=null&&i.payment_status?e.jsx("span",{className:"text-sm font-bold bg-green-100 text-green-500 rounded-lg px-2 py-1",children:"Paid"}):e.jsx("span",{className:"text-xs bg-red-100 text-red-500 rounded-lg px-2 py-1",children:"Unpaid"})})]})]})})}),e.jsx("div",{className:"border-t border-gray-200 my-4"}),e.jsxs("div",{className:"py-2",children:[e.jsx("h1",{className:"text-base font-semibold text-blue-gray-500",children:"Payment Now"}),e.jsx(u.Card,{className:"mt-2",children:e.jsx(u.CardBody,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsxs(C,{label:"Payment Method",name:"paymentMode",formik:d,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"ONLINE",children:"Online"})]})}),e.jsx("div",{children:e.jsx(_,{label:"Remark",name:"remark",formik:d,placeholder:"Enter Remark"})}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-lg text-xs",children:"Pay Now"})})]})})})]})]})}function K(){var n,i;const s=v(),d=A({}),{id:a}=P(),t=w({api:g.api_get_challan_by_id,config:{challanId:a},options:{enabled:!!a}}),m=S({enableReinitialize:!0,initialValues:{applicationId:(i=(n=t==null?void 0:t.data)==null?void 0:n.data)==null?void 0:i.application_id,challanId:a,paymentMode:"",remark:""},validationSchema:k().shape({challanId:y().required("Challan Id is required"),paymentMode:y().required("Payment Mode is required"),remark:y().required("Remark is required").min(3).max(100).label("Remark")}),onSubmit:async p=>{var o,x;await F("Are you sure you want to pay challan ".concat((x=(o=t==null?void 0:t.data)==null?void 0:o.data)==null?void 0:x.amount,"?"))?p.paymentMode==="CASH"?await l(p):c.error("Under Development - Please select Cash Payment Mode"):c.error("Payment Cancelled")}}),l=async p=>{var o,x,j,h,b;try{const r=await d.mutateAsync({api:g.api_postCashPayment,data:p});(o=r.data)!=null&&o.status?(c.success((x=r.data)==null?void 0:x.message),s("/fines-app/payment-receipt/".concat((h=(j=r.data)==null?void 0:j.data)==null?void 0:h.tran_no),{replace:!0})):c.error((b=r.data)==null?void 0:b.message)}catch(r){c.error(r.message)}};return t.isLoading?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(N,{})}):e.jsx(e.Fragment,{children:e.jsxs(f,{title:"Payment Challan",meta:e.jsx(e.Fragment,{children:e.jsx("meta",{name:"description",content:"Generate Challan"})}),children:[d.isLoading&&e.jsx(R,{}),t.isSuccess&&e.jsx(M,{formik:m,children:e.jsx(q,{challanDetail:t.data,formik:m})})]})})}export{K as default};
