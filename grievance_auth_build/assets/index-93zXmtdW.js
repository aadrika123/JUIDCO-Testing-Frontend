import{u as W,G as O,v as U,g as S,b as X,o as Z,r as o,J as D,N as ee,j as e,D as ae,F as se,R as te,O as re,H as de,A as V,B as le,c as ne,d as I,_ as c,K as J,w as ce,x as ie,M as oe,y as ue,S as he,z as xe}from"./index-CtV24Q57.js";import{P as ge}from"./index-BYiFiVfg.js";import{T as pe,a as je,b as K,c as x,d as me,e as g}from"./table-CZIjl9tM.js";import{g as fe}from"./services-KQnp_8oA.js";import{P as Ne}from"./index-Bowmb8FB.js";import{S as be}from"./index-BXPuUs73.js";import{q as ye}from"./switch-Cd5U_YED.js";const ve=ne().shape({titleName:I().required("Title Name is required"),description:I().required("Description is required"),moduleId:I().required("Module id is required")});function Se({open:w,setOpen:u,title:$,id:h,edit:i,setEdit:p,refetch:M}){var A,C,m;const T=W({}),j=O({}),{data:n,isFetching:E}=U({api:`${S.getComplaintById}/${h}`,key:"getComplaintById",options:{enabled:i}}),d=X({defaultValues:{titleName:"",description:"",moduleId:""},resolver:Z(ve)}),P=async l=>{var f,N,b,y;try{if(i&&l){const r=await j.mutateAsync({api:`${S.updateComplaint}/${h}`,data:l});(f=r.data)!=null&&f.success?c.success((N=r==null?void 0:r.data)==null?void 0:N.message):c.error("Grievance not updated successfully")}else{const r=await T.mutateAsync({api:S.createComplaint,data:l});(b=r.data)!=null&&b.success?c.success((y=r==null?void 0:r.data)==null?void 0:y.message):c.error("Grievance not created successfully"),d.reset({titleName:""})}u(!1),p(!1),M()}catch(r){console.log(r)}};o.useEffect(()=>{i&&n?d.reset({titleName:n.data.titleName,description:n.data.description,moduleId:n.data.moduleId}):d.reset({titleName:"",description:"",moduleId:""})},[i,n]);const s=D({api:ee,options:{enabled:!0}});return console.log(s.data),e.jsx(ae,{open:w,setOpen:u,title:$,setEdit:p,edit:i,isLoading:E,children:e.jsx(se,{methods:d,onSubmit:d.handleSubmit(P),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(te,{name:"titleName",placeholder:"Enter your title name"})}),e.jsx("div",{children:e.jsx(re,{name:"moduleId",data:((m=(C=(A=s.data)==null?void 0:A.data)==null?void 0:C.docs)==null?void 0:m.map(l=>({value:l.id,label:l.module_name})))??[]})}),e.jsx("div",{children:e.jsx(de,{name:"description",placeholder:"Enter your description"})}),e.jsx(V,{}),e.jsx("div",{children:e.jsx(le,{isLoading:d.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Pe(){var m,l,f,N,b,y,r,q,B,H,k;const w=O({}),[u,$]=o.useState(1),[h,i]=o.useState(10),[p,M]=o.useState(""),[T,j]=o.useState(!1),[n,E]=o.useState(""),[d,P]=o.useState(!1),s=U({api:`${S.getAllComplaint}?page=${u}&limit=${h}&q=${p}`,key:"getAllComplaint",value:[u,h],options:{enabled:!0}}),A=a=>{P(!0),j(!0),E(a)},C=async a=>{var F,v,L,R,_,Q,Y,G,z;try{const t=await w.mutateAsync({api:`${(F=S)==null?void 0:F.updateComplaintStatus}/${a}`,data:{id:n}});(v=t==null?void 0:t.data)!=null&&v.success?(s.refetch(),((R=(L=t==null?void 0:t.data)==null?void 0:L.data)==null?void 0:R.status)==1&&c.success((_=t==null?void 0:t.data)==null?void 0:_.message),((Y=(Q=t==null?void 0:t.data)==null?void 0:Q.data)==null?void 0:Y.status)==0&&c.error((G=t==null?void 0:t.data)==null?void 0:G.message)):c.error((z=t.data)==null?void 0:z.message)}catch(t){c.error(fe(t))}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(Se,{open:T,setOpen:j,title:d?"Edit FAQ":"Add FAQ",id:n,edit:d,setEdit:P,refetch:s.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(be,{search:p,setSearch:M,refetch:s.refetch,isFetching:s==null?void 0:s.isLoading})}),e.jsx("div",{children:e.jsx(J,{className:"flex items-center gap-2",onClick:()=>j(!0),children:"Add New"})})]}),e.jsxs(ce,{children:[e.jsx(ie,{className:"px-7",children:e.jsxs(oe,{children:["FAQ List (",(l=(m=s==null?void 0:s.data)==null?void 0:m.data)==null?void 0:l.totalDocs,")"]})}),e.jsx(ue,{children:s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(he,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(pe,{children:[e.jsx(je,{children:e.jsxs(K,{children:[e.jsx(x,{className:"",children:"#"}),e.jsx(x,{className:"",children:"Title Name"}),e.jsx(x,{className:"",children:"Module Name"}),e.jsx(x,{className:"",children:"Created at"}),e.jsx(x,{className:"",children:"Status"}),e.jsx(x,{children:"Action"})]})}),e.jsx(me,{children:(b=(N=(f=s==null?void 0:s.data)==null?void 0:f.data)==null?void 0:N.docs)==null?void 0:b.map((a,F)=>{var v;return e.jsxs(K,{children:[e.jsx(g,{children:F+1}),e.jsx(g,{children:a==null?void 0:a.titleName}),e.jsx(g,{children:(v=a==null?void 0:a.modules)==null?void 0:v.moduleName}),e.jsx(g,{children:xe(a==null?void 0:a.createdAt).format("DD-MM-YYYY")}),e.jsx(g,{children:e.jsxs(ye,{checked:(a==null?void 0:a.status)==1,onChange:()=>C(a==null?void 0:a._id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),e.jsx(g,{children:e.jsx(J,{className:"bg-primary",onClick:()=>A(a==null?void 0:a._id),children:"Edit"})})]},a==null?void 0:a._id)})})]}),e.jsx(V,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Ne,{page:u,perPage:h,totalPage:(r=(y=s==null?void 0:s.data)==null?void 0:y.data)==null?void 0:r.totalDocs,hasNextPage:(B=(q=s==null?void 0:s.data)==null?void 0:q.data)==null?void 0:B.hasNextPage,hasPrevPage:(k=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:k.hasPrevPage,setPage:$,setPerPage:i})})]})})]})]})]})}function Ee(){return e.jsx(ge,{title:"FAQ List",subTitle:"Manage all the FAQ here",children:e.jsx("div",{className:"py-12",children:e.jsx(Pe,{})})})}export{Ee as default};
