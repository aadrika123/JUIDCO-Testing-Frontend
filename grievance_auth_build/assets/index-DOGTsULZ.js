import{r as v,b as pa,o as ia,v as c,g as o,j as a,F as ha,A as la,Z as n,R as N,O as i,B as xa,w as ua,x as ja,M as ga,y as ba,S as ya,z as f,a0 as t,L as va,K as Na,c as fa,d as p,aL as ra}from"./index-DOg5tZ0E.js";import{T as Ta,a as Ia,b as sa,c as s,d as Aa,e as d}from"./table-DEeRP3-S.js";import{P as Pa}from"./index-BnjuEhHp.js";import{P as $a}from"./index-CgOOQbWr.js";const wa=fa().shape({ulbId:p(),moduleId:p(),complaintTypeId:p(),priorityId:p(),targetTypeId:p(),complaintSourceTypeId:p(),fDate:ra(),type:p(),toDate:ra(),complaintRefNo:p()});function Sa(){var T,I,A,P,$,w,S,L,R,m,F,k,D,C,_,M,G,H,B,E,O,Y,U,V,z,K,W,Z,q,J,Q;const[x,da]=v.useState(1),[h,na]=v.useState(10),r=pa({resolver:ia(wa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",type:"",complaintSourceTypeId:"",fDate:"",toDate:"",complaintRefNo:""}});console.log("methods");const ca=async()=>{l.refetch()},l=c({api:`${o.complaintReport}?page=${x}&limit=${h}&priority=${r.watch("priorityId")}&ulb=${r.watch("ulbId")}&complaintType=${r.watch("complaintTypeId")}&targetType=${r.watch("targetTypeId")}&module=${r.watch("moduleId")}&source=${r.watch("complaintSourceTypeId")}&fDate=${r.watch("fDate")}&toDate=${r.watch("toDate")}&complaintRefNo=${r.watch("complaintRefNo")}&type=${r.watch("type")}`,key:"searchAllComplaints",value:[x,h],options:{enabled:!0}});c({api:`${(T=o)==null?void 0:T.getAllUlb}?page=1&limit=10000`,key:"getAllUlb",options:{enabled:!0}}),c({api:`${(I=o)==null?void 0:I.getAllModule}?page=1&limit=10000`,key:"geAllModules",options:{enabled:!0}});const u=c({api:`${(A=o)==null?void 0:A.getAllComplaintType}?page=1&limit=10000`,key:"getAllComplaintTypes",options:{enabled:!0}}),j=c({api:`${(P=o)==null?void 0:P.getAllPriority}?page=1&limit=10000`,key:"getAllPriority",options:{enabled:!0}});c({api:`${($=o)==null?void 0:$.getAllTarget}?page=1&limit=10000`,key:"getAllTargetTypes",options:{enabled:!0}});const g=c({api:`${o.getAllComplaintSource}?page=1&limit=10000`,key:"getAllComplaintSource",options:{enabled:!0}}),b=c({api:`${o.getAllDepartment}?page=1&limit=10000`,key:"getAllDepartment",options:{enabled:!0,refetchOnMount:!1}}),y=c({api:`${o.getAllProblemDirect}?page=1&limit=10000`,key:"getProblemData",options:{enabled:!0,refetchOnMount:!1}}),oa=v.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsx(ha,{methods:r,onSubmit:r.handleSubmit(ca),children:a.jsxs("div",{className:"grid grid-cols-6 gap-x-2 gap-y-4 bg-background px-10 py-4",children:[a.jsx("h1",{className:"text-xl font-bold text-blue-800 uppercase col-span-4",children:"Grievance Report"}),a.jsx(la,{className:"col-span-6"}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"complaintRefNo",children:"Grievance No."}),a.jsx(N,{name:"complaintRefNo",className:"",placeholder:"Enter Grievance number"})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"fDate",children:"From Date"}),a.jsx(N,{name:"fDate",type:"date",className:""})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"toDate",children:"Upto Date"}),a.jsx(N,{name:"toDate",type:"date",className:""})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"moduleId",children:"Department"}),a.jsx(i,{className:"bg-background cursor-pointer",name:"moduleId",data:((L=(S=(w=b==null?void 0:b.data)==null?void 0:w.data)==null?void 0:S.docs)==null?void 0:L.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.department})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"targetTypeId",children:"Grievance Type"}),a.jsx(i,{className:"bg-background cursor-pointer",name:"targetTypeId",data:((F=(m=(R=y==null?void 0:y.data)==null?void 0:R.data)==null?void 0:m.docs)==null?void 0:F.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.problem})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"complaintTypeId",children:"Entry Type"}),a.jsx(i,{className:"bg-background cursor-pointer",name:"complaintTypeId",data:((C=(D=(k=u==null?void 0:u.data)==null?void 0:k.data)==null?void 0:D.docs)==null?void 0:C.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.complaintTypeName})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"priorityId",children:"Priority"}),a.jsx(i,{className:"bg-background cursor-pointer",name:"priorityId",data:((G=(M=(_=j==null?void 0:j.data)==null?void 0:_.data)==null?void 0:M.docs)==null?void 0:G.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.priorityName})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"complaintSourceTypeId",children:"Entry Modes"}),a.jsx(i,{className:"bg-background cursor-pointer",name:"complaintSourceTypeId",data:((E=(B=(H=g==null?void 0:g.data)==null?void 0:H.data)==null?void 0:B.docs)==null?void 0:E.map(e=>({value:e==null?void 0:e._id,label:e==null?void 0:e.source})))??[]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"type",children:"Grievance Status"}),a.jsx(i,{name:"type",data:[{value:"0",label:"Pending"},{value:"1",label:"Resolved"},{value:"2",label:"Rejected"},{value:"3",label:"Pending (Re-Opened)"},{value:"4",label:"Withdrawn"}]})]}),a.jsxs("div",{children:[a.jsx(n,{htmlFor:"type",children:"Level Status"}),a.jsx(i,{name:"type",data:[{value:"L1",label:"L1"},{value:"L2",label:"L2"},{value:"L3",label:"L3"}]})]}),a.jsx("div",{}),a.jsx("div",{className:"mt-6",children:a.jsx(xa,{isLoading:r.formState.isSubmitting,type:"submit",className:" w-auto  px-10 float-right",children:"Search"})})]})}),a.jsx("div",{className:"mt-2",children:a.jsxs(ua,{children:[a.jsx(ja,{className:"px-7",children:a.jsxs(ga,{className:"flex justify-between",children:[a.jsxs("h1",{children:["Grievance List (",(Y=(O=l.data)==null?void 0:O.data)==null?void 0:Y.totalDocs,")"]}),a.jsx("h1",{className:"flex gap-2 "})]})}),a.jsx(ba,{children:l.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(ya,{})}):a.jsxs("div",{children:[a.jsxs(Ta,{ref:oa,children:[a.jsx(Ia,{children:a.jsxs(sa,{className:"text-xs",children:[a.jsx(s,{className:"",children:"#"}),a.jsx(s,{className:"",children:"Grievance No."}),a.jsx(s,{className:"",children:"Department"}),a.jsx(s,{className:"",children:"Received Date"}),a.jsx(s,{className:"",children:"Source"}),a.jsx(s,{className:"",children:"Pending At"}),a.jsx(s,{className:"",children:"Redressal Days"}),a.jsx(s,{className:"",children:"Status"}),a.jsx(s,{className:"",children:"Level Status"}),a.jsx(s,{className:"",children:"Priority"}),a.jsx(s,{className:"",children:"View"})]})}),a.jsx(Aa,{children:(z=(V=(U=l==null?void 0:l.data)==null?void 0:U.data)==null?void 0:V.docs)==null?void 0:z.map((e,ta)=>{var X,aa,ea;return a.jsxs(sa,{className:"text-xs",children:[a.jsx(d,{children:x*h-h+ta+1}),a.jsx(d,{children:(e==null?void 0:e.complaintRefNo)||"N/A"}),a.jsx(d,{children:((X=e==null?void 0:e.department)==null?void 0:X.department)||"N/A"}),a.jsx(d,{children:f(e==null?void 0:e.createdAt).format("DD-MM-YYYY")||"N/A"}),a.jsx(d,{children:((aa=e==null?void 0:e.source)==null?void 0:aa.source)||"N/A"}),a.jsx(d,{children:(e==null?void 0:e.pendingAt)||"N/A"}),a.jsxs(d,{children:[" ",f().diff(f(e==null?void 0:e.createdAt),"days")," days"]}),a.jsxs(d,{children:[(e==null?void 0:e.wf_status)===4&&a.jsx(t,{variant:"destructive",children:"Closed"}),(e==null?void 0:e.wf_status)===3&&a.jsx(t,{className:"bg-amber-500 text-white",children:"Pending(Re-Opened)"}),(e==null?void 0:e.wf_status)===2&&a.jsx(t,{variant:"destructive",children:"Rejected"}),(e==null?void 0:e.wf_status)===1&&a.jsx(t,{variant:"success",children:"Resolved"}),(e==null?void 0:e.wf_status)===0&&a.jsx(t,{variant:"secondary",children:"Pending"})]}),a.jsxs(d,{children:[(e==null?void 0:e.slaLevel)===1&&a.jsx(t,{className:"bg-gray-400 hover:bg-gray-400",children:"L1"}),(e==null?void 0:e.slaLevel)===2&&a.jsx(t,{className:"bg-amber-500 hover:bg-amber-500",children:"L2"}),(e==null?void 0:e.slaLevel)===3&&a.jsx(t,{className:"bg-red-500 hover:bg-red-500",children:"L3"})]}),a.jsx(d,{children:((ea=e==null?void 0:e.priority)==null?void 0:ea.priorityName)||"N/A"}),a.jsx(d,{children:a.jsx(va,{to:`/grievance/dashboard/management-complaint-details?complaintRefNo=${e==null?void 0:e.complaintRefNo}
                         &complaintId=${e==null?void 0:e._id}`,children:a.jsx(Na,{className:"bg-primary",onClick:()=>{},children:"View"})})})]},e._id)})})]}),a.jsx(la,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(Pa,{page:x,perPage:h,totalPage:(W=(K=l==null?void 0:l.data)==null?void 0:K.data)==null?void 0:W.totalDocs,hasNextPage:(q=(Z=l==null?void 0:l.data)==null?void 0:Z.data)==null?void 0:q.hasNextPage,hasPrevPage:(Q=(J=l==null?void 0:l.data)==null?void 0:J.data)==null?void 0:Q.hasPrevPage,setPage:da,setPerPage:na})})]})})]})})]})}function ka(){return a.jsx($a,{title:"",subTitle:"",children:a.jsx("div",{className:"",children:a.jsx(Sa,{})})})}export{ka as default};
