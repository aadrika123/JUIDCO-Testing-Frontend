import{U as Gr,j as e,I as U,z as F,u as W,b as V,o as Q,r as I,F as X,C as O,$ as Br,a6 as B,Z as J,P as Fr,H as Z,B as D,c as ee,d as se,Q as Zr,g as T,_ as j,v as G,S as Wr,K as _,T as Dr,a8 as ea,a9 as sa,a0 as h,a1 as $,a2 as K,a3 as z,a4 as M,a5 as da,aa as ra,L as Lr,w as aa,y as la,k as ca,W as Or}from"./index-CtV24Q57.js";import{P as na}from"./index-BYiFiVfg.js";import{p as $r,M as Y,F as Pr,a as ta,b as ia,c as xa,d as oa,e as ha,f as ja,g as ua,h as Na,i as fa,j as va,k as ma,l as ga,m as ba,n as ya}from"./module.config-DQ0XVMj7.js";import{g as P}from"./services-KQnp_8oA.js";import{I as Kr}from"./info-DEFceiMt.js";import{T as zr,a as qr,b as q,c as k,d as Hr,e as L}from"./table-CZIjl9tM.js";import{M as wa}from"./move-right-DPv1HNTq.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Gr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Gr("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function _a({commentData:a}){var r,g,t;return e.jsx("div",{children:e.jsxs("div",{className:"max-w-lg mx-auto border px-6 py-2 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center mb-4 space-x-2",children:[e.jsx(U,{src:((r=a==null?void 0:a.userId)==null?void 0:r.fullImgUrl)||$r,alt:"Student",className:"h-6 w-6 rounded-full"})," ",e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-800 font-semibold",children:((g=a==null?void 0:a.userId)==null?void 0:g.fullName)||""}),e.jsx("div",{className:"text-xs italic text-gray-500",children:`(${(t=a==null?void 0:a.roleId)==null?void 0:t.roleName})`||""}),e.jsx("div",{className:"text-xs text-gray-500",children:F(a==null?void 0:a.timeStamp).format("DD-MM-YYYY hh:mm a")})]})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-6",children:a==null?void 0:a.comment})]})})}const Ia=ee().shape({comment:se().required("Write comment"),resolveDocs:Zr().required("Please upload a document")});function Ea({setisDialogOpen:a,complaintData:r,actionPermissions:g}){const t=W({}),x=V({resolver:Q(Ia)}),[N,f]=I.useState(null),[w,y]=I.useState(null),c=async i=>{const u=i.target.files[0];if(u)if(f(u),x.setValue("resolveDocs",u),u.type.startsWith("image/")){const v=URL.createObjectURL(u);y(v)}else y(null)},n=async i=>{var v,s;const u=new FormData;u.append("complaintId",(s=(v=r==null?void 0:r.data)==null?void 0:v.data)==null?void 0:s._id),u.append("comment",i.comment),u.append("resolveDocs",i.resolveDocs);try{const l=await t.mutateAsync({api:T.resolveComplaint,data:u});l.data.success?(j.success(l.data.message),g.refetch(),r==null||r.refetch(),a(!1)):j.error(l.data.message)}catch(l){j.error(P(l))}};return e.jsx(X,{methods:x,onSubmit:x.handleSubmit(n),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs(O,{className:"mb-6 flex items-center justify-between text-2xl font-bold",children:[e.jsxs("div",{children:[e.jsx("span",{className:"mr-2 inline-flex h-7 w-7 items-center justify-center rounded-full bg-green-600 text-white",children:e.jsx(Br,{className:"inline"})}),"Resolve Grievance"]}),e.jsx("div",{children:e.jsx(B,{className:"inline cursor-pointer rounded-lg hover:bg-red-100",onClick:()=>a(!1)})})]}),e.jsxs(J,{className:"flex items-center opacity-70",children:[e.jsx(Kr,{size:20,className:"mr-1 inline"}),e.jsx("span",{children:"This comment will be visible to the citizen."})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Fr,{className:"cursor-pointer",accept:"image/jpeg,image/jpg,image/png,application/pdf",name:"resolveDocs",placeholder:"Select document",onChange:c})}),N&&e.jsxs("div",{className:"mt-4 rounded-md border p-4 shadow-lg",children:[N&&e.jsx("p",{className:"font-semibold",children:N.name}),w?e.jsx("img",{src:w,alt:"Preview",className:"mt-2 h-32 w-32 rounded-md object-cover"}):e.jsx("p",{className:"text-gray-500"})]}),e.jsx(Z,{className:"mt-2 h-40 w-full rounded-md border bg-background p-4",name:"comment",placeholder:"Comment"}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{isLoading:x.formState.isSubmitting,type:"submit",className:"w-full",children:"Resolve"})})]})})}const Sa=ee().shape({comment:se().required("Select comment")});function Ca({setisDialogOpen:a,complaintData:r,actionPermissions:g}){const t=W({}),x=V({resolver:Q(Sa)}),N=async f=>{var y,c;let w={complaintId:(c=(y=r==null?void 0:r.data)==null?void 0:y.data)==null?void 0:c._id,comment:f==null?void 0:f.comment};try{const n=await t.mutateAsync({api:T.rejectComplaint,data:w});n.data.success?(j.success(n.data.message),g.refetch(),r==null||r.refetch(),a(!1)):j.error(n.data.message)}catch(n){j.error(P(n))}};return e.jsx(X,{methods:x,onSubmit:x.handleSubmit(N),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs("div",{children:[e.jsxs(O,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"w-7 h-7 bg-red-600 rounded-full bg-red-5500 text-white inline-flex justify-center items-center mr-2",children:e.jsx(B,{})})," Reject Grievance"]}),e.jsx("div",{children:e.jsx(B,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),e.jsxs(J,{className:"opacity-70 flex items-center",children:[e.jsx("div",{children:e.jsx(Kr,{size:20,className:"inline mr-1"})}),e.jsx("div",{children:"This comment will be visible to citizen."})]}),e.jsx(Z,{className:"bg-background w-full rounded-md p-4 h-40 border mt-2",name:"comment",placeholder:"Comment"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{isLoading:x.formState.isSubmitting,type:"submit",className:" w-full",children:"Reject"})})]})})}function Ra({setisDialogOpen:a,complaintData:r,actionPermissions:g}){var f,w,y,c,n;const t=W({}),x=G({api:`${T.getAllWFUserMappingToTransfer}?workflowId=${(w=(f=r==null?void 0:r.data)==null?void 0:f.data)==null?void 0:w.wf_currentWorkflowId}`,key:"getWorkflowMembers",value:[],options:{enabled:!0}}),N=async i=>{var v,s,l;let u={complaintId:(s=(v=r==null?void 0:r.data)==null?void 0:v.data)==null?void 0:s._id,workflowId:null,userId:i};try{const E=await t.mutateAsync({api:(l=T)==null?void 0:l.transferComplaintToUlb,data:u});E.data.success?(j.success(E.data.message),r==null||r.refetch(),g.refetch(),a(!1)):j.error(E.data.message)}catch(E){j.error(P(E))}};return e.jsx("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:e.jsxs("div",{children:[e.jsxs(O,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsx("div",{children:"Transfer to any Members"}),e.jsx("div",{children:e.jsx(B,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),x.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Wr,{})}):e.jsx(e.Fragment,{children:e.jsxs(zr,{children:[e.jsx(qr,{children:e.jsxs(q,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"Member"}),e.jsx(k,{className:"",children:"Workflow Role"}),e.jsx(k,{children:"Action"})]})}),e.jsx(Hr,{children:(n=(c=(y=x==null?void 0:x.data)==null?void 0:y.data)==null?void 0:c.docs)==null?void 0:n.map((i,u)=>e.jsxs(q,{children:[e.jsx(L,{children:u+1}),e.jsx(L,{children:i==null?void 0:i.UserName}),e.jsx(L,{children:i==null?void 0:i.workflowRoleName}),e.jsx(L,{className:"space-x-2",children:e.jsx(_,{name:"bts",type:"button",className:"mr-4",onClick:()=>N(i==null?void 0:i.userId),children:"Transfer"})})]},i._id))})]})})]})})}function Aa({setisDialogOpen:a,complaintData:r}){var N,f,w,y;const g=W({}),t=G({api:Dr,key:"getAllUlbDirect",options:{enabled:!0}}),x=async c=>{var n,i,u;try{let v={complaintId:(i=(n=r==null?void 0:r.data)==null?void 0:n.data)==null?void 0:i._id,ulbId:c};const s=await g.mutateAsync({api:(u=T)==null?void 0:u.transferComplaintToUlbSpecific,data:v});s.data.success?(j.success(s.data.message),r.refetch(),a(!1)):j.error(s.data.message)}catch(v){j.error(P(v))}};return e.jsx("div",{className:"gap-x-2 gap-y-4 px-10 py-10 h-[600px] overflow-y-scroll",children:e.jsxs("div",{children:[e.jsxs(O,{className:"text-2xl flex items-center justify-between font-bold mb-6",children:[e.jsxs("div",{children:["Transfer to ULB(",(f=(N=t==null?void 0:t.data)==null?void 0:N.data)==null?void 0:f.length,")"]}),e.jsx("div",{children:e.jsx(B,{className:"cursor-pointer hover:bg-red-100 rounded-lg inline",onClick:()=>a(!1)})})]}),t.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(Wr,{})}):e.jsx(e.Fragment,{children:e.jsxs(zr,{children:[e.jsx(qr,{children:e.jsxs(q,{children:[e.jsx(k,{className:"",children:"#"}),e.jsx(k,{className:"",children:"ULB"}),e.jsx(k,{children:"Action"})]})}),e.jsx(Hr,{children:(y=(w=t==null?void 0:t.data)==null?void 0:w.data)==null?void 0:y.map((c,n)=>e.jsxs(q,{children:[e.jsx(L,{children:n+1}),e.jsx(L,{children:c==null?void 0:c.ulb_name}),e.jsx(L,{className:"space-x-2",children:e.jsx(_,{name:"bts",type:"button",className:"mr-4",onClick:()=>x(c==null?void 0:c.id),children:"Transfer"})})]},c.id))})]})})]})})}const Ma="https://jharkhandegovernance.com/property/search/fresh/direct/direct",Ua="https://jharkhandegovernance.com/water/waterApplicationSearch",ka="",La="",Oa="",Pa="",Ga="",Ba="",Fa="",Wa="",$a="",Ka="",za="",qa="",Ha="",Ya=ee().shape({comment:se().required("Comment is required")});function Va({setsearchLink:a,setsearchLabel:r}){var de,re,ae,le,ce,ne,te,ie,xe,oe,he,je,ue,Ne,fe,ve,me,ge,be,ye,we,pe,Te,_e,Ie,Ee,Se,Ce,Re,Ae,Me,Ue,ke,Le,Oe,Pe,Ge,Be,Fe,We,$e,Ke,ze,qe,He,Ye,Ve,Qe,Xe,Je,Ze,De,es,ss,ds,rs,as,ls,cs,ns,ts,is,xs,os,hs,js,us,Ns,fs,vs,ms,gs,bs,ys,ws,ps,Ts,_s,Is,Es,Ss,Cs,Rs,As,Ms,Us,ks,Ls,Os,Ps,Gs,Bs,Fs,Ws,$s,Ks,zs,qs,Hs,Ys,Vs,Qs,Xs,Js,Zs,Ds,ed,sd,dd,rd,ad,ld,cd,nd,td,id,xd,od,hd,jd,ud,Nd,fd,vd,md,gd,bd,yd,wd,pd,Td,_d,Id,Ed,Sd,Cd,Rd,Ad,Md,Ud,kd,Ld,Od,Pd,Gd,Bd,Fd,Wd,$d,Kd,zd,qd,Hd,Yd,Vd,Qd,Xd,Jd,Zd,Dd,er,sr,dr,rr,ar,lr,cr,nr,tr,ir,xr,or,hr;const[g,t]=I.useState(!1),[x,N]=I.useState(0),[f,w]=I.useState(!1),[y,c]=I.useState(!1),n=W({}),v=new URLSearchParams(ca().search).get("complaintId"),s=G({api:`${T.getComplaintDetailsById}/${v}`,key:"ComplaintDetails",options:{enabled:!0}}),l=G({api:`${T.checkWfActions}/${v}`,key:"actionPermission",options:{enabled:!0}}),E=G({api:`${T.complaintApplicationLog}/${v}`,key:"complaintApplicationLog",options:{enabled:!0}}),S=G({api:`${T.getAllCommentsByComplaintId}/${v}`,key:"getAllComments",options:{enabled:!0}}),H=V({defaultValues:{comment:""},resolver:Q(Ya)}),{handleSubmit:Yr}=H,Vr=async(d,o)=>{var C,R;const b=o.nativeEvent.submitter.name;let m="";b==="comment"&&(m=T.openComment);let p={comment:d.comment,complaintId:(R=(C=s==null?void 0:s.data)==null?void 0:C.data)==null?void 0:R._id};try{const A=await n.mutateAsync({api:m,data:p});A.data.success?(j.success(A.data.message),s==null||s.refetch(),S==null||S.refetch(),l.refetch(),H.reset()):j.error(A.data.message)}catch(A){j.error(P(A))}},Qr=async()=>{Or("Are you sure?","Do you want to move this Grievance to your panel",async()=>{var o,b;let d={complaintId:(b=(o=s==null?void 0:s.data)==null?void 0:o.data)==null?void 0:b._id,comment:""};try{const m=await n.mutateAsync({api:T.moveComplaintToMe,data:d});m.data.success?(t(!0),s==null||s.refetch(),S==null||S.refetch(),l.refetch()):j.error(m.data.message)}catch(m){j.error(P(m))}})},Xr=async d=>{Or("Are you sure?",`Do you want to ${d.target.checked?"Escalate":"De-Escalate"} this complaint`,async()=>{var b,m;let o={complaintId:(m=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:m._id};try{const p=await n.mutateAsync({api:T.escalateAction,data:o});p.data.success?(t(!0),s.refetch()):j.error(p.data.message)}catch(p){j.error(P(p))}})},Jr=()=>{var d,o,b,m,p,C,R,A,jr,ur,Nr,fr,vr,mr,gr,br,yr,wr,pr,Tr,_r,Ir,Er,Sr,Cr,Rr,Ar,Mr,Ur,kr;((o=(d=s==null?void 0:s.data)==null?void 0:d.data)==null?void 0:o.moduleId)===ta&&(a(Ma),r("Search Property Details")),((m=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:m.moduleId)===ia&&(a(Ua),r("Search Water Details")),((C=(p=s==null?void 0:s.data)==null?void 0:p.data)==null?void 0:C.moduleId)===xa&&(a(ka),r("Search Trade Details")),((A=(R=s==null?void 0:s.data)==null?void 0:R.data)==null?void 0:A.moduleId)===oa&&(a(La),r("Search Pet Registration Details")),((ur=(jr=s==null?void 0:s.data)==null?void 0:jr.data)==null?void 0:ur.moduleId)===Y&&(a(Oa),r("Search Other Details")),((fr=(Nr=s==null?void 0:s.data)==null?void 0:Nr.data)==null?void 0:fr.moduleId)===ha&&(a(Pa),r("Search Grievance Details")),((mr=(vr=s==null?void 0:s.data)==null?void 0:vr.data)==null?void 0:mr.moduleId)===ja&&(a(Ga),r("Search SWM Details")),((br=(gr=s==null?void 0:s.data)==null?void 0:gr.data)==null?void 0:br.moduleId)===ua&&(a(Ba),r("Search Water Tanker Details")),((wr=(yr=s==null?void 0:s.data)==null?void 0:yr.data)==null?void 0:wr.moduleId)===Na&&(a(Fa),r("Search Advertisement Details")),((Tr=(pr=s==null?void 0:s.data)==null?void 0:pr.data)==null?void 0:Tr.moduleId)===fa&&(a(Wa),r("Search Septic Tank Details")),((Ir=(_r=s==null?void 0:s.data)==null?void 0:_r.data)==null?void 0:Ir.moduleId)===va&&(a($a),r("Search Lodge/Banquet Details")),((Sr=(Er=s==null?void 0:s.data)==null?void 0:Er.data)==null?void 0:Sr.moduleId)===ma&&(a(Ka),r("Search Marriage Details")),((Rr=(Cr=s==null?void 0:s.data)==null?void 0:Cr.data)==null?void 0:Rr.moduleId)===ga&&(a(za),r("Search Public Transport Details")),((Mr=(Ar=s==null?void 0:s.data)==null?void 0:Ar.data)==null?void 0:Mr.moduleId)===ba&&(a(qa),r("Search Parking Details")),((kr=(Ur=s==null?void 0:s.data)==null?void 0:Ur.data)==null?void 0:kr.moduleId)===ya&&(a(Ha),r("Search Rig Details"))};return I.useEffect(()=>{Jr()},[s==null?void 0:s.data]),I.useEffect(()=>{setTimeout(()=>{t(!1)},1600)},[g]),e.jsxs("main",{className:"grid flex-1 items-start",children:[g&&e.jsx("div",{style:{zIndex:1001},className:"fixed left-0 top-0 z-50 flex h-full w-full items-center justify-center bg-white",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(ea,{className:"w-24",animationData:sa,loop:!0}),e.jsx("div",{className:"font-semibold",children:"Grievance Moved successfully."})]})}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-8 lg:col-span-2",children:[e.jsx("div",{className:"",children:e.jsx("div",{className:" bg-background",children:e.jsxs("div",{className:"mx-auto max-w-7xl  rounded-lg p-8 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h1",{className:"mb-6 text-xl font-bold uppercase text-blue-800",children:["Grievance No : ",(re=(de=s==null?void 0:s.data)==null?void 0:de.data)==null?void 0:re.complaintRefNo]}),((ce=(le=(ae=s==null?void 0:s.data)==null?void 0:ae.data)==null?void 0:le.workflow)==null?void 0:ce.workFlowName)&&e.jsxs("h1",{className:"text- Capitalize  mb-6 font-bold",children:[e.jsx("span",{className:"opacity-60",children:"Current Stage : "}),(ie=(te=(ne=s==null?void 0:s.data)==null?void 0:ne.data)==null?void 0:te.workflow)==null?void 0:ie.workFlowName]}),!((he=(oe=(xe=s==null?void 0:s.data)==null?void 0:xe.data)==null?void 0:oe.workflow)!=null&&he.workFlowName)&&e.jsxs("h1",{className:"text- Capitalize  mb-6 font-bold",children:[e.jsx("span",{className:"opacity-60",children:"Current Stage : "}),((ue=(je=s==null?void 0:s.data)==null?void 0:je.data)==null?void 0:ue.currentUser)&&`${(ve=(fe=(Ne=s==null?void 0:s.data)==null?void 0:Ne.data)==null?void 0:fe.currentUser)==null?void 0:ve.fullName} `,((ge=(me=s==null?void 0:s.data)==null?void 0:me.data)==null?void 0:ge.currentWorkflow)&&`(${(we=(ye=(be=s==null?void 0:s.data)==null?void 0:be.data)==null?void 0:ye.currentWorkflow)==null?void 0:we.workFlowName})`,!((Te=(pe=s==null?void 0:s.data)==null?void 0:pe.data)!=null&&Te.currentWorkflow)&&!((Ie=(_e=s==null?void 0:s.data)==null?void 0:_e.data)!=null&&Ie.currentUser)&&((Se=(Ee=s==null?void 0:s.data)==null?void 0:Ee.data)==null?void 0:Se.moduleId)===Y&&"State GRO",!((Re=(Ce=s==null?void 0:s.data)==null?void 0:Ce.data)!=null&&Re.currentWorkflow)&&!((Me=(Ae=s==null?void 0:s.data)==null?void 0:Ae.data)!=null&&Me.currentUser)&&((ke=(Ue=s==null?void 0:s.data)==null?void 0:Ue.data)==null?void 0:ke.moduleId)!==Y&&"ULB GRO"]}),e.jsx("h1",{className:"text-md mb-6  flex items-center font-bold",children:e.jsxs("span",{children:["Status -",((Oe=(Le=s==null?void 0:s.data)==null?void 0:Le.data)==null?void 0:Oe.wf_status)===0&&e.jsx(h,{className:"ml-2 bg-yellow-500",children:"Pending"}),((Ge=(Pe=s==null?void 0:s.data)==null?void 0:Pe.data)==null?void 0:Ge.wf_status)===1&&e.jsx(h,{className:"ml-2 bg-green-500",children:"Resolved"}),((Fe=(Be=s==null?void 0:s.data)==null?void 0:Be.data)==null?void 0:Fe.wf_status)===2&&e.jsx(h,{className:"ml-2 bg-red-500",children:"Rejected"}),(($e=(We=s==null?void 0:s.data)==null?void 0:We.data)==null?void 0:$e.wf_status)===3&&e.jsx(h,{className:"ml-2 bg-yellow-500",children:"Pending(re-opened)"}),((ze=(Ke=s==null?void 0:s.data)==null?void 0:Ke.data)==null?void 0:ze.wf_status)===4&&e.jsx(h,{variant:"destructive",children:"Closed"})]})})]}),e.jsxs("p",{className:"mb-2 text-gray-600",children:["Registered on"," ",F((He=(qe=s==null?void 0:s.data)==null?void 0:qe.data)==null?void 0:He.createdAt).format("DD-MM-YYYY")]}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),e.jsxs("div",{className:"mt-4  grid grid-cols-1 space-y-4   md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Full Name : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Ve=(Ye=s==null?void 0:s.data)==null?void 0:Ye.data)==null?void 0:Ve.citizenName)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Mobile No : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Xe=(Qe=s==null?void 0:s.data)==null?void 0:Qe.data)==null?void 0:Xe.mobileNo)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Email : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((Ze=(Je=s==null?void 0:s.data)==null?void 0:Je.data)==null?void 0:Ze.email)||"N/A"})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"ULB : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ss=(es=(De=s==null?void 0:s.data)==null?void 0:De.data)==null?void 0:es.ulb)==null?void 0:ss.ulbName})," "]})]}),e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((as=(rs=(ds=s==null?void 0:s.data)==null?void 0:ds.data)==null?void 0:rs.problemType)==null?void 0:as.problem)||"N/A"})," "]})]}),(((cs=(ls=s==null?void 0:s.data)==null?void 0:ls.data)==null?void 0:cs.holdingNo)||((ts=(ns=s==null?void 0:s.data)==null?void 0:ns.data)==null?void 0:ts.safNo)||((xs=(is=s==null?void 0:s.data)==null?void 0:is.data)==null?void 0:xs.consumerNo))&&e.jsxs(e.Fragment,{children:[((hs=(os=s==null?void 0:s.data)==null?void 0:os.data)==null?void 0:hs.holdingNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Holding No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.holdingNo})})]}),((us=(js=s==null?void 0:s.data)==null?void 0:js.data)==null?void 0:us.safNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"SAF No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.safNo})})]}),((fs=(Ns=s==null?void 0:s.data)==null?void 0:Ns.data)==null?void 0:fs.consumerNo)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Consumer No:"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.consumerNo})})]})]}),((ms=(vs=s==null?void 0:s.data)==null?void 0:vs.data)==null?void 0:ms.fixedNo)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsxs("div",{className:"font-semibold",children:[(bs=(gs=s==null?void 0:s.data)==null?void 0:gs.data)==null?void 0:bs.fixedNoLabel," :"," "]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(ws=(ys=s==null?void 0:s.data)==null?void 0:ys.data)==null?void 0:ws.fixedNo})," "]})]}),((Ts=(ps=s==null?void 0:s.data)==null?void 0:ps.data)==null?void 0:Ts.tempNo)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsxs("div",{className:"font-semibold",children:[(Is=(_s=s==null?void 0:s.data)==null?void 0:_s.data)==null?void 0:Is.tempNoLabel," :"," "]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Ss=(Es=s==null?void 0:s.data)==null?void 0:Es.data)==null?void 0:Ss.tempNo})," "]})]}),(((Rs=(Cs=s==null?void 0:s.data)==null?void 0:Cs.data)==null?void 0:Rs.wf_status)===0||((Ms=(As=s==null?void 0:s.data)==null?void 0:As.data)==null?void 0:Ms.wf_status)===3)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Pending From : "}),e.jsxs("div",{children:[e.jsxs("p",{className:"opacity-90",children:[F().diff(F((ks=(Us=s==null?void 0:s.data)==null?void 0:Us.data)==null?void 0:ks.createdAt),"days")," ","days"]})," "]})]}),((Os=(Ls=s==null?void 0:s.data)==null?void 0:Ls.data)==null?void 0:Os.priorityType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Priority Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Bs=(Gs=(Ps=s==null?void 0:s.data)==null?void 0:Ps.data)==null?void 0:Gs.priorityType)==null?void 0:Bs.priorityName})," "]})]}),((Ws=(Fs=s==null?void 0:s.data)==null?void 0:Fs.data)==null?void 0:Ws.targetType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Target Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:((zs=(Ks=($s=s==null?void 0:s.data)==null?void 0:$s.data)==null?void 0:Ks.targetType)==null?void 0:zs.targetType)||"N/A"})," "]})]}),((Hs=(qs=s==null?void 0:s.data)==null?void 0:qs.data)==null?void 0:Hs.complaintType)&&e.jsxs("div",{className:"flex items-center  space-x-4",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Type : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Qs=(Vs=(Ys=s==null?void 0:s.data)==null?void 0:Ys.data)==null?void 0:Vs.complaintType)==null?void 0:Qs.complaintTypeName})," "]})]}),e.jsx("div",{className:"col-span-3 my-20 border-b border-[#99B37C]"}),e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Description : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(Js=(Xs=s==null?void 0:s.data)==null?void 0:Xs.data)==null?void 0:Js.complaintDescription})," "]})]}),((Ds=(Zs=s==null?void 0:s.data)==null?void 0:Zs.data)==null?void 0:Ds.wf_currentReopenComment)&&e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Remark :"}),e.jsx("div",{children:e.jsx("p",{className:"opacity-90",children:s.data.data.wf_currentReopenComment})})]}),((sd=(ed=s==null?void 0:s.data)==null?void 0:ed.data)==null?void 0:sd.customAddress)&&e.jsxs("div",{className:"col-span-2 flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Address : "}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-90",children:(rd=(dd=s==null?void 0:s.data)==null?void 0:dd.data)==null?void 0:rd.customAddress})," "]})]}),e.jsxs("div",{className:"col-span-3 flex flex-row justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"font-semibold",children:"Grievance Document:"}),e.jsxs($,{children:[e.jsx(K,{}),e.jsx(z,{className:"sm:max-w-[500px]",children:e.jsx("div",{className:"py-4",children:(ld=(ad=s==null?void 0:s.data)==null?void 0:ad.data)!=null&&ld.imgUrl&&((nd=(cd=s==null?void 0:s.data)==null?void 0:cd.data)!=null&&nd.imgUrl.includes(".pdf"))?e.jsx("iframe",{src:(id=(td=s==null?void 0:s.data)==null?void 0:td.data)==null?void 0:id.imgUrl,width:"100%",height:"400px",title:"Document Preview"}):e.jsx(U,{src:(od=(xd=s==null?void 0:s.data)==null?void 0:xd.data)==null?void 0:od.imgUrl,className:"w-90"})})}),e.jsx(M,{asChild:!0,children:e.jsx("div",{className:"cursor-pointer",children:(jd=(hd=s==null?void 0:s.data)==null?void 0:hd.data)!=null&&jd.imgUrl&&((Nd=(ud=s==null?void 0:s.data)==null?void 0:ud.data)!=null&&Nd.imgUrl.includes(".pdf"))?e.jsx("div",{className:"flex h-20 w-20 items-center justify-center",children:e.jsx(Pr,{className:"h-20 w-20"})}):e.jsx(U,{src:(vd=(fd=s==null?void 0:s.data)==null?void 0:fd.data)==null?void 0:vd.imgUrl,className:"w-40"})})})]})]}),((gd=(md=s==null?void 0:s.data)==null?void 0:md.data)==null?void 0:gd.wf_status)===1&&Array.isArray((yd=(bd=s==null?void 0:s.data)==null?void 0:bd.data)==null?void 0:yd.resolveDocs)&&s.data.data.resolveDocs.length>0&&e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("div",{className:"font-semibold",children:"Resolve Document:"}),e.jsxs($,{children:[e.jsx(M,{asChild:!0,children:e.jsx("div",{className:"cursor-pointer",children:s.data.data.resolveDocs.map((d,o)=>typeof d=="string"&&d.endsWith(".pdf")?e.jsxs("div",{className:"flex items-center gap-2 border p-2 rounded cursor-pointer",children:[e.jsx(Pr,{className:"w-12 h-12 text-red-600"}),e.jsx("span",{className:"text-sm font-semibold",children:"PDF Document"})]},o):e.jsx(U,{src:d,className:"w-40 rounded cursor-pointer"},o))})}),e.jsxs(z,{className:"sm:max-w-[500px]",children:[e.jsx(K,{children:e.jsx(da,{className:"absolute right-4 top-4 text-red-600 hover:text-gray-900",children:e.jsx(B,{className:"w-6 h-6"})})}),e.jsx("div",{className:"py-4",children:s.data.data.resolveDocs.map((d,o)=>typeof d=="string"&&d.endsWith(".pdf")?e.jsx("div",{className:"w-full h-[500px] border rounded overflow-hidden",children:e.jsx("iframe",{src:d,className:"w-full h-full"})},o):e.jsx(U,{src:d,className:"w-90 rounded"},o))})]})]})]})]})]}),e.jsxs("section",{className:"mt-8",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-blue-800",children:["Grievance Flow History"," ",e.jsxs("span",{onClick:()=>w(!f),className:"cursor-pointer",children:[!f&&e.jsxs("span",{className:"rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-400 hover:bg-gray-200 ",children:["Show ",e.jsx(ra,{size:15,className:"inline"})]}),f&&e.jsxs("span",{className:"rounded-lg bg-gray-100 px-2 py-1 text-xs text-gray-400 hover:bg-gray-200 ",children:["Hide ",e.jsx(pa,{size:15,className:"inline"})]})]})," "]}),e.jsx("h1",{className:"text-md mb-6  flex items-center font-bold",children:e.jsxs("span",{children:["Reminder -",e.jsxs(h,{className:"ml-2 w-20 text-lg font-semibold text-white  rounded-lg  transition duration-300 shadow-md",children:[(pd=(wd=s==null?void 0:s.data)==null?void 0:wd.data)==null?void 0:pd.reminder,"Times"]})]})}),((_d=(Td=l==null?void 0:l.data)==null?void 0:Td.permission)==null?void 0:_d.canMoveComplaint)&&e.jsx(_,{onClick:Qr,children:"Move Grievance to my Panel"}),((Ed=(Id=l==null?void 0:l.data)==null?void 0:Id.permission)==null?void 0:Ed.canUpdate)&&e.jsx(Lr,{to:`/grievance/dashboard/management-complaint-form?complaintId=${(Cd=(Sd=s==null?void 0:s.data)==null?void 0:Sd.data)==null?void 0:Cd._id}`,children:e.jsx(_,{children:"Update Details"})})]}),e.jsx("div",{className:"mt-1 border-b border-[#99B37C]"}),f&&e.jsx("div",{className:"mt-4 flex flex-col space-y-4",children:(Ad=(Rd=E==null?void 0:E.data)==null?void 0:Rd.data)==null?void 0:Ad.map((d,o)=>{var b,m,p,C,R;return e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{children:o+1}),e.jsxs("div",{children:[(d==null?void 0:d.actionStatus)===0&&e.jsx(h,{className:"text-dark bg-gray-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===1&&e.jsx(h,{className:"bg-green-400 text-white",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===2&&e.jsx(h,{className:"bg-red-400 text-white",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===3&&e.jsx(h,{children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===4&&e.jsx(h,{className:"text-dark bg-amber-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===5&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===6&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===7&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===8&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===9&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===10&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===11&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),(d==null?void 0:d.actionStatus)===12&&e.jsx(h,{className:"text-dark bg-cyan-200",children:d==null?void 0:d.statusText}),e.jsx("div",{className:"mt-1 text-xs font-semibold text-gray-600",children:F((m=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:m.createdAt).format("DD-MM-YYYY hh:mm a")})]}),e.jsx(wa,{}),e.jsxs("div",{children:[e.jsxs($,{children:[e.jsx(K,{}),e.jsx(z,{className:"sm:max-w-[500px]",children:e.jsx("div",{className:"py-4",children:e.jsx(U,{src:(p=d==null?void 0:d.actionBy)==null?void 0:p.fullImgUrl,className:"w-60"})})}),e.jsx(M,{asChild:!0,children:e.jsx("div",{className:"h-10 w-10 cursor-pointer overflow-hidden rounded-full border",children:e.jsx(U,{src:((C=d==null?void 0:d.actionBy)==null?void 0:C.fullImgUrl)||$r,className:"w-10 cursor-pointer hover:scale-105"})})})]}),e.jsxs("div",{className:"text-xs text-gray-700",children:["Action by"," ",e.jsx("span",{className:"text-md font-semibold text-black",children:(d==null?void 0:d.actionByUserId)===null?"Direct Citizen":(R=d==null?void 0:d.actionBy)==null?void 0:R.fullName})]})]})]},`flow${o}`)})})]})]})})}),e.jsx(aa,{"x-chunk":"dashboard-05-chunk-3",children:e.jsxs(la,{className:"grid grid-cols-3 py-10",children:[e.jsx("div",{className:"col-span-2 pr-10",children:e.jsxs(X,{methods:H,onSubmit:Yr(Vr),children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-4",children:e.jsx("div",{className:"col-span-4",children:e.jsx(Z,{className:"w-full rounded-lg border bg-background p-4",label:"Comment",name:"comment",placeholder:"Enter comment"})})}),e.jsxs($,{open:y,children:[e.jsx(K,{}),e.jsx(z,{className:"sm:max-w-[500px]",children:e.jsxs("div",{className:"py-4",children:[x===1&&e.jsx(Ea,{setisDialogOpen:c,actionPermissions:l,complaintData:s}),x===2&&e.jsx(Ca,{setisDialogOpen:c,actionPermissions:l,complaintData:s}),x===3&&e.jsx(Ra,{setisDialogOpen:c,complaintData:s,actionPermissions:l}),x===4&&e.jsx(Aa,{setisDialogOpen:c,complaintData:s})]})}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between",children:[e.jsxs("div",{className:"mr-10",children:[((Ud=(Md=s==null?void 0:s.data)==null?void 0:Md.data)==null?void 0:Ud.wf_status)===1&&e.jsxs(O,{className:"mb-4 flex items-center",children:[e.jsx(Br,{className:"mr-2 inline text-green-500"}),"Grievance Resolved"]}),((Ld=(kd=s==null?void 0:s.data)==null?void 0:kd.data)==null?void 0:Ld.wf_status)===2&&e.jsxs(O,{className:"mb-4 flex items-center",children:[e.jsx(Ta,{className:"mr-2 inline text-red-500"}),"Grievance Rejected"]}),(((Pd=(Od=s==null?void 0:s.data)==null?void 0:Od.data)==null?void 0:Pd.wf_status)===0||((Bd=(Gd=s==null?void 0:s.data)==null?void 0:Gd.data)==null?void 0:Bd.wf_status)===3)&&e.jsxs("div",{className:"mb-4 flex items-center space-x-2",children:[e.jsx(Fr,{checked:(Wd=(Fd=s==null?void 0:s.data)==null?void 0:Fd.data)==null?void 0:Wd.isEscalated,onChange:d=>Xr(d),className:"h-5 w-5 cursor-pointer",type:"checkbox",name:"isTransactionIssue",placeholder:""}),e.jsx(J,{className:"text-amber-700 opacity-80",children:(Kd=($d=s==null?void 0:s.data)==null?void 0:$d.data)!=null&&Kd.isEscalated?"De-Escalate":"Escalate"})]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(D,{variant:"secondary",name:"comment",className:"mr-4",type:"submit",disabled:n.isPending,isLoading:n.isPending,children:"Direct Comment"})}),(((qd=(zd=s==null?void 0:s.data)==null?void 0:zd.data)==null?void 0:qd.wf_status)===0||((Yd=(Hd=s==null?void 0:s.data)==null?void 0:Hd.data)==null?void 0:Yd.wf_status)===3)&&e.jsxs(e.Fragment,{children:[((Qd=(Vd=l==null?void 0:l.data)==null?void 0:Vd.permission)==null?void 0:Qd.isNeededMoreDocuments)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{c(!0),N(1)},asChild:!0,children:e.jsx(_,{variant:"secondary",name:"bts",className:"mr-4",disabled:n.isPending,children:"Need More Documents"})})}),((Jd=(Xd=l==null?void 0:l.data)==null?void 0:Xd.permission)==null?void 0:Jd.canResolve)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{c(!0),N(1)},asChild:!0,children:e.jsx(_,{variant:"secondary",name:"bts",className:"mr-4",disabled:n.isPending,children:"Resolve"})})}),((Dd=(Zd=l==null?void 0:l.data)==null?void 0:Zd.permission)==null?void 0:Dd.canReject)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{c(!0),N(2)},asChild:!0,children:e.jsx(_,{variant:"secondary",name:"reject",className:"mr-4",disabled:n.isPending,children:"Reject"})})}),((sr=(er=l==null?void 0:l.data)==null?void 0:er.permission)==null?void 0:sr.canTransferToMember)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{c(!0),N(3)},asChild:!0,children:e.jsx(_,{name:"approve",disabled:n.isPending,className:"mr-4",children:"Transfer to Current Member"})})}),((rr=(dr=l==null?void 0:l.data)==null?void 0:dr.permission)==null?void 0:rr.canSendToUlb)&&e.jsx("div",{className:"col-span-4",children:e.jsx(M,{onClick:()=>{c(!0),N(4)},asChild:!0,children:e.jsx(_,{name:"approve",disabled:n.isPending,type:"button",className:"mr-4",children:"Transfer to Ulb"})})}),((lr=(ar=l==null?void 0:l.data)==null?void 0:ar.permission)==null?void 0:lr.canTransferToWorkflow)&&e.jsx("div",{className:"col-span-4",children:e.jsx(Lr,{to:`/grievance/dashboard/transfer-complaint?parentId=null&levelSerial=1&complaintId=${(nr=(cr=s==null?void 0:s.data)==null?void 0:cr.data)==null?void 0:nr._id}&complaintRefNo=${(ir=(tr=s==null?void 0:s.data)==null?void 0:tr.data)==null?void 0:ir.complaintRefNo}`,children:e.jsx(_,{name:"approve",disabled:n.isPending,type:"button",children:"Transfer to Workflow"})})})]})]})]})]})]})}),e.jsxs("div",{className:"col-span-1 h-80 overflow-y-scroll md:px-4",children:[e.jsx(O,{className:"mb-2",children:"Comments"}),(hr=(or=(xr=S==null?void 0:S.data)==null?void 0:xr.data)==null?void 0:or.data)==null?void 0:hr.map((d,o)=>e.jsx(_a,{commentData:d},`comment${o}`))]})]})})]})]})}function dl(){const[a,r]=I.useState(""),[g,t]=I.useState("");return e.jsx(na,{title:"Workflow Details",subTitle:"",searchLink:a,searchLabel:g,children:e.jsx("div",{className:"",children:e.jsx(Va,{setsearchLink:r,setsearchLabel:t})})})}export{dl as default};
