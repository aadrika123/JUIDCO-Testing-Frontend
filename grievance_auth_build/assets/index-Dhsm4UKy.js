import{r as d,b as U,o as W,v as q,g as I,j as e,aU as Y,aV as O,F as Z,C as T,aW as J,aX as X,Z as N,O as Q,R as y,B as E,c as D,d as g,u as ee,a1 as se,a2 as re,a3 as ae,L as V,aY as ne,aZ as ie,a_ as le,a$ as ce,b0 as oe,b1 as te,K as P,b2 as de,a4 as $,w as xe,y as me,S as ue,I as K,A as he,_ as z,M as B}from"./index-DOg5tZ0E.js";import{P as je}from"./index-BnjuEhHp.js";import{S as fe}from"./index-B83ozfU4.js";import{C as G}from"./chevron-right-9PjC2HAA.js";const pe=D().shape({module:g().required("Select module"),tempNo:g(),fixedNo:g(),isTransactionIssue:g(),transactionNo:g()});function Ne({setformStep:h,setcomplaintData:w,complaintData:a}){var f,n;const[S,v]=d.useState(!1),[j,l]=d.useState(""),[c,s]=d.useState(""),i=U({resolver:W(pe),defaultValues:{module:a==null?void 0:a.module,moduleName:a==null?void 0:a.moduleName,tempNo:a==null?void 0:a.tempNo,fixedNo:a==null?void 0:a.fixedNo,isTransactionIssue:(a==null?void 0:a.isTransactionIssue)||!1,transactionNo:a==null?void 0:a.transactionNo}}),C=async r=>{w({...a,module:r.module,moduleName:r==null?void 0:r.moduleName,tempNo:r==null?void 0:r.tempNo,fixedNo:r==null?void 0:r.fixedNo,tempNoLabel:j,fixedNoLabel:c,isTransactionIssue:r==null?void 0:r.isTransactionIssue,transactionNo:r==null?void 0:r.transactionNo}),h(3)},b=q({api:`${I.getAllModuleDirect}?page=1&limit=10000`,key:"getAllModuleDirect",options:{enabled:!0,refetchOnMount:!1}});return d.useEffect(()=>{var r,p;if(i.watch("module")){const[x]=(p=(r=b.data)==null?void 0:r.data)==null?void 0:p.filter(u=>(u==null?void 0:u._id)===(i==null?void 0:i.watch("module")));s(x==null?void 0:x.fixedNoLabel),l(x==null?void 0:x.tempNoLabel)}},[i.watch("module")]),d.useEffect(()=>{v(i.watch("isTransactionIssue"))},[i.watch("isTransactionIssue")]),e.jsxs(Y,{children:[e.jsx(O,{className:"w-80 border border-indigo-600",children:e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium leading-none",children:"Service"}),e.jsx("div",{className:"flex  space-x-4",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Serivce is the government service for which you are registering complaint, eg: Holding, Water, Trade and choose others for other category."})})]})})}),e.jsx(Z,{methods:i,onSubmit:i.handleSubmit(C),children:e.jsxs("div",{className:"gap-x-2 gap-y-4 px-10 py-10",children:[e.jsxs("div",{children:[e.jsxs(T,{className:"text-2xl mb-10 flex items-center font-bold",children:["Service Information",e.jsx(J,{asChild:!0,children:e.jsx(X,{size:20,className:"inline cursor-pointer ml-4"})})]}),e.jsxs("div",{children:[e.jsxs(N,{children:[e.jsx("span",{className:"text-red-500",children:"*"}),"Select Service"]}),e.jsx(Q,{selectedText:"moduleName",className:"bg-background cursor-pointer",name:"module",data:((n=(f=b.data)==null?void 0:f.data)==null?void 0:n.map(r=>({value:r==null?void 0:r._id,label:r==null?void 0:r.moduleName})))??[]})]}),c&&e.jsxs("div",{className:"mt-4",children:[e.jsxs(N,{children:[c,e.jsx("span",{className:"text-xs opacity-80"})]}),e.jsx(y,{name:"fixedNo",placeholder:""})]}),j&&e.jsxs("div",{className:"mt-4",children:[e.jsxs(N,{children:[j,e.jsx("span",{className:"text-xs opacity-80"})]}),e.jsx(y,{name:"tempNo",placeholder:""})]}),e.jsxs("div",{className:"mt-6 flex items-center space-x-2",children:[e.jsx(y,{className:"cursor-pointer h-5 w-5",type:"checkbox",name:"isTransactionIssue",placeholder:""}),e.jsx(N,{className:"text-amber-600 opacity-80",children:"Is issue related with financial transaction"})]}),S&&e.jsxs("div",{className:"mt-4",children:[e.jsx(N,{children:"Transaction No."}),e.jsx(y,{name:"transactionNo",placeholder:""})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(E,{isLoading:i.formState.isSubmitting,type:"submit",className:" w-full",children:"Next"})})]})})]})}function ge(){var p,x,u,F,k,R,A,L,M;const[h,w]=d.useState(1),[a,S]=d.useState(10),[v,j]=d.useState(""),[l,c]=d.useState(0),[s,i]=d.useState({}),[C,b]=d.useState({}),f=ee({}),n=q({api:`${I.getAllComplaintDirect}?page=${h}&limit=${a}&q=${v}`,key:"SeachCitizenComplaints",value:[h,a],options:{enabled:!0}}),r=async()=>{var o,H,_;try{const t=new FormData;t.append("citizenName",s==null?void 0:s.name),t.append("email",s==null?void 0:s.email),t.append("mobileNo",s==null?void 0:s.mobileNo),t.append("complaintTitle",s==null?void 0:s.complaintTitle),t.append("complaintDescription",s==null?void 0:s.complaintDescription),t.append("moduleId",s==null?void 0:s.module),t.append("ulbId",s==null?void 0:s.ulb),t.append("imageUrl",s==null?void 0:s.complaintDocument);const m=await f.mutateAsync({api:I.createComplaintApplication,data:t});(o=m.data)!=null&&o.success?(b((H=m==null?void 0:m.data)==null?void 0:H.data),i({}),z.success((_=m==null?void 0:m.data)==null?void 0:_.message),c(6)):z.error("Grievance not created successfully")}catch(t){console.log(t)}};return e.jsxs(se,{children:[e.jsx(re,{}),e.jsxs(ae,{className:"sm:max-w-[500px] z-50",children:[e.jsxs(T,{className:"mt-4 text-xl text-gray-500 font-bold flex justify-between",children:["Complaint Registration ",e.jsx(V,{to:"/grievance/citizen/complaint-registration-info",target:"_blank",children:e.jsx("span",{className:"text-amber-600 underline cursor-pointer",children:"Know How it works?"})})," "]}),e.jsxs("div",{className:"py-4",children:[l<5&&e.jsx(ne,{status:l-1}),l===1&&e.jsx(ie,{setcomplaintData:i,complaintData:s,setformStep:c}),l===2&&e.jsx(Ne,{setcomplaintData:i,complaintData:s,setformStep:c}),l===3&&e.jsx(le,{setcomplaintData:i,complaintData:s,setformStep:c}),l===4&&e.jsx(ce,{setcomplaintData:i,complaintData:s,setformStep:c}),l===5&&e.jsx(oe,{complaintData:s}),l===6&&e.jsx(te,{formResponse:C}),l===5&&e.jsx("div",{className:"px-10 mb-5",children:e.jsx(E,{isLoading:f.isPending,onClick:r,className:"w-full flex justify-center items-center",children:e.jsx("span",{className:"text-xs",children:"Submit"})})}),l<6&&l>1&&e.jsx("div",{className:"px-10",children:e.jsxs(P,{onClick:()=>c(l-1),variant:"outline",className:"w-full flex justify-center items-center",children:[e.jsx(de,{size:20,className:"inline mr-2"})," ",e.jsx("span",{className:"text-xs",children:"Go Back"})]})})]})]}),e.jsx("main",{className:"grid items-start",children:e.jsxs("div",{className:"grid auto-rows-max items-start gap-4",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(fe,{search:v,setSearch:j,refetch:n.refetch,isFetching:n.isLoading})}),e.jsx("div",{children:e.jsx($,{onClick:()=>c(1),asChild:!0,children:e.jsxs(P,{className:"flex justify-center items-center",children:[e.jsx("span",{className:"text-xs",children:"Register Custom Complaint"}),e.jsx(G,{size:15,className:"inline"})]})})})]}),e.jsx(xe,{className:"shadow-none border-none rounded-none",children:e.jsx(me,{children:n.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ue,{})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col justify-center w-full px-4",children:(u=(x=(p=n==null?void 0:n.data)==null?void 0:p.data)==null?void 0:x.docs)==null?void 0:u.map(o=>e.jsxs("div",{className:"w-full px-8 py-2 bg-white rounded-md shadow-lg mb-2 relative",children:[e.jsxs("div",{className:"flex mt-6  pr-10",children:[e.jsx(K,{className:"flex-initial object-cover mx-2 rounded-full w-14 h-14",src:"https://images.unsplash.com/photo-1488508872907-592763824245?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80"}),e.jsxs("div",{className:"mx-2 flex-1",children:[e.jsx("h1",{className:"font-semibold text-gray-800 dark:text-white",children:o==null?void 0:o.titleName}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:o==null?void 0:o.description})]})]}),e.jsx($,{onClick:()=>c(1),asChild:!0,children:e.jsxs(P,{className:"absolute right-0 bottom-0 flex justify-center items-center",variant:"secondary",children:[e.jsx("span",{className:"text-xs",children:"Register"}),e.jsx(G,{size:15,className:"inline"})]})})]},`complaint${o==null?void 0:o._id}`))}),e.jsx(he,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(je,{page:h,perPage:a,totalPage:(k=(F=n==null?void 0:n.data)==null?void 0:F.data)==null?void 0:k.totalDocs,hasNextPage:(A=(R=n==null?void 0:n.data)==null?void 0:R.data)==null?void 0:A.hasNextPage,hasPrevPage:(M=(L=n==null?void 0:n.data)==null?void 0:L.data)==null?void 0:M.hasPrevPage,setPage:w,setPerPage:S})})]})})})]})})]})}function Se(){return e.jsxs("div",{className:"grid grid-cols-4 h-screen",children:[e.jsxs("div",{className:"col-span-4 md:col-span-1 flex items-center flex-col md:px-10 mt-10 space-y-4 h-screen overflow-hidden",children:[e.jsx(T,{className:"text-xl text-primary font-bold",children:"Search existing Grievance or Register custom grievance"}),e.jsx(K,{src:"/images/complain_boy.png",className:"w-40"}),e.jsx(B,{className:"text-center",children:"Fill the form to process your complaint."}),e.jsxs(B,{className:"text-center",children:["You can register your grievance here or you can visit our nearest ",e.jsx(V,{target:"_blank",className:"underline hover:text-primary",to:"https://maps.app.goo.gl/ncVp959LoSja4uAh8",children:"Jan Seva Kendra"})," for further query. & Feel free to contact us on +918458697845"]})]}),e.jsx("div",{className:"col-span-4 md:col-span-3 p-10 bg-gray-50 h-screen",children:e.jsx(ge,{})})]})}export{Se as default};
