import{u as N,r as c,a as R,b as M,o as C,j as e,D as B,B as y,F as H,R as T,c as O,d as k,l as z,_ as t,s as $,g as Y}from"./index-Di_aGywo.js";import{g as S}from"./services-KQnp_8oA.js";import{R as D}from"./RHFPasswordField-C9QCZ3LB.js";function G(){let o=window.localStorage.getItem("token"),d=window.localStorage.getItem("roleId");return{timeout:6e4,headers:{Authorization:`Bearer ${o}`,Accept:"application/json","Content-Type":"application/json","API-KEY":"eff41ef6-d430-4887-aa55-9fcf46c72c99","role-id":d}}}const J=O({email:k().required(),password:k().min(3)});function U(){const o=N({}),d=N({}),[g,m]=c.useState(!1),[u,f]=c.useState(!1),[A,P]=c.useState(!1),[p,E]=c.useState(""),{login:L}=R(),j=new URLSearchParams(location.search).get("msg")||"",x=M({defaultValues:{email:"",password:""},resolver:C(J)});console.log(A);const F=async r=>{var i,n,a,w,v;console.log("data",r);try{const s=await o.mutateAsync({api:z,data:{...r,moduleId:22},headers:G()});if((i=s==null?void 0:s.data)!=null&&i.status){const h=(a=(n=s==null?void 0:s.data)==null?void 0:n.data)==null?void 0:a.token;if(!h)throw new Error("Token not received from server");await L(s),localStorage.setItem("token",h),t.success((w=s==null?void 0:s.data)==null?void 0:w.message);try{const l=await(await fetch($,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({moduleId:22})})).json();console.log("Menu Data:",l),l!=null&&l.status?localStorage.setItem("menu",JSON.stringify(l==null?void 0:l.data)):t.error((l==null?void 0:l.message)||"Failed to fetch menu")}catch(b){console.error("Error fetching menu:",b),t.error("Failed to fetch menu")}}else t.error((v=s==null?void 0:s.data)==null?void 0:v.message)}catch(s){console.error("Login Error:",s),t.error(S((s==null?void 0:s.message)||"Login failed"))}},I=async()=>{var r,i,n;f(!0);try{const a=await d.mutateAsync({api:Y.forgetPassword,data:{email:p}});(r=a==null?void 0:a.data)!=null&&r.success?(m(!1),t.success((i=a==null?void 0:a.data)==null?void 0:i.message),f(!1)):t.error((n=a==null?void 0:a.data)==null?void 0:n.message)}catch(a){t.error(S(a.message))}};return e.jsxs(e.Fragment,{children:[e.jsx(B,{open:g,setOpen:m,title:"Reset Your Password",setEdit:P,children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[e.jsx("input",{value:p,onChange:r=>E(r.target.value),type:"text",placeholder:"Your email address",className:"input-field w-full border border-gray-300 rounded-md p-1.5"}),e.jsx("div",{children:e.jsx(y,{type:"button",onClick:I,disabled:u,className:"w-full rounded-xl py-5 px-4 mt-4 shadow-none",variant:"outline",children:u?"Sending...":"Send"})})]})})}),e.jsx("header",{className:" h-[7vh] w-full border-b border-gray-200 bg-white darks:bg-gray-800 darks:border-gray-800",children:e.jsx("div",{className:"container mx-auto xl:max-w-6xl ",children:e.jsx("nav",{className:" ",id:"desktop-menu",children:e.jsx("a",{className:"",href:"",children:e.jsxs("div",{className:"mt-6",children:[" ",e.jsx("span",{className:"font-bold text-xl uppercase",children:"Login - Grievance Management System"})]})})})})}),j&&e.jsxs("div",{className:"w-full h-8 bg-red-600 flex justify-center items-center text-white text-lg p-3",children:[e.jsx("span",{className:"font-semibold",children:"⚠️ Permission Denied"})," -"," ",j]}),e.jsx("main",{className:"h-[80vh] bg-gray-100 flex justify-center items-center",children:e.jsx("div",{className:" bg-gray-100 darks:bg-gray-900 darks:bg-opacity-40",children:e.jsx("div",{className:"container mx-auto px-4 xl:max-w-6xl ",children:e.jsxs("div",{className:"flex flex-wrap -mx-4 flex-row ",children:[e.jsx("div",{className:"flex-shrink max-w-full px-4 w-full lg:w-1/2 ",children:e.jsx("div",{className:"max-w-full w-full px-2 sm:px-12 lg:pr-20 mb-12 lg:mb-0  ",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"p-6 sm:py-8 sm:px-12 rounded-lg bg-white darks:bg-gray-800 shadow-xl",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("h1",{className:"text-2xl leading-normal  font-bold text-gray-800 darks:text-gray-300 text-center mb-",children:"Welcome Back"}),e.jsx("div",{className:"flex justify-center items-center ",children:e.jsx("div",{className:"border-b w-10 border border-black mb-7"})})]}),e.jsx(H,{methods:x,onSubmit:x.handleSubmit(F),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(T,{className:" py-5 px-5 w-full bg-background",name:"email",inputValidation:["removeSpace"],placeholder:"Enter your email"})}),e.jsx("div",{className:"space-y-2",children:e.jsx(D,{className:"py-5 px-5 w-full bg-background",name:"password",placeholder:"Enter your password"})}),e.jsx("div",{children:e.jsxs(y,{type:"submit",isLoading:x.formState.isSubmitting,className:"w-full  py-5 px-4 mt-2 shadow-none",children:[e.jsxs("svg",{xmlnsXlink:"http://www.w3.org/2000/svg",fill:"currentColor",className:"inline-block w-4 h-4 mr-1 ltr:mr-2 rtl:ml-2 bi bi-box-arrow-in-right",viewBox:"0 0 16 16",children:[e.jsx("path",{fillRule:"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),e.jsx("path",{fillRule:"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})]}),"Login"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("hr",{className:"flex-1"}),e.jsx("span",{children:"or"}),e.jsx("hr",{className:"flex-1"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"text-sm text-primary",type:"button",onClick:()=>m(!0),children:"Forgot password?"})})]})})]})})})}),e.jsx("div",{className:"flex-shrink max-w-full px-4 w-full lg:w-1/2",children:e.jsxs("div",{className:"text-center mt-6 lg:mt-0",children:[e.jsx("img",{src:"/images/mob.png",alt:"welcome",className:"h-68 rounded-lg"}),e.jsxs("div",{className:"px-4 mt-4",children:[e.jsx("h1",{className:"font-semibold text-2xl",children:"Manage Grievance with Ease of Access"}),e.jsx("p",{className:"text-base mb-4 text-gray-500",children:"Easily manage greivance applications with simplified workflows."})]})]})})]})})})}),e.jsx("footer",{className:" h-[10vh] w-full bg-white py-6 border-t border-gray-200 darks:bg-gray-800 darks:border-gray-800",children:e.jsx("div",{className:"container mx-auto px-4 xl:max-w-6xl w-full",children:e.jsx("div",{className:"mx-auto px-4",children:e.jsxs("div",{className:"flex flex-wrap flex-row -mx-4",children:[e.jsx("div",{className:"flex-shrink max-w-full px-4 w-full md:w-1/2 text-center md:ltr:text-left md:rtl:text-right",children:e.jsxs("ul",{className:"ltr:pl-0 rtl:pr-0 space-x-4",children:[e.jsx("li",{className:"inline-block ltr:mr-3 rtl:ml-3",children:e.jsx("a",{className:"hover:text-indigo-500",href:"#",children:"Support |"})}),e.jsx("li",{className:"inline-block ltr:mr-3 rtl:ml-3",children:e.jsx("a",{className:"hover:text-indigo-500",href:"#",children:"Help Center |"})}),e.jsx("li",{className:"inline-block ltr:mr-3 rtl:ml-3",children:e.jsx("a",{className:"hover:text-indigo-500",href:"#",children:"Privacy |"})}),e.jsx("li",{className:"inline-block ltr:mr-3 rtl:ml-3",children:e.jsx("a",{className:"hover:text-indigo-500",href:"#",children:"Terms of Service"})})]})}),e.jsx("div",{className:"flex-shrink max-w-full px-4 w-full md:w-1/2 text-center md:ltr:text-right md:rtl:text-left",children:e.jsxs("p",{className:"mb-0 mt-3 md:mt-0",children:[e.jsx("a",{href:"#",className:"hover:text-indigo-500",children:"UD&HD"})," | All right reserved"]})})]})})})})]})}function W(){return e.jsx("div",{className:"",children:e.jsx(U,{})})}export{W as default};
