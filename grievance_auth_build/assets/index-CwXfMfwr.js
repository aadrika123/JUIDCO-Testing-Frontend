import{u as U,G as J,v as V,g as P,b as O,o as Q,r as o,j as e,D as W,F as X,R as Z,H as ee,A as K,B as se,c as ae,d as D,_ as d,J as te,K as ie,w as ne,x as de,M as ce,y as re,S as le,z as oe}from"./index-DOg5tZ0E.js";import{P as me}from"./index-CgOOQbWr.js";import{T as ue,a as he,b as G,c as f,d as xe,e as N}from"./table-DEeRP3-S.js";import{g as pe}from"./services-KQnp_8oA.js";import{P as ge}from"./index-BnjuEhHp.js";import{S as je}from"./index-B83ozfU4.js";import{q as fe}from"./switch-DKSODox6.js";const Ne=ae().shape({roleName:D().required("Role name is required"),description:D().required("Description is required")});function ye({open:m,setOpen:u,title:R,id:c,edit:r,setEdit:y,refetch:v}){const w=U({}),b=J({}),{data:l,isFetching:S}=V({api:`${P.getRoleById}/${c}`,key:"getRoleById",options:{enabled:r}}),n=O({defaultValues:{roleName:"",description:""},resolver:Q(Ne)}),a=async h=>{var x,p,g,j;try{if(r&&h){const t=await b.mutateAsync({api:`${P.updateRole}/${c}`,data:h});(x=t.data)!=null&&x.success?d.success((p=t==null?void 0:t.data)==null?void 0:p.message):d.error("Role not updated successfully")}else{const t=await w.mutateAsync({api:P.createRole,data:h});(g=t.data)!=null&&g.success?d.success((j=t==null?void 0:t.data)==null?void 0:j.message):d.error("Role not created successfully"),n.reset({roleName:""})}u(!1),y(!1),v()}catch(t){console.log(t)}};return o.useEffect(()=>{r&&l?n.reset({roleName:l.data.roleName,description:l.data.description}):n.reset({roleName:"",description:""})},[r,l]),e.jsx(W,{open:m,setOpen:u,title:R,setEdit:y,edit:r,isLoading:S,children:e.jsx(X,{methods:n,onSubmit:n.handleSubmit(a),children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[e.jsx("div",{children:e.jsx(Z,{name:"roleName",placeholder:"Enter your role name"})}),e.jsx("div",{children:e.jsx(ee,{name:"description",placeholder:"Enter your description"})}),e.jsx(K,{}),e.jsx("div",{children:e.jsx(se,{isLoading:n.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function be(){var x,p,g,j,t,A,T,C,F,$,M;const[m,u]=o.useState(1),R=J({}),[c,r]=o.useState(10),[y,v]=o.useState(""),[w,b]=o.useState(!1),[l]=o.useState(""),[S,n]=o.useState(!1),a=te({api:"",key:"getAllRole",value:[m,c],options:{enabled:!0}}),h=async(s,B)=>{var E,H,_,k,q,L,I,Y,z;try{const i=await R.mutateAsync({api:`${(E=P)==null?void 0:E.updateRoleStatus}/${s}`,data:{id:l}});(H=i==null?void 0:i.data)!=null&&H.success?(a.refetch(),((k=(_=i==null?void 0:i.data)==null?void 0:_.data)==null?void 0:k.status)==1&&d.success((q=i.data)==null?void 0:q.message),((I=(L=i==null?void 0:i.data)==null?void 0:L.data)==null?void 0:I.status)==0&&d.error((Y=i.data)==null?void 0:Y.message)):d.error((z=i.data)==null?void 0:z.message)}catch(i){d.error(pe(i))}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx(ye,{open:w,setOpen:b,title:S?"Edit Role":"Add Role",id:l,edit:S,setEdit:n,refetch:a.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(je,{search:y,setSearch:v,setPage:u,refetch:a.refetch,isFetching:a.isLoading})}),e.jsx("div",{children:e.jsx(ie,{className:"flex items-center gap-2",onClick:()=>b(!0),children:"Add New"})})]}),e.jsxs(ne,{children:[e.jsx(de,{className:"px-7",children:e.jsxs(ce,{children:["Role List (",(p=(x=a.data)==null?void 0:x.data)==null?void 0:p.totalDocs,")"]})}),e.jsx(re,{children:a.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(le,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(he,{children:e.jsxs(G,{children:[e.jsx(f,{className:"",children:"#"}),e.jsx(f,{className:"",children:"Role Name"}),e.jsx(f,{className:"",children:"Id"}),e.jsx(f,{className:"",children:"Created at"}),e.jsx(f,{className:"",children:"Status"})]})}),e.jsx(xe,{children:(t=(j=(g=a==null?void 0:a.data)==null?void 0:g.data)==null?void 0:j.docs)==null?void 0:t.map((s,B)=>e.jsxs(G,{children:[e.jsx(N,{children:m*c-c+B+1}),e.jsx(N,{children:s==null?void 0:s.role_name}),e.jsx(N,{children:s==null?void 0:s.id}),e.jsx(N,{children:oe(s==null?void 0:s.createdAt).format("DD-MM-YYYY")}),e.jsx(N,{children:e.jsxs(fe,{checked:!(s!=null&&s.is_suspended),onChange:()=>h(s.id,!s.is_suspended),className:`${s!=null&&s.is_suspended?"bg-gray-200":"bg-primary"} relative inline-flex items-center h-6 rounded-full w-11`,children:[e.jsx("span",{className:"sr-only",children:"Toggle Status"}),e.jsx("span",{className:`${s!=null&&s.is_suspended?"translate-x-1":"translate-x-6"} inline-block w-4 h-4 transform bg-white rounded-full`})]})})]},s==null?void 0:s.id))})]}),e.jsx(K,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(ge,{page:m,perPage:c,totalPage:(T=(A=a==null?void 0:a.data)==null?void 0:A.data)==null?void 0:T.totalDocs,hasNextPage:(F=(C=a==null?void 0:a.data)==null?void 0:C.data)==null?void 0:F.hasNextPage,hasPrevPage:(M=($=a==null?void 0:a.data)==null?void 0:$.data)==null?void 0:M.hasPrevPage,setPage:u,setPerPage:r})})]})})]})]})]})}function Ce(){return e.jsx(me,{title:"Role",subTitle:"Manage all the roles here",children:e.jsx("div",{children:e.jsx(be,{})})})}export{Ce as default};
