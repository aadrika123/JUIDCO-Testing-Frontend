import{l as d,x as z,v as C,m as O,H as Q,W as G,q as p,y as J,z as g,B as K,h as b,k as a,o as f,j as e,D as X,Q as P}from"./index-e0cf29e0.js";const ee=()=>{var k,M,A;const[r,Y]=d.useState(),[S,m]=d.useState(!1),[c,D]=d.useState(),[w,U]=d.useState(),{notify:y}=d.useContext(z),[l,N]=d.useState(),[x,E]=d.useState(),[h,F]=d.useState(),{id:i}=C(),R=O();Q("Water Demand Payment");const{api_waterApprovedApplicationDetails:L,api_waterListDemand:V,api_waterDemandCalculation:W,api_waterDemandPayment:B,header:u}=G();d.useEffect(()=>{I(),_()},[i]),d.useEffect(()=>{T()},[h,x]);const T=()=>{if(h==""||x=="")return N();m(!0);const t={consumerId:i,demandFrom:x,demandUpto:h};p.post(W,t,u).then(function(s){console.log("water demand calculation Details",s.data.data),N(s.data.data),m(!1)}).catch(function(s){console.log("Error : water calculating demand",s),m(!1)})},I=()=>{m(!0),p.post(L,{id:i},u).then(function(t){console.log("water Approved Application Details",t.data.data),Y(t.data.data),m(!1)}).catch(function(t){console.log("Error : water Approved Application Details",t),m(!1)})},_=()=>{p.post(V,{ConsumerId:i},u).then(t=>{console.log("Fetched Water Demand List",t.data.data),D(t.data.data)}).catch(t=>{console.log("Exception while fetching Water Demand",t)})},j=t=>{const s={consumerId:i,demandFrom:x,demandUpto:h,amount:l==null?void 0:l.totalPayAmount,paymentMode:t.paymentMode,remarks:t.remarks,chequeDate:t.cheque_dd_date,bankName:t.bankName,branchName:t.branchName,chequeNo:t.cheque_dd_no};console.log("final submit",s),p.post(B,s,u).then(n=>{var q;n.data.status?(_(),console.log("Demand Paid Successfully",n),y("Demand Paid Successfully","success"),R(`/waterViewPaymentHistory/${i}`)):(console.log("Failed to paid Demand.",n),y((q=n==null?void 0:n.data)==null?void 0:q.message,"error"))}).catch(n=>{console.log("Exception while Demand payment",n),y("Error while Demand payment","error")})},H=J({monthFrom:g().required("Require Field"),monthUpto:g().required("Require Field"),remarks:g().required("Require Field"),paymentMode:g().required("Require Field")}),o=K({enableReinitialize:!0,initialValues:{monthFrom:"",monthUpto:"",penalty:"",rebate:"",advanced:"",paymentMode:"",remarks:"",bankName:"",branchName:"",cheque_dd_no:"",cheque_dd_date:""},onSubmit:(t,s)=>{j(t)},validationSchema:H}),$=t=>{let s=t.target.name,n=t.target.value;s=="paymentMode"&&U(n),s=="monthFrom"&&E(n),s=="monthUpto"&&F(n),s=="paymentMode"&&(o.setFieldValue("bankName",""),o.setFieldValue("branchName",""),o.setFieldValue("cheque_dd_no",""),o.setFieldValue("cheque_dd_date",""))},v=(k=c==null?void 0:c.consumerDemands)==null?void 0:k.filter(t=>b(t.demand_upto,"YYYY-MM-DD").format("yy-MM").toString()>=b(x,"YYYY-MM-DD").format("yy-MM"));return a(f,{children:[S&&e(X,{}),e("div",{className:"grid grid-cols-1 md:grid-cols-12 lg:grid-cols-12 gap-2 container mx-auto w-full",children:a("div",{className:"col-span-12 rounded-lg p-4",children:[e("div",{className:"p-4 max-sm:p-0",children:a("div",{className:"",children:[a("h1",{className:"px-1 font-semibold font-serif  text-gray-500",children:[e(P,{className:"inline"})," Basic Details"]}),e("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl p-4",children:a("div",{className:"flex max-sm:flex-col space-x-5 max-sm:space-x-0 max-sm:space-y-2 pl-4 max-sm:pl-0 ",children:[a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-sm",children:r!=null&&r.ulb_name?r==null?void 0:r.ulb_name:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"ULB Name"})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:r!=null&&r.ward_name?r==null?void 0:r.ward_name:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Ward No."})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:r!=null&&r.consumer_no?r==null?void 0:r.consumer_no:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Consumer No"})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-bold text-sm",children:r!=null&&r.connection_through?r==null?void 0:r.connection_through:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Connection Through"})]}),(r==null?void 0:r.connection_through)=="SAF"?a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-md",children:r!=null&&r.saf_no?r==null?void 0:r.saf_no:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"SAF No"})]}):a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-md",children:r!=null&&r.holding_no?r==null?void 0:r.holding_no:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Holding No"})]}),a("div",{className:"flex-1",children:[e("div",{className:"font-semibold text-md",children:r!=null&&r.owner_char_type?r==null?void 0:r.owner_char_type:"N/A"}),e("div",{className:"text-gray-500 text-xs",children:"Ownership Type"})]})]})})]})}),e(f,{children:a("div",{className:"mt-5 p-4 max-sm:p-0",children:[a("h1",{className:"px-1 font-semibold font-serif text-gray-500",children:[e(P,{className:"inline"}),"Due Demand Details"]}),e("div",{className:"overflow-auto",children:a("table",{className:"min-w-full leading-normal mt-2 bg-white rounded-lg shadow-xl p-4 max-sm:p-0",children:[e("thead",{className:"font-bold text-left text-sm border text-gray-800 bg-white",children:a("tr",{children:[e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"#"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand From"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Upto"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Demand Amount"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Penalty"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Connection Type"}),e("th",{className:"px-2 py-3 border-b border-gray-200  text-xs uppercase text-left",children:"Payable Amount "})]})}),e("tbody",{className:"text-sm",children:e(f,{children:(M=c==null?void 0:c.consumerDemands)==null?void 0:M.map((t,s)=>a("tr",{className:"bg-white shadow-xl border-b border-gray-200",children:[e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:s+1}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.demand_from?b(t==null?void 0:t.demand_from,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.demand_upto?b(t==null?void 0:t.demand_upto,"YYYY-MM-DD").format("DD-MMM-yy"):"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.balance_amount?t==null?void 0:t.balance_amount:"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.penalty?t==null?void 0:t.penalty:"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.connection_type?t==null?void 0:t.connection_type:"N/A"}),e("td",{className:"px-2 py-2 text-left text-gray-500 text-xs",children:t!=null&&t.amount?"â‚¹ "+(t==null?void 0:t.amount):"N/A"})]}))})})]})})]})}),e("div",{className:"col-span-12 rounded-lg p-4 max-sm:p-0",children:e("div",{className:"py-6 mt-2 bg-white rounded-lg shadow-xl border border-y-gray-200 p-4",children:e("form",{onSubmit:o.handleSubmit,onChange:$,className:"p-4 relative",children:a("div",{className:"grid grid-cols-12",children:[a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month From"]}),a("select",{...o.getFieldProps("monthFrom"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),(A=c==null?void 0:c.consumerDemands)==null?void 0:A.map((t,s)=>e("option",{value:t.demand_from,children:b(t.demand_from,"YYYY-MM-DD").format("MMM-yy")},s))]}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthFrom&&o.errors.monthFrom?o.errors.monthFrom:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Select Month Upto"]}),a("select",{...o.getFieldProps("monthUpto"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),v==null?void 0:v.map((t,s)=>e("option",{value:t.demand_upto,children:b(t.demand_upto,"YYYY-MM-DD").format("MMM-yy")},s))]}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.monthUpto&&o.errors.monthUpto?o.errors.monthUpto:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Total Demand"}),e("input",{...o.getFieldProps("amount"),value:(l==null?void 0:l.totalDemand)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.amount&&o.errors.amount?o.errors.amount:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Penalty"}),e("input",{...o.getFieldProps("penalty"),value:(l==null?void 0:l.totalPenalty)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.penalty&&o.errors.penalty?o.errors.penalty:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Rebate"}),e("input",{...o.getFieldProps("rebate"),value:(l==null?void 0:l.totalRebate)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.rebate&&o.errors.rebate?o.errors.rebate:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Advanced"}),e("input",{...o.getFieldProps("advanced"),value:(l==null?void 0:l.totalAdvance)||0,disabled:!0,type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md bg-slate-200"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.advanced&&o.errors.advanced?o.errors.advanced:null})]}),e("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:a("p",{children:["Remain Advance : ",e("span",{className:"text-orange-700 font-semibold",children:(l==null?void 0:l.remaningAdvanceAmount)||0})]})}),e("div",{className:"form-group mb-4 col-span-12 md:col-span-6 md:px-4",children:a("p",{children:[" Payable Amount : ",e("span",{className:"text-green-700 font-semibold",children:l!=null&&l.totalPayAmount?"â‚¹"+(l==null?void 0:l.totalPayAmount):0})]})}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Payment Mode"]}),a("select",{...o.getFieldProps("paymentMode"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",children:[e("option",{value:"",children:"Select"}),e("option",{value:"Cash",children:"Cash"}),e("option",{value:"Cheque",children:"Cheque"}),e("option",{value:"DD",children:"DD"})]}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.paymentMode&&o.errors.paymentMode?o.errors.paymentMode:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Remarks"]}),e("input",{...o.getFieldProps("remarks"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.remarks&&o.errors.remarks?o.errors.remarks:null})]}),(w=="Cheque"||w=="DD")&&a(f,{children:[a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Bank Name"]}),e("input",{...o.getFieldProps("bankName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.bankName&&o.errors.bankName?o.errors.bankName:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Branch Name"]}),e("input",{...o.getFieldProps("branchName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.branchName&&o.errors.branchName?o.errors.branchName:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD No"]}),e("input",{...o.getFieldProps("cheque_dd_no"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md"}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.cheque_dd_no&&o.errors.cheque_dd_no?o.errors.cheque_dd_no:null})]}),a("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[a("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD Date"]}),e("input",{...o.getFieldProps("cheque_dd_date"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter new ward no."}),e("span",{className:"text-red-600 absolute text-xs",children:o.touched.cheque_dd_date&&o.errors.cheque_dd_date?o.errors.cheque_dd_date:null})]})]}),e("div",{className:"col-span-12"}),a("div",{className:"col-span-12 grid grid-cols-2 mt-10",children:[e("div",{className:""}),e("div",{className:"md:pl-10 text-right",children:e("button",{type:"submit",className:" px-6 py-2.5 bg-green-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out cursor-pointer",children:"Pay Now"})})]})]})})})})]})})]})};export{ee as default};
