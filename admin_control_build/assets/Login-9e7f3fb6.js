import{r as g,c as q,u as F,g as j,j as e,s as M,a as h,n as c}from"./index-17e4d78a.js";import{c as I,a as k,u as P,A as N,b as R,d as B}from"./PowerupFunctions-8fd96464.js";import{R as C}from"./Hourglass-b82bf097.js";import{P as V}from"./ProjectApiList-ba47d93b.js";const{api_login:U,api_getFreeMenuList:z}=V(),H=I({username:k().required("Enter Username"),password:k().required("Enter Password")});function J(){const{setmenuList:L,setuserDetails:S,setheartBeatCounter:p}=g.useContext(q),[A,l]=g.useState(!1),r=P({initialValues:{username:"",password:""},onSubmit:u=>{E()},validationSchema:H}),f=F();g.useEffect(()=>{j("token")!="null"&&j("token")!=null&&f("/home")},[]);const D={headers:{Accept:"application/json"}},E=u=>{l(!0);let a={email:r.values.username,password:r.values.password};console.log("--1--before login send...",a),N.post(U,a,D).then(function(t){var s,i,o,d,n;console.log("message check login ",t.data),t.data.status==!0?(M("token",(i=(s=t==null?void 0:t.data)==null?void 0:s.data)==null?void 0:i.token),h("userDetails",(d=(o=t==null?void 0:t.data)==null?void 0:o.data)==null?void 0:d.userDetails),_(),p(m=>m+1),f("/home"),c.success("Login Successfull")):(console.log("false..."),l(!1),c.error((n=t==null?void 0:t.data)==null?void 0:n.message))}).catch(function(t){l(!1),console.log("--2--login error...",t),c.error("Server Error")})},_=()=>{let u={moduleId:1};console.log("request body",u),N.post(z,u,R()).then(function(a){var t,s,i,o,d,n,m,x,b,w,v,y;console.log("fetched menu list.....",(i=(s=(t=a==null?void 0:a.data)==null?void 0:t.data)==null?void 0:s.userDetails)==null?void 0:i.roles),a.data.status==!0?(h("menuList",(d=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:d.permission),h("userDetails",(m=(n=a==null?void 0:a.data)==null?void 0:n.data)==null?void 0:m.userDetails),L((b=(x=a==null?void 0:a.data)==null?void 0:x.data)==null?void 0:b.permission),S((v=(w=a==null?void 0:a.data)==null?void 0:w.data)==null?void 0:v.userDetails)):(console.log("false..."),l(!1),seterrorMsg(B(a.data.message)),c.error((y=a==null?void 0:a.data)==null?void 0:y.message))}).catch(function(a){l(!1),seterroState(!0),console.log("--2--login error...",a),c.error("Server Error (Menu List)")})};return e.jsx(e.Fragment,{children:e.jsx("main",{className:"border h-[100vh] w-screen bg-gray-100 flex justify-center items-center p-4",children:e.jsxs("form",{onSubmit:r.handleSubmit,className:" p-4 md:p-10 py-10 md:py-16 bg-white shadow-lg w-full md:w-[25vw] animate__animated animate__slideInDown animate__faster",children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-2xl leading-normal mb-3 font-bold text-gray-800 darks:text-gray-300 text-center",children:"Admin Login"})}),e.jsx("hr",{className:"block w-12 h-0.5 mx-auto my-5 bg-gray-700 border-gray-700"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"inputemail",className:"inline-block mb-2",children:"Username"}),e.jsx("input",{...r.getFieldProps("username"),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600",defaultValue:!0,"aria-label":"email",type:"email",required:!0}),e.jsx("span",{className:"text-red-600",children:r.touched.username&&r.errors.username?r.errors.username:null})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex flex-wrap flex-row",children:e.jsx("div",{className:"flex-shrink max-w-full w-1/2",children:e.jsx("label",{htmlFor:"inputpass",className:"inline-block mb-2",children:"Password"})})}),e.jsx("input",{...r.getFieldProps("password"),className:"w-full leading-5 relative py-2 px-4 rounded text-gray-800 bg-white border border-gray-300 overflow-x-auto focus:outline-none focus:border-gray-400 focus:ring-0 darks:text-gray-300 darks:bg-gray-700 darks:border-gray-700 darks:focus:border-gray-600","aria-label":"password",type:"password",defaultValue:!0,required:!0}),e.jsx("span",{className:"text-red-600",children:r.touched.password&&r.errors.password?r.errors.password:null})]}),e.jsx("div",{className:"grid",children:A?e.jsx("div",{className:"flex justify-center",children:e.jsx(C,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})}):e.jsxs("button",{type:"submit",className:"py-2 px-4 inline-block text-center rounded leading-normal text-gray-100 bg-indigo-500 border border-indigo-500 hover:text-white hover:bg-indigo-600 hover:ring-0 hover:border-indigo-600 focus:bg-indigo-600 focus:border-indigo-600 focus:outline-none focus:ring-0",children:[e.jsxs("svg",{xmlnsXlink:"http://www.w3.org/2000/svg",fill:"currentColor",className:"inline-block w-4 h-4 ltr:mr-2 rtl:ml-2 bi bi-box-arrow-in-right",viewBox:"0 0 16 16",children:[e.jsx("path",{fillRule:"evenodd",d:"M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"}),e.jsx("path",{fillRule:"evenodd",d:"M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"})]}),"Login"]})})]})})})}export{J as default};
