import{b as p,aI as le,r as n,A as N,aL as y,a_ as b,bq as re,m as ne,o as E,aE as de,p as oe,j as e,aM as ie,q as ee,a$ as te,aN as ae,P as ce,l as ue,br as me,B as xe,bf as he,n as C,bs as be,bt as ge,bu as fe,t as K}from"./index-ERw10KzH.js";import{P as we}from"./reactjs-popup.esm-BVmXv7I5.js";import{C as se,a as Ne}from"./ClusterView-AVWchm4K.js";const ye=t=>{var T,W,I,B,Y,q,H,z,O;p();const{addCluster:$,updateCluster:j}=se(),{api_wardByUlb:D,api_newWardByOldWard:A}=le(),{ulbList:F}=ce(),[V,P]=n.useState(!1),[R,G]=n.useState(),[h,J]=n.useState(),[g,k]=n.useState(),[_,c]=n.useState(!1),[Q,M]=n.useState(null);n.useEffect(()=>{t!=null&&t.editState&&(x(),L()),c(!1),N.get(F,y()).then(r=>{var d,i;(d=r==null?void 0:r.data)!=null&&d.status?G((i=r==null?void 0:r.data)==null?void 0:i.data):(b.error("Something went wrong !!!"),t==null||t.backFun())}).catch(r=>{b.error("Something went wrong !!!"),t==null||t.backFun()}).finally(()=>c(!1))},[]);const x=r=>{var i;c(!0);let d;t!=null&&t.editState?d={ulbId:(i=t==null?void 0:t.userData)==null?void 0:i.ulb_id}:d={ulbId:r.target.value},N.post(D,d,y()).then(m=>{var S,o;(S=m==null?void 0:m.data)!=null&&S.status?J((o=m==null?void 0:m.data)==null?void 0:o.data):(b.error("Something went wrong !!!"),t==null||t.backFun())}).catch(m=>{b.error("Something went wrong !!!"),t==null||t.backFun()}).finally(()=>c(!1))},L=r=>{var i,m,S;let d;t!=null&&t.editState?d={oldWardMstrId:re((i=t==null?void 0:t.userData)==null?void 0:i.ward_mstr_id)=="NA"?r:(m=t==null?void 0:t.userData)==null?void 0:m.ward_mstr_id,ulbId:(S=t==null?void 0:t.userData)==null?void 0:S.ulb_id}:d={oldWardMstrId:r,ulbId:l.values.ulbId},N.post(A,d,y()).then(function(o){var U,f,a;(U=o==null?void 0:o.data)!=null&&U.status?k((f=o==null?void 0:o.data)==null?void 0:f.data):b.error((a=o==null?void 0:o.data)==null?void 0:a.message)}).catch(o=>{b.error(o==null?void 0:o.message)}).finally(()=>c(!1))},X=ne({wardNo:E().required("Select ward"),newWardNo:E().required("Select new ward"),clusterName:E().required("Enter name"),clusterType:E().required("Select type"),clusterAddress:E().required("Enter address"),clusterMobileNo:de().typeError("must be number").min(1e9,"not valid").max(9999999999,"not valid").required("Enter mobile no."),clusterAuthPersonName:E().required("Select authorized person name")});n.useEffect(()=>{});const l=oe({initialValues:{id:(T=t==null?void 0:t.userData)==null?void 0:T.id,ulbId:(W=t==null?void 0:t.userData)==null?void 0:W.ulb_id,wardNo:(I=t==null?void 0:t.userData)==null?void 0:I.ward_mstr_id,newWardNo:(B=t==null?void 0:t.userData)==null?void 0:B.new_ward_mstr_id,clusterName:(Y=t==null?void 0:t.userData)==null?void 0:Y.cluster_name,clusterType:(q=t==null?void 0:t.userData)==null?void 0:q.cluster_type,clusterAddress:(H=t==null?void 0:t.userData)==null?void 0:H.address,clusterMobileNo:(z=t==null?void 0:t.userData)==null?void 0:z.mobile_no,clusterAuthPersonName:(O=t==null?void 0:t.userData)==null?void 0:O.authorized_person_name},onSubmit:r=>{Z(r)},validationSchema:X}),Z=r=>{c(!0),t!=null&&t.editState?N.post(j,r,y()).then(d=>{var i;(i=d==null?void 0:d.data)!=null&&i.status?(b.success("Updated Successfully"),t.backFun(),t.refresh()):v(!0,"Error occured while updating cluster. Please try again later."),c(!1)}).catch(d=>{c(!1),v(!0,"Error occured while updating cluster. Please try again later.")}):N.post($,r,y()).then(d=>{var i;(i=d==null?void 0:d.data)!=null&&i.status?(t.backFun(),b.success("Added Successfully"),t.refresh()):v(!0,"Error occured while adding cluster. Please try again later."),c(!1)}).catch(d=>{c(!1),v(!0,"Error occured while adding cluster. Please try again later.")})},v=(r,d)=>{M(d),P(r)};return e.jsxs(e.Fragment,{children:[_&&e.jsx(ie,{}),V&&e.jsx(ee,{activateBottomErrorCard:v,errorTitle:Q}),e.jsx(te,{position:"top-right",autoClose:2e3}),e.jsxs("h1",{className:"mt-6 mb-2 sm:-mb-16 mx-6 font-serif font-semibold relative text-gray-600",children:[e.jsx(ae,{className:"inline mr-2"}),t!=null&&t.editState?"Edit":"Add"," Cluster"]}),e.jsx("div",{className:"sm:mt-[4rem] md:mt-[5rem] p-4 w-full md:py-6 md:px-14 shadow-lg bg-white mx-auto border border-gray-200 max-sm:mb-5",children:e.jsx("form",{onSubmit:l.handleSubmit,onChange:l.handleChange,className:"text-xs",children:e.jsxs("div",{className:"grid grid-cols-12 md:gap-x-8 gap-y-6",children:[e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Ward No."]}),e.jsxs("select",{value:l.values.wardNo,onChange:r=>L(r.target.value),name:"wardNo",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),h==null?void 0:h.map(r=>e.jsx("option",{value:r.id,children:r.ward_name}))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.wardNo&&l.errors.wardNo?l.errors.wardNo:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"New Ward No."]}),e.jsxs("select",{value:l.values.newWardNo,name:"newWardNo",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",children:"Select"}),g==null?void 0:g.map(r=>e.jsx("option",{value:r.new_ward_mstr_id,children:r.ward_name}))]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.newWardNo&&l.errors.newWardNo?l.errors.newWardNo:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Name"]}),e.jsx("input",{type:"text",value:l.values.clusterName,onChange:l.handleChange,name:"clusterName",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter your name.."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.clusterName&&l.errors.clusterName?l.errors.clusterName:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Type"]}),e.jsxs("select",{value:l.values.clusterType,onChange:l.handleChange,name:"clusterType",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",children:[e.jsx("option",{value:"",disabled:!0,selected:!0,children:"--Select Type--"}),e.jsx("option",{value:"c-saf",children:"C-SAF"}),e.jsx("option",{value:"gb-saf",children:"GB-SAF"})]}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.clusterType&&l.errors.clusterType?l.errors.clusterType:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Address"]}),e.jsx("input",{value:l.values.clusterAddress,onChange:l.handleChange,type:"text",name:"clusterAddress",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter your address.."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.clusterAddress&&l.errors.clusterAddress?l.errors.clusterAddress:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Mobile No."]}),e.jsx("input",{value:l.values.clusterMobileNo,onChange:l.handleChange,type:"text",maxLength:10,name:"clusterMobileNo",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter your mobile no..."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.clusterMobileNo&&l.errors.clusterMobileNo?l.errors.clusterMobileNo:null})]}),e.jsxs("div",{className:"md:col-span-4 col-span-12",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Authorized Person Name"]}),e.jsx("input",{value:l.values.clusterAuthPersonName,onChange:l.handleChange,type:"text",name:"clusterAuthPersonName",className:"form-control block w-[80%] max-sm:w-[100%]  px-3 py-1.5 text-sm font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none shadow-md",placeholder:"Enter authorized person name.."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:l.touched.clusterAuthPersonName&&l.errors.clusterAuthPersonName?l.errors.clusterAuthPersonName:null})]}),e.jsxs("div",{className:"col-span-12 flex justify-between",children:[e.jsx("button",{onClick:t.backFun,type:"button",className:"md:mt-1.5 px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out",children:"Back"}),e.jsx("button",{type:"submit",className:"md:mt-2 px-6 py-2.5 bg-green-600 text-white font-medium text-xs leading-tight  rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out",children:t!=null&&t.editState?e.jsx(e.Fragment,{children:"Update"}):e.jsx(e.Fragment,{children:"Add"})})]})]})})})]})},je=t=>{const[$,j]=n.useState(!1),[D,A]=n.useState(!1),[F,V]=n.useState(),[P,R]=n.useState(),[G,h]=n.useState(!1),[J,g]=n.useState(!1);n.useState(!1);const[k,_]=n.useState(0),[c,Q]=n.useState([]),[M,x]=n.useState(!1),[L,X]=n.useState(),[l,Z]=n.useState();n.useState();const[v,T]=n.useState(0),[W,I]=n.useState(!1),[B,Y]=n.useState(!1),[q,H]=n.useState(null);ue("Cluster List");const{getCluster:z,viewCluster:O,deleteCluster:r}=se(),d=p();n.useEffect(()=>{x(!0),N.post(z,{},y()).then(a=>{var s,u,w;(s=a==null?void 0:a.data)!=null&&s.status?(Q((u=a==null?void 0:a.data)==null?void 0:u.data),j(!0),h(!1),A(!1),g(!1)):f(!0,me((w=a==null?void 0:a.data)==null?void 0:w.message)),x(!1)}).catch(a=>{f(!0,"Error in fetching cluster list. Please try again later."),x(!1)})},[k]);const i=a=>{x(!0),N.post(r,{id:a},y()).then(s=>{b.success("Deleted Successfully !!"),_(k+1),x(!1),j(!0),h(!1),A(!1),g(!1)}).catch(s=>{f(!0,"Error in deleting cluster. Please try again later."),x(!1)})},m=()=>{j(!1),g(!0),h(!1)};n.useEffect(()=>{_(k+1)},[]);const S=a=>{x(!0),N.post(O,{clusterId:a},y()).then(s=>{var u,w;R((w=(u=s==null?void 0:s.data)==null?void 0:u.data)==null?void 0:w.cluster),j(!1),A(!0),h(!1),V(a),x(!1)}).catch(s=>{f(!0,"Error in cluster data update. Please try again later."),x(!1)})},o=()=>{h(!1),j(!0),A(!1),g(!1),R("")},U=[{Header:"S.No.",Cell:({row:a})=>e.jsx("div",{children:(a==null?void 0:a.index)+1}),className:"w-[5%]"},{Header:"Old Ward No.",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.oldWardName)},className:"w-[5%]"},{Header:"New Ward No.",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.newWardName)},className:"w-[5%]"},{Header:"Name",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.name)},className:"w-[15%]"},{Header:"Type",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.type)},className:"w-[5%]"},{Header:"Address",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.address)},className:"w-[20%]"},{Header:"Mobile No.",accessor:"mobileNo",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.mobileNo)},className:"w-[10%]"},{Header:"Authorized Person Name",accessor:"authPersonName",Cell:({cell:a})=>{var s;return C((s=a.row.original)==null?void 0:s.authPersonName)},className:"w-[15%]"},{Header:"Actions",accessor:"id",Cell:({cell:a})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-x-2 mb-4",children:[e.jsx("button",{"data-tooltip-id":"edit","data-tooltip-content":"Edit",className:"text-green-500 hover:border-green-500 hover:border-2 hover:shadow-green-300 rounded-md text-lg hover:shadow-md shadow-sm max-sm:ml-4 md:py-1 md:px-2 transition-all duration-100",onClick:()=>{var s,u;return S((u=(s=a==null?void 0:a.row)==null?void 0:s.values)==null?void 0:u.id)},children:e.jsx(be,{})}),e.jsx("button",{"data-tooltip-id":"view","data-tooltip-content":"View",className:"text-amber-500 hover:border-amber-500 hover:border-2 hover:shadow-amber-300 rounded-md text-lg hover:shadow-md shadow-sm py-1 px-2 transition-all duration-100",onClick:()=>{var s,u;return d("/viewCluster/"+((u=(s=a==null?void 0:a.row)==null?void 0:s.values)==null?void 0:u.id))},children:e.jsx(ge,{})}),e.jsx(we,{trigger:e.jsx("button",{"data-tooltip-id":"delete","data-tooltip-content":"Delete",className:"text-red-500 hover:border-red-500 hover:border-2 hover:shadow-red-300 rounded-md text-lg hover:shadow-md shadow-sm py-1 px-2 transition-all duration-100",children:e.jsx(fe,{})}),modal:!0,nested:!0,children:s=>e.jsx("div",{className:"h-screen w-screen flex-row justify-center items-center backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col justify-center h-max w-max absolute top-[40%] right-[40%] bg-white px-4 py-2 rounde-md shadow-lg animate__animated animate__fadeInDown animate__faster",children:[e.jsx("button",{className:"close text-end ",onClick:s,children:e.jsx("span",{className:"hover:bg-red-400 hover:text-white rounded-md px-1 ",children:"×"})}),e.jsx("div",{className:"text-base",children:"Are you sure want to delete ?"}),e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("button",{className:"bg-red-200 hover:bg-red-300 shadow-md text-xs px-4 py-1 m-4 rounded-md",onClick:()=>{var u,w;s(),i((w=(u=a==null?void 0:a.row)==null?void 0:u.values)==null?void 0:w.id)},children:"Yes"}),e.jsx("button",{className:"bg-green-200 hover:bg-green-300 px-4 shadow-md text-xs py-1 m-4 rounded-md",onClick:s,children:"No"})]})]})})}),e.jsx(K,{id:"edit",style:{fontSize:"12px",padding:"2px 8px",transition:"all",transitionDuration:"300"},place:"bottom"}),e.jsx(K,{id:"view",style:{fontSize:"12px",padding:"2px 8px",transition:"all",transitionDuration:"300"},place:"bottom"}),e.jsx(K,{id:"delete",style:{fontSize:"12px",padding:"2px 8px",transition:"all",transitionDuration:"300"},place:"bottom"})]})}),className:"w-[12%]"}],f=(a,s)=>{H(s),I(JSON.stringify(a))};return M?e.jsx(e.Fragment,{children:e.jsx(xe,{})}):B?e.jsx(ServerErrorCard,{title:"Server is busy",desc:"Server is too busy to respond. Please try again later.",buttonText:"View Dashboard",buttonUrl:"/propertyDashboard"}):e.jsxs(e.Fragment,{children:[e.jsx(te,{position:"top-right",autoClose:2e3}),W&&e.jsx(ee,{activateBottomErrorCard:f,errorTitle:q}),e.jsx("div",{className:"px-2 sm:px-0",children:!M&&$&&(c==null?void 0:c.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"mt-6 mb-2 font-serif font-semibold  text-gray-600",children:[e.jsx(ae,{className:"inline mr-2"}),"Cluster List"]}),e.jsx("button",{className:"bg-sky-400 px-3 pr-3 shadow-lg rounded py-1 text-white hover:shadow-2xl hover:bg-green-600 text-center relative max-sm:mt-2",onClick:()=>m(),children:"Add"})]}),e.jsx(he,{columns:U,dataList:c}),e.jsx("div",{className:"h-[20vh]"})]})}),(D||J)&&e.jsx(e.Fragment,{children:e.jsx(ye,{backFun:o,editState:D,userId:F,userData:P,refresh:()=>_(k+1)})}),G&&e.jsx(Ne,{backFun:o,userData:P,userId:F,holdingList:L,safList:l,refresh:()=>T(v+1)})]})},Ae=()=>e.jsx("div",{className:"poppins",children:e.jsx(je,{})});export{Ae as default};
