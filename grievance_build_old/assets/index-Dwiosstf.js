import{r as m,z as I,s as R,g as H,j as a,t as U,v as G,H as J,w as K,S as O,x as Q,y as V,_ as h}from"./index-BhUdOP_r.js";import{P as W}from"./index-Dz8sjSL2.js";import{T as X,a as Z,b as M,c as n,d as k,e as d}from"./table-CwxQdaVU.js";import{g as F}from"./services-KQnp_8oA.js";import{P as z}from"./index-DIhL8Sw8.js";import{S as aa}from"./index-DAPV0_uK.js";import{q as sa}from"./switch-C83BFyiM.js";import"./pagination-B5OvJmEf.js";function ta(){var l,j,g,p,u,f,o,N,P,C,v;const[r,_]=m.useState(1),E=I({}),[i,Y]=m.useState(10),[x,q]=m.useState(""),[L]=m.useState(""),s=R({api:`${H.getAllCitizenFeedback}?page=${r}&limit=${i}&q=${x}`,key:"getAllCitizenFeedback",value:[r,i],options:{enabled:!0}}),B=async t=>{var c,y,S,w,T,$,b,A,D;try{const e=await E.mutateAsync({api:`${(c=H)==null?void 0:c.updateCitizenFeedback}/${t}`,data:{id:L}});(y=e==null?void 0:e.data)!=null&&y.success?(s==null||s.refetch(),((w=(S=e==null?void 0:e.data)==null?void 0:S.data)==null?void 0:w.status)==1&&h.success((T=e.data)==null?void 0:T.message),((b=($=e==null?void 0:e.data)==null?void 0:$.data)==null?void 0:b.status)==0&&h.error((A=e.data)==null?void 0:A.message)):h.error((D=e.data)==null?void 0:D.message)}catch(e){h.error(F(e))}};return a.jsx("main",{className:"grid items-start",children:a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsx("div",{className:"flex w-full justify-between gap-2",children:a.jsx("div",{children:a.jsx(aa,{search:x,setSearch:q,refetch:s==null?void 0:s.refetch,isFetching:s==null?void 0:s.isLoading})})}),a.jsxs(U,{children:[a.jsx(G,{className:"px-7",children:a.jsxs(J,{children:["Citizen Feedback List (",(j=(l=s==null?void 0:s.data)==null?void 0:l.data)==null?void 0:j.totalDocs,")"]})}),a.jsx(K,{children:s!=null&&s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(O,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(X,{children:[a.jsx(Z,{children:a.jsxs(M,{children:[a.jsx(n,{className:"",children:"#"}),a.jsx(n,{className:"",children:"Citizen Name"}),a.jsx(n,{className:"",children:"Feedback"}),a.jsx(n,{className:"",children:"Id"}),a.jsx(n,{className:"",children:"Created at"}),a.jsx(n,{className:"",children:"Status"})]})}),a.jsx(k,{children:(u=(p=(g=s==null?void 0:s.data)==null?void 0:g.data)==null?void 0:p.docs)==null?void 0:u.map((t,c)=>a.jsxs(M,{children:[a.jsx(d,{children:r*i-i+c+1}),a.jsx(d,{children:t==null?void 0:t.citizenName}),a.jsx(d,{children:t==null?void 0:t.feedback}),a.jsx(d,{children:t==null?void 0:t._id}),a.jsx(d,{children:Q(t==null?void 0:t.createdAt).format("DD-MM-YYYY")}),a.jsx(d,{children:a.jsxs(sa,{checked:(t==null?void 0:t.status)==1,onChange:()=>B(t._id),className:`${t!=null&&t.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${t!=null&&t.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})})]},t==null?void 0:t._id))})]}),a.jsx(V,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(z,{page:r,perPage:i,totalPage:(o=(f=s==null?void 0:s.data)==null?void 0:f.data)==null?void 0:o.totalDocs,hasNextPage:(P=(N=s==null?void 0:s.data)==null?void 0:N.data)==null?void 0:P.hasNextPage,hasPrevPage:(v=(C=s==null?void 0:s.data)==null?void 0:C.data)==null?void 0:v.hasPrevPage,setPage:_,setPerPage:Y})})]})})]})]})})}function xa(){return a.jsx(W,{title:"Citizen Feedback",subTitle:"Manage all the Feedback here",children:a.jsx("div",{children:a.jsx(ta,{})})})}export{xa as default};
