import{r as v,b as oa,o as pa,s as t,g as o,j as e,F as ha,y as la,a0 as c,R as N,J as h,B as xa,t as ia,v as ua,H as ja,w as ga,S as ba,x as f,a3 as p,L as ya,G as va,c as Na,d as s}from"./index-BhUdOP_r.js";import{T as fa,a as Sa,b as ra,c as d,d as Ia,e as n}from"./table-CwxQdaVU.js";import{P as Ta}from"./index-DIhL8Sw8.js";import{P as Aa}from"./index-Dz8sjSL2.js";import"./pagination-B5OvJmEf.js";const Pa=Na().shape({ulbId:s(),moduleId:s(),complaintTypeId:s(),priorityId:s(),targetTypeId:s(),complaintSourceTypeId:s(),departmentId:s(),fDate:s(),slaStatusSearch:s(),toDate:s(),complaintRefNo:s(),type:s()});function $a(){var S,I,T,A,P,$,w,L,R,F,k,D,C,_,m,G,H,M,B,E,O,Y,U,V,J,W,q,z,K,Q,X;const[i,sa]=v.useState(1),[x,da]=v.useState(10),l=oa({resolver:pa(Pa),defaultValues:{ulbId:"",moduleId:"",complaintTypeId:"",priorityId:"",targetTypeId:"",slaStatusSearch:"",complaintSourceTypeId:"",departmentId:"",fDate:"",toDate:"",complaintRefNo:"",type:""}});console.log("methods");const na=async()=>{r.refetch()},r=t({api:`${o.complaintReport}?page=${i}&limit=${x}&priority=${l.watch("priorityId")}&ulb=${l.watch("ulbId")}&departmentId=${l.watch("departmentId")}&complaintType=${l.watch("complaintTypeId")}&targetType=${l.watch("targetTypeId")}&module=${l.watch("moduleId")}&source=${l.watch("complaintSourceTypeId")}&fDate=${l.watch("fDate")}&toDate=${l.watch("toDate")}&complaintRefNo=${l.watch("complaintRefNo")}&slaStatusSearch=${l.watch("slaStatusSearch")}&type=${l.watch("type")}`,key:"searchAllComplaints",value:[i,x],options:{enabled:!0}});t({api:`${(S=o)==null?void 0:S.getAllUlb}?page=1&limit=10000`,key:"getAllUlb",options:{enabled:!0}}),t({api:`${(I=o)==null?void 0:I.getAllModule}?page=1&limit=10000`,key:"geAllModules",options:{enabled:!0}});const u=t({api:`${(T=o)==null?void 0:T.getAllComplaintType}?page=1&limit=10000`,key:"getAllComplaintTypes",options:{enabled:!0}}),j=t({api:`${(A=o)==null?void 0:A.getAllPriority}?page=1&limit=10000`,key:"getAllPriority",options:{enabled:!0}});t({api:`${(P=o)==null?void 0:P.getAllTarget}?page=1&limit=10000`,key:"getAllTargetTypes",options:{enabled:!0}});const g=t({api:`${o.getAllComplaintSource}?page=1&limit=10000`,key:"getAllComplaintSource",options:{enabled:!0}}),b=t({api:`${o.getAllDepartment}?page=1&limit=10000`,key:"getAllDepartment",options:{enabled:!0,refetchOnMount:!1}}),y=t({api:`${o.getAllProblemDirect}?page=1&limit=10000`,key:"getProblemData",options:{enabled:!0,refetchOnMount:!1}}),ca=v.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsx(ha,{methods:l,onSubmit:l.handleSubmit(na),children:e.jsxs("div",{className:"grid grid-cols-6 gap-x-2 gap-y-4 bg-background px-10 py-4",children:[e.jsx("h1",{className:"text-xl font-bold text-blue-800 uppercase col-span-4",children:"Grievance Report"}),e.jsx(la,{className:"col-span-6"}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"complaintRefNo",children:"Grievance No."}),e.jsx(N,{name:"complaintRefNo",className:"",placeholder:"Enter Grievance number"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"fDate",children:"From Date"}),e.jsx(N,{name:"fDate",type:"date",className:""})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"toDate",children:"Upto Date"}),e.jsx(N,{name:"toDate",type:"date",className:""})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"departmentId",children:"Department"}),e.jsx(h,{className:"bg-background cursor-pointer",name:"departmentId",data:((L=(w=($=b==null?void 0:b.data)==null?void 0:$.data)==null?void 0:w.docs)==null?void 0:L.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.department})))??[]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"targetTypeId",children:"Grievance Type"}),e.jsx(h,{className:"bg-background cursor-pointer",name:"targetTypeId",data:((k=(F=(R=y==null?void 0:y.data)==null?void 0:R.data)==null?void 0:F.docs)==null?void 0:k.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.problem})))??[]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"complaintTypeId",children:"Entry Type"}),e.jsx(h,{className:"bg-background cursor-pointer",name:"complaintTypeId",data:((_=(C=(D=u==null?void 0:u.data)==null?void 0:D.data)==null?void 0:C.docs)==null?void 0:_.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.complaintTypeName})))??[]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"priorityId",children:"Priority"}),e.jsx(h,{className:"bg-background cursor-pointer",name:"priorityId",data:((H=(G=(m=j==null?void 0:j.data)==null?void 0:m.data)==null?void 0:G.docs)==null?void 0:H.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.priorityName})))??[]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"complaintSourceTypeId",children:"Entry Modes"}),e.jsx(h,{className:"bg-background cursor-pointer",name:"complaintSourceTypeId",data:((E=(B=(M=g==null?void 0:g.data)==null?void 0:M.data)==null?void 0:B.docs)==null?void 0:E.map(a=>({value:a==null?void 0:a._id,label:a==null?void 0:a.source})))??[]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"type",children:"Grievance Status"}),e.jsx(h,{name:"type",data:[{value:"0",label:"Pending"},{value:"1",label:"Resolved"},{value:"2",label:"Rejected"},{value:"3",label:"Pending (Re-Opened)"},{value:"4",label:"Withdrawn"}]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"slaStatusSearch",children:"Level Status"}),e.jsx(h,{name:"slaStatusSearch",data:[{value:"L1",label:"L1"},{value:"L2",label:"L2"},{value:"L3",label:"L3"}]})]}),e.jsx("div",{}),e.jsx("div",{className:"mt-6",children:e.jsx(xa,{isLoading:l.formState.isSubmitting,type:"submit",className:" w-auto  px-10 float-right",children:"Search"})})]})}),e.jsx("div",{className:"mt-2",children:e.jsxs(ia,{children:[e.jsx(ua,{className:"px-7",children:e.jsxs(ja,{className:"flex justify-between",children:[e.jsxs("h1",{children:["Grievance List (",(Y=(O=r.data)==null?void 0:O.data)==null?void 0:Y.totalDocs,")"]}),e.jsx("h1",{className:"flex gap-2 "})]})}),e.jsx(ga,{children:r.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(ba,{})}):e.jsxs("div",{children:[e.jsxs(fa,{ref:ca,children:[e.jsx(Sa,{children:e.jsxs(ra,{className:"text-xs",children:[e.jsx(d,{className:"",children:"#"}),e.jsx(d,{className:"",children:"Grievance No."}),e.jsx(d,{className:"",children:"Department"}),e.jsx(d,{className:"",children:"Received Date"}),e.jsx(d,{className:"",children:"Source"}),e.jsx(d,{className:"",children:"Pending At"}),e.jsx(d,{className:"",children:"Redressal Days"}),e.jsx(d,{className:"",children:"Status"}),e.jsx(d,{className:"",children:"Level Status"}),e.jsx(d,{className:"",children:"Priority"}),e.jsx(d,{className:"",children:"View"})]})}),e.jsx(Ia,{children:(J=(V=(U=r==null?void 0:r.data)==null?void 0:U.data)==null?void 0:V.docs)==null?void 0:J.map((a,ta)=>{var Z,aa,ea;return e.jsxs(ra,{className:"text-xs",children:[e.jsx(n,{children:i*x-x+ta+1}),e.jsx(n,{children:(a==null?void 0:a.complaintRefNo)||"N/A"}),e.jsx(n,{children:((Z=a==null?void 0:a.department)==null?void 0:Z.department)||"N/A"}),e.jsx(n,{children:f(a==null?void 0:a.createdAt).format("DD-MM-YYYY")||"N/A"}),e.jsx(n,{children:((aa=a==null?void 0:a.source)==null?void 0:aa.source)||"N/A"}),e.jsx(n,{children:(a==null?void 0:a.pendingAt)||"N/A"}),e.jsxs(n,{children:[" ",f().diff(f(a==null?void 0:a.createdAt),"days")," days"]}),e.jsxs(n,{children:[(a==null?void 0:a.wf_status)===4&&e.jsx(p,{variant:"destructive",children:"Closed"}),(a==null?void 0:a.wf_status)===3&&e.jsx(p,{className:"bg-amber-500 text-white",children:"Pending(Re-Opened)"}),(a==null?void 0:a.wf_status)===2&&e.jsx(p,{variant:"destructive",children:"Rejected"}),(a==null?void 0:a.wf_status)===1&&e.jsx(p,{variant:"success",children:"Resolved"}),(a==null?void 0:a.wf_status)===0&&e.jsx(p,{variant:"secondary",children:"Pending"})]}),e.jsxs(n,{children:[(a==null?void 0:a.slaLevel)=="1"&&e.jsx(p,{className:"bg-gray-400 hover:bg-gray-400",children:a==null?void 0:a.slaLevel}),(a==null?void 0:a.slaLevel)=="2"&&e.jsx(p,{className:"bg-amber-500 hover:bg-amber-500",children:a==null?void 0:a.slaLevel}),(a==null?void 0:a.slaLevel)=="3"&&e.jsx(p,{className:"bg-red-500 hover:bg-red-500",children:a==null?void 0:a.slaLevel})]}),e.jsx(n,{children:((ea=a==null?void 0:a.priority)==null?void 0:ea.priorityName)||"N/A"}),e.jsx(n,{children:e.jsx(ya,{to:`/grievance/dashboard/management-complaint-details?complaintRefNo=${a==null?void 0:a.complaintRefNo}
                         &complaintId=${a==null?void 0:a._id}`,children:e.jsx(va,{className:"bg-primary",onClick:()=>{},children:"View"})})})]},a._id)})})]}),e.jsx(la,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(Ta,{page:i,perPage:x,totalPage:(q=(W=r==null?void 0:r.data)==null?void 0:W.data)==null?void 0:q.totalDocs,hasNextPage:(K=(z=r==null?void 0:r.data)==null?void 0:z.data)==null?void 0:K.hasNextPage,hasPrevPage:(X=(Q=r==null?void 0:r.data)==null?void 0:Q.data)==null?void 0:X.hasPrevPage,setPage:sa,setPerPage:da})})]})})]})})]})}function Da(){return e.jsx(Aa,{title:"",subTitle:"",children:e.jsx("div",{className:"",children:e.jsx($a,{})})})}export{Da as default};
