import{u as G,A as W,s as z,b as O,o as Q,r as l,j as a,D as X,F as Z,R as aa,H as D,B as ea,c as sa,d as ra,g as y,_ as n,J as U,t as ta,v as ia,w as ca,x as na,y as oa,K as da}from"./index-BM0oc_dR.js";import{P as la}from"./index-lAQ15i_6.js";import{T as ua,a as ha,b as V,c as h,d as xa,e as x}from"./table-BWoLNWxy.js";import{g as pa}from"./services-KQnp_8oA.js";import{P as ga}from"./index-D9n-mIVU.js";import{S as ja}from"./index-5TntktDp.js";import{q as fa}from"./switch-BR8_TMsY.js";import"./badge-272lERzh.js";import"./index-CeYUPDYe.js";import"./circle-check-big-DCfAJpH9.js";import"./pagination-CQ-KYJ4s.js";const ya=sa().shape({priorityName:ra().required("Priority is required")});function ma({open:S,setOpen:o,title:v,id:c,edit:d,setEdit:p,refetch:w}){const $=G({}),g=W({}),{data:u,isFetching:A}=z({api:`${y.getPriorityById}/${c}`,key:"getPriorityById",options:{enabled:d}}),i=O({defaultValues:{priorityName:""},resolver:Q(ya)}),m=async s=>{var P,N,j,f;try{if(d&&s){const r=await g.mutateAsync({api:`${y.updatePriority}/${c}`,data:s});(P=r.data)!=null&&P.success?n.success((N=r==null?void 0:r.data)==null?void 0:N.message):n.error("Priority Type not updated successfully")}else{const r=await $.mutateAsync({api:y.createPriority,data:s});(j=r.data)!=null&&j.success?n.success((f=r==null?void 0:r.data)==null?void 0:f.message):n.error("Priority Type not created successfully"),i.reset({priorityName:""})}o(!1),p(!1),w()}catch(r){console.log(r)}};return l.useEffect(()=>{d&&u?i.reset({priorityName:u.data.priorityName}):i.reset({priorityName:""})},[d,u]),a.jsx(X,{open:S,setOpen:o,title:v,setEdit:p,edit:d,isLoading:A,children:a.jsx(Z,{methods:i,onSubmit:i.handleSubmit(m),children:a.jsxs("div",{className:"grid grid-cols-1 gap-x-2 gap-y-4",children:[a.jsx("div",{children:a.jsx(aa,{name:"priorityName",placeholder:"Enter Priority Type"})}),a.jsx(D,{}),a.jsx("div",{children:a.jsx(ea,{isLoading:i.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl",children:"Submit"})})]})})})}function Pa(){var j,f,r,T,C,F,k,E,B,M,L;const S=W({}),[o,v]=l.useState(1),[c,d]=l.useState(5),[p,w]=l.useState(""),[$,g]=l.useState(!1),[u,A]=l.useState(""),[i,m]=l.useState(!1),s=z({api:`${y.getAllPriority}?page=${o}&limit=${c}&q=${p}`,key:"getAllWorkFlowRole",value:[o,c],options:{enabled:!0}}),P=e=>{m(!0),g(!0),A(e)},N=async e=>{var b,H,_,q,I,R,Y,J,K;try{const t=await S.mutateAsync({api:`${(b=y)==null?void 0:b.updatePriorityStatus}/${e}`,data:{id:u}});(H=t==null?void 0:t.data)!=null&&H.success?(s.refetch(),((q=(_=t==null?void 0:t.data)==null?void 0:_.data)==null?void 0:q.status)==1&&n.success((I=t.data)==null?void 0:I.message),((Y=(R=t==null?void 0:t.data)==null?void 0:R.data)==null?void 0:Y.status)==0&&n.error((J=t.data)==null?void 0:J.message)):n.error((K=t.data)==null?void 0:K.message)}catch(t){n.error(pa(t))}};return a.jsxs("main",{className:"grid items-start",children:[a.jsx(ma,{open:$,setOpen:g,title:i?"Edit Priority":"Add Priority",id:u,edit:i,setEdit:m,refetch:s.refetch}),a.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[a.jsxs("div",{className:"flex w-full justify-between gap-2",children:[a.jsx("div",{children:a.jsx(ja,{search:p,setSearch:w,refetch:s.refetch,isFetching:s.isLoading})}),a.jsx("div",{children:a.jsx(U,{className:"flex items-center gap-2",onClick:()=>g(!0),children:"Add New"})})]}),a.jsxs(ta,{children:[a.jsx(ia,{className:"px-7",children:a.jsxs(ca,{children:["Priority List (",(f=(j=s.data)==null?void 0:j.data)==null?void 0:f.totalDocs,")"]})}),a.jsx(na,{children:s.isLoading?a.jsx("div",{className:"flex h-32 items-center justify-center",children:a.jsx(oa,{})}):a.jsxs(a.Fragment,{children:[a.jsxs(ua,{children:[a.jsx(ha,{children:a.jsxs(V,{children:[a.jsx(h,{className:"",children:"#"}),a.jsx(h,{className:"",children:"Priority"}),a.jsx(h,{className:"",children:"Id"}),a.jsx(h,{className:"",children:"Created at"}),a.jsx(h,{className:"",children:"Status"}),a.jsx(h,{children:"Action"})]})}),a.jsx(xa,{children:(C=(T=(r=s==null?void 0:s.data)==null?void 0:r.data)==null?void 0:T.docs)==null?void 0:C.map((e,b)=>a.jsxs(V,{children:[a.jsx(x,{children:o*c-c+b+1}),a.jsx(x,{children:e==null?void 0:e.priorityName}),a.jsx(x,{children:e==null?void 0:e._id}),a.jsx(x,{children:da(e==null?void 0:e.createdAt).format("DD-MM-YYYY")}),a.jsx(x,{children:a.jsxs(fa,{checked:(e==null?void 0:e.status)==1,onChange:()=>N(e==null?void 0:e._id),className:`${e!=null&&e.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[a.jsx("span",{className:"sr-only",children:"Enable notifications"}),a.jsx("span",{className:`${e!=null&&e.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),a.jsx(x,{children:a.jsx(U,{className:"bg-primary",onClick:()=>P(e==null?void 0:e._id),children:"Edit"})})]},e==null?void 0:e._id))})]}),a.jsx(D,{className:"mb-2 mt-4"}),a.jsx("div",{className:"flex w-full justify-end",children:a.jsx(ga,{page:o,perPage:c,totalPage:(k=(F=s==null?void 0:s.data)==null?void 0:F.data)==null?void 0:k.totalDocs,hasNextPage:(B=(E=s==null?void 0:s.data)==null?void 0:E.data)==null?void 0:B.hasNextPage,hasPrevPage:(L=(M=s==null?void 0:s.data)==null?void 0:M.data)==null?void 0:L.hasPrevPage,setPage:v,setPerPage:d})})]})})]})]})]})}function Ea(){return a.jsx(la,{title:"Priority List",subTitle:"Manage all the work Flow Priority here",children:a.jsx("div",{className:"py-12",children:a.jsx(Pa,{})})})}export{Ea as default};
