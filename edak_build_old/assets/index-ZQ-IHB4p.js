import{u as ee,A as Z,s as C,a as ae,b as se,o as le,r as j,j as e,F as re,R as k,M as G,U as K,V as Q,a2 as q,a3 as de,N as oe,G as ne,B as ie,c as te,d as m,O as ce,g as x,_ as h,J as W,t as ue,v as pe,w as me,x as xe,y as he,I as ge,K as je,H as fe}from"./index-BM0oc_dR.js";import{P as be}from"./index-lAQ15i_6.js";import{T as Ne,a as Ie,b as X,c,d as ye,e as u}from"./table-BWoLNWxy.js";import{D as ve}from"./index-kPSG944l.js";import{g as Ue}from"./services-KQnp_8oA.js";import{P as we}from"./index-D9n-mIVU.js";import{S as Se}from"./index-5TntktDp.js";import{q as Ae}from"./switch-BR8_TMsY.js";import"./badge-272lERzh.js";import"./index-CeYUPDYe.js";import"./circle-check-big-DCfAJpH9.js";import"./pagination-CQ-KYJ4s.js";const Pe=te().shape({fullName:m().required("Full Name is required"),mobile:m().required().min(10).max(10).label("Mobile"),email:m().required("Email is required"),password:m().required("Password is required"),roleId:m().required("Role is required"),ulbId:m(),address:m(),imageUrl:ce().nullable(),moduleId:m()});function $e({open:B,setOpen:g,title:R,id:p,edit:i,setEdit:f,refetch:_}){var N,I,y,v,U,w,S,A,P,$;const L=ee({}),b=Z({}),{data:d,isFetching:H}=C({api:`${x.getUserById}/${p}`,key:"getUserById",options:{enabled:i}}),{user:s}=ae(),t=se({defaultValues:{fullName:"",mobile:"",email:"",password:"",roleId:"",address:""},resolver:le(Pe)}),l=async a=>{var D,E,F,M;console.log(a,"12345678");const r=new FormData;(s==null?void 0:s.roleId)===q&&r.append("ulbId",s==null?void 0:s.userUlbId),((s==null?void 0:s.roleId)===Q||(s==null?void 0:s.roleId)===K)&&(a==null?void 0:a.roleId)===q&&r.append("ulbId",a==null?void 0:a.ulbId),r.append("fullName",a.fullName),r.append("mobile",a.mobile),r.append("roleId",a.roleId),r.append("moduleId",String(a.moduleId)),r.append("address",String(a==null?void 0:a.address)),r.append("imageUrl",a.imageUrl);try{if(i&&a){const o=await b.mutateAsync({api:`${x.updateUser}/${p}`,data:r});(D=o.data)!=null&&D.success?h.success((E=o==null?void 0:o.data)==null?void 0:E.message):h.error("User not updated successfully")}else{r.append("email",a.email),r.append("password",a.password);const o=await L.mutateAsync({api:x.createUser,data:r});(F=o.data)!=null&&F.success?h.success((M=o==null?void 0:o.data)==null?void 0:M.message):h.error("User not created successfully"),t.reset({fullName:"",mobile:"",email:"",password:"",roleId:"",address:""})}g(!1),f(!1),_()}catch(o){console.log(o)}};j.useEffect(()=>{i&&d?t.reset({fullName:d.userDetails.fullName,mobile:d.userDetails.mobile,email:d.userDetails.email,password:d.userDetails.password,roleId:d.userDetails.roleId,ulbId:d.userDetails.ulbId,address:d.userDetails.address,imageUrl:d.userDetails.imageUrl,moduleId:d.userDetails.moduleId}):t.reset({fullName:"",mobile:"",email:"",password:"",roleId:"",address:""})},[i,d]);const V=C({api:`${(N=x)==null?void 0:N.getAllRoleByPermission}?page=1&limit=10000`,key:"getAllRoleByPermission",options:{enabled:!0}}),Y=C({api:`${x.getAllUlb}?page=1&limit=1000`,key:"getAllUlb",options:{enabled:!0}}),T=C({api:`${x.getAllModule}?page=1&limit=1000`,key:"getAllModule",options:{enabled:!0}});return e.jsx(ve,{open:B,setOpen:g,title:R,setEdit:f,edit:i,isLoading:H,children:e.jsxs(re,{methods:t,onSubmit:t.handleSubmit(l),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4",children:[e.jsx("div",{children:e.jsx(k,{name:"fullName",placeholder:"Enter your Full Name ",inputValidation:["CapitalFirstLetter","removeDoubleSpace","string"]})}),e.jsx("div",{children:e.jsx(k,{name:"mobile",placeholder:"Enter your Mobile no.",inputValidation:["mobile","number"]})}),e.jsx("div",{children:e.jsx(k,{name:"email",placeholder:"Enter your Email",inputValidation:["removeSpace"]})}),!i&&e.jsx("div",{children:e.jsx(k,{name:"password",placeholder:"Enter your Password"})}),e.jsx("div",{children:e.jsx(G,{name:"roleId",data:((v=(y=(I=V.data)==null?void 0:I.data)==null?void 0:y.docs)==null?void 0:v.map(a=>({value:a._id,label:a.roleName})))??[],disabled:i})}),((s==null?void 0:s.roleId)===K||(s==null?void 0:s.roleId)===Q)&&t.watch("roleId")===q&&e.jsx("div",{children:e.jsx(G,{name:"ulbId",data:((S=(w=(U=Y.data)==null?void 0:U.data)==null?void 0:w.docs)==null?void 0:S.map(a=>({value:a._id,label:a.ulbName})))??[],disabled:i})}),(s==null?void 0:s.roleId)===q&&t.watch("roleId")===de&&e.jsx("div",{children:e.jsx(G,{name:"moduleId",data:(($=(P=(A=T.data)==null?void 0:A.data)==null?void 0:P.docs)==null?void 0:$.map(a=>({value:a._id,label:a.moduleName})))??[],disabled:i})}),e.jsx("div",{children:e.jsx(oe,{name:"imageUrl",placeholder:"Upload your Images"})}),e.jsx("div",{children:e.jsx(ne,{name:"address",placeholder:"Enter your Address",inputValidation:["removeDoubleSpace","UppercaseAfterSpace"]})}),e.jsx("div",{})]}),e.jsx("div",{className:"mt-5 justify-center items-center flex",children:e.jsx(ie,{isLoading:t.formState.isSubmitting,type:"submit",className:"h-11 w-full md:w-1/2 rounded-xl",children:"Submit"})})]})})}function De(){var T,N,I,y,v,U,w,S,A,P,$;const B=Z({}),[g,R]=j.useState(1),[p,i]=j.useState(10),[f,_]=j.useState(""),[L,b]=j.useState(!1),[d,H]=j.useState(""),[s,t]=j.useState(!1),l=C({api:`${x.getAllUser}?page=${g}&limit=${p}&q=${f}`,key:"getAllUserData",value:[g,p],options:{enabled:!0}}),V=a=>{t(!0),b(!0),H(a)},Y=async a=>{var r,D,E,F,M,o,O,z,J;try{const n=await B.mutateAsync({api:`${(r=x)==null?void 0:r.updateUserStatus}/${a}`,data:{id:d}});(D=n==null?void 0:n.data)!=null&&D.success?(l.refetch(),((F=(E=n==null?void 0:n.data)==null?void 0:E.data)==null?void 0:F.status)==1&&h.success((M=n.data)==null?void 0:M.message),((O=(o=n==null?void 0:n.data)==null?void 0:o.data)==null?void 0:O.status)==0&&h.error((z=n.data)==null?void 0:z.message)):h.error((J=n.data)==null?void 0:J.message)}catch(n){h.error(Ue(n))}};return e.jsxs("main",{className:"grid items-start",children:[e.jsx($e,{open:L,setOpen:b,title:s?"Edit User":"Add User",id:d,edit:s,setEdit:t,refetch:l.refetch}),e.jsxs("div",{className:"grid auto-rows-max items-start gap-4 md:gap-2 lg:col-span-2",children:[e.jsxs("div",{className:"flex w-full justify-between gap-2",children:[e.jsx("div",{children:e.jsx(Se,{search:f,setPage:R,setSearch:_,refetch:l.refetch,isFetching:l.isLoading})}),e.jsx("div",{children:e.jsx(W,{className:"flex items-center gap-2",onClick:()=>b(!0),children:"Add New"})})]}),e.jsxs(ue,{children:[e.jsx(pe,{className:"px-7",children:e.jsxs(me,{children:["Users List (",(N=(T=l.data)==null?void 0:T.data)==null?void 0:N.totalDocs,")"]})}),e.jsx(xe,{children:l.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(he,{})}):e.jsxs("div",{children:[e.jsxs(Ne,{className:"",children:[e.jsx(Ie,{children:e.jsxs(X,{children:[e.jsx(c,{className:"",children:"#"}),e.jsx(c,{className:"",children:"Images"}),e.jsx(c,{className:"",children:"Users Name"}),e.jsx(c,{className:"",children:"Mobile"}),e.jsx(c,{className:"",children:"Email"}),e.jsx(c,{className:"",children:"Role"}),e.jsx(c,{className:"",children:"ULB"}),e.jsx(c,{className:"",children:"Created at"}),e.jsx(c,{className:"",children:"Status"}),e.jsx(c,{children:"Action"})]})}),e.jsx(ye,{children:(v=(y=(I=l==null?void 0:l.data)==null?void 0:I.data)==null?void 0:y.docs)==null?void 0:v.map((a,r)=>e.jsxs(X,{children:[e.jsx(u,{children:g*p-p+r+1}),e.jsx(u,{style:{margin:5,width:"50px",height:"50px",backgroundSize:"cover",backgroundPosition:"center",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",padding:0},children:e.jsx(ge,{src:a==null?void 0:a.fullImgUrl,alt:a==null?void 0:a.imageUrl,className:"h-12 w-12 rounded-full"})}),e.jsx(u,{children:a==null?void 0:a.fullName}),e.jsx(u,{children:a==null?void 0:a.mobile}),e.jsx(u,{children:a==null?void 0:a.email}),e.jsx(u,{children:a==null?void 0:a.role}),e.jsx(u,{children:a==null?void 0:a.ulb}),e.jsx(u,{children:je(a==null?void 0:a.createdAt).format("DD-MM-YYYY")}),e.jsx(u,{children:e.jsxs(Ae,{checked:(a==null?void 0:a.status)==1,onChange:()=>Y(a==null?void 0:a._id),className:`${a!=null&&a.status?"bg-primary":"bg-gray-200"} relative inline-flex items-center h-6 rounded-full w-11`,children:[e.jsx("span",{className:"sr-only",children:"Enable notifications"}),e.jsx("span",{className:`${a!=null&&a.status?"translate-x-6":"translate-x-1"} inline-block w-4 h-4 transform bg-white rounded-full`})]})}),e.jsx(u,{children:e.jsx(W,{className:"bg-primary",onClick:()=>V(a._id),children:"Edit"})})]},a._id))})]}),e.jsx(fe,{className:"mb-2 mt-4"}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(we,{page:g,perPage:p,totalPage:(w=(U=l==null?void 0:l.data)==null?void 0:U.data)==null?void 0:w.totalDocs,hasNextPage:(A=(S=l==null?void 0:l.data)==null?void 0:S.data)==null?void 0:A.hasNextPage,hasPrevPage:($=(P=l==null?void 0:l.data)==null?void 0:P.data)==null?void 0:$.hasPrevPage,setPage:R,setPerPage:i})})]})})]})]})]})}function Ve(){return e.jsx(be,{title:"Users List",subTitle:"Manage all the Users List here",children:e.jsx("div",{className:"",children:e.jsx(De,{})})})}export{Ve as default};
