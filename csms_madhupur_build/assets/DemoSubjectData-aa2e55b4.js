import{r as i,u as Lt,s as Pt,b as Tt,A as S,e as w,Q as b,j as t,aa as kt,ab as Mt,a4 as Ht,R as pt,T as $t,a5 as qt,a6 as Gt,P as Rt,B as Vt,D as Ot,t as Ut,U as Jt,n as Y,K as Kt,l as zt,g as Qt}from"./index-21aade66.js";import{B as Yt}from"./BottomErrorCard-c4e8289a.js";const se=()=>{const[u,C]=i.useState([]),[h,g]=i.useState(!1),[D,Zt]=i.useState(!0),[Z,r]=i.useState(!1),[E,Wt]=i.useState(!1),[W,X]=i.useState([]),[tt,Xt]=i.useState(null),[f,I]=i.useState(null),[et,y]=i.useState(!1),[A,at]=i.useState(),[_,st]=i.useState([]),[F,lt]=i.useState([]),[v,B]=i.useState(1),[N,ct]=i.useState(10),[it,L]=i.useState(),[dt,P]=i.useState(),[rt,ot]=i.useState(!1),[ut,nt]=i.useState(),{api_postSubjectGroupData:mt,api_deleteSubjectGroupData:ht,api_searchSubjectGroupData:ft,api_getactiveClassData:xt,api_editSubjectGroupData:jt,api_section_group_map:te,api_getSubjectGroupData:bt}=Qt();Lt(),Pt("Class Master");const n=[{id:1,fee_head:10,fee_head_type:10,desc:"hello"},{id:2,fee_head:10,fee_head_type:10,desc:"hello"},{id:3,fee_head:10,fee_head_type:10,desc:"hello"},{id:4,fee_head:10,fee_head_type:10,desc:"hello"},{id:5,fee_head:10,fee_head_type:10,desc:"hello"}],d=Tt({initialValues:{classId:"",sectionData:[],subject:[{subjectName:""}]},onSubmit:(e,s)=>{console.log("at submit ",e,F);let l=[];F.map(c=>e.subject.map(o=>l.push({...o,...c,classId:d.values.classId})));const a=l.map(c=>({subjectName:c.subjectName,section:c.section_name,sectionId:c.id,classId:parseInt(c.classId)}));console.log("kdsjfhsadjfhasd",a,l),wt(a)}});console.log(d.values.classId,d.values.sectionData);const gt=u;console.log(u);const vt=e=>{ct(parseInt(e)),g(!0)},Nt=e=>{B(e-1)},St=e=>{B(e+1)};i.useEffect(()=>{v&&h&&m()},[v,h]),i.useEffect(()=>{N&&h&&m()},[N,h]);const wt=e=>{console.log(e),r(!0);let s,l,a={subjectGroupMap:e};f!==null?(s=jt,l=a,l.id=f):(e==null?void 0:e.bankName)!==""&&f==null&&(s=mt,l=a),S.post(s,l,w()).then(function(c){var o,x,j;console.log("bank master..",(o=c==null?void 0:c.data)==null?void 0:o.data),((x=c==null?void 0:c.data)==null?void 0:x.status)===!0?(b.success(f!==null?"Data Updated Successfully!":"Data Added Successfully"),m(),I(null)):b.error(`${(j=c==null?void 0:c.data)==null?void 0:j.message}`),r(!1)}).catch(function(c){console.log("==2 error list...",c),b.warning("Error occured in submitting form."),r(!1)})},yt=e=>{let s=[];for(let l=0;l<e.length;l++)s.push({section_name:e[l].section_name,sectionName:e[l].sectionName});lt(s)};i.useState(()=>{yt([d.values.sectionData])},[d.values.sectionData]);const _t=[{Header:"Sl No.",Cell:({cell:e})=>t.jsx("span",{children:Y(e.row.index+1)})},{Header:"Class",accessor:"class_name"},{Header:"Subject",accessor:"subject_name"},{Header:"Status",Cell:({cell:e})=>{var s,l;return t.jsx("span",{className:((s=e.row.original)==null?void 0:s.status)==="Active"?"text-[green]":"text-[red]",children:Y((l=e.row.original)==null?void 0:l.status)})}},{Header:"Created Date",accessor:"date"},{Header:"Created Time",accessor:"time"},{Header:"Action",Cell:({cell:e})=>{var s,l;return t.jsx("div",{className:"flex",children:t.jsx("button",{onClick:()=>{var a,c;I((a=e.row.original)==null?void 0:a.id),at(((c=e.row.original)==null?void 0:c.status)==="Active"?"deactive":"active"),y(!0)},className:`${((s=e.row.original)==null?void 0:s.status)=="Active"?"deactivate-button-master":"deactivate-second-button-master"}`,children:((l=e.row.original)==null?void 0:l.status)==="Active"?"Deactivate":"Activate"})})}}],Ct=()=>{r(!0),y(!1);let e={id:f,status:A};S.post(ht,e,w()).then(function(s){var l,a;((l=s==null?void 0:s.data)==null?void 0:l.status)===!0?m():activateBottomErrorCard(!0,`${(a=s==null?void 0:s.data)==null?void 0:a.message}`),r(!1)}).catch(function(s){activateBottomErrorCard(!0,"Error occured in deletion.1"),r(!1)})},m=(e=null)=>{console.log(e);let s,l;e===null?(l={perPage:N,page:v},s=bt):(l={search:e},s=ft),r(!0),S.post(s,l,w()).then(function(a){var c,o,x,j,T,k,M,H,p,$,q,G,R,V,O,U,J,K,z,Q;((c=a==null?void 0:a.data)==null?void 0:c.status)===!0?((x=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:x.total)===0||((T=(j=a==null?void 0:a.data)==null?void 0:j.data)==null?void 0:T.data.length)===0?(b.error("Data not Found"),C((M=(k=a==null?void 0:a.data)==null?void 0:k.data)==null?void 0:M.data),L((p=(H=a==null?void 0:a.data)==null?void 0:H.data)==null?void 0:p.last_page),P((q=($=a==null?void 0:a.data)==null?void 0:$.data)==null?void 0:q.total),g(!1)):(console.log("class section map data",(R=(G=a==null?void 0:a.data)==null?void 0:G.data)==null?void 0:R.data),C((O=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:O.data),L((J=(U=a==null?void 0:a.data)==null?void 0:U.data)==null?void 0:J.last_page),P((z=(K=a==null?void 0:a.data)==null?void 0:K.data)==null?void 0:z.total),g(!1)):b.error(`${(Q=a==null?void 0:a.data)==null?void 0:Q.message}`),r(!1)}).catch(function(a){activateBottomErrorCard(!0,"Error occured while fetching data.2"),r(!1)})},Dt=()=>{r(!0),S.post(xt,{},w()).then(function(e){e!=null&&e.data?(console.log(e==null?void 0:e.data),st(e==null?void 0:e.data.data)):activateBottomErrorCard(!0,"Error occured while fetching data.3"),r(!1)}).catch(function(e){console.log("==2 error list...",e),activateBottomErrorCard(!0,"Error occured while fetching data.4"),r(!1)})},Et=e=>{};i.useEffect(()=>{d.values.classId!=""&&Et(parseInt(d.values.classId))},[d.values.classId]),i.useEffect(()=>{m(),Dt()},[]);const It=e=>{e.target.name},At=(e,s)=>{let l=e.target.name,a=e.target.value;l==`subject.${s}.subjectName`&&d.setFieldValue(`subject.${s}.subjectName`,Kt(a,d.values.subject[s].subjectName,50))};i.useEffect(()=>{const e=u.map(s=>{const{id:l,...a}=s;return a});console.log(e),X(e)},[u]);const Ft=[{title:"Class",feild:"class_name"},{title:"Section",feild:"section_name"},{title:"Subject",feild:"subject_name"},{title:"Created Date  ",feild:"date"},{title:"Created Time ",feild:"time"},{title:"Status",feild:"status"}],Bt=()=>{const e=new zt;e.text("Subject Map Details",10,10),e.autoTable({theme:"grid",columns:Ft.map(s=>({...s,dataKey:s.feild})),body:u}),e.save("SubjectMap.pdf")};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"w-full h-[76vh] lg:h-auto overflow-auto ",children:[t.jsxs("div",{className:"flex items-start justify-start flex-col mt-5 ml-5 ",children:[t.jsx("h1",{className:"text-4xl font-semibold text-gray-700",children:"Subject Master Form"}),t.jsx("h1",{className:"common-header-smalltext",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]}),t.jsx("div",{className:" mt-3 ml-3 mr-3 ",children:t.jsx("div",{className:"flex h-auto  items-start justify-start w-full",children:t.jsxs("div",{className:"grid grid-cols-12 w-full  ml-3 mr-3",children:[t.jsx("div",{className:"col-span-12 lg:col-span-5 w-full flex justify-center",children:t.jsxs("div",{className:"mt-5 border border-teal-300 w-full  rounded-md relative",children:[t.jsxs("div",{className:"bg-white px-3 ",children:[" ",t.jsx("h1",{className:" absolute text-2xl bg-white flex font-semibold  -mt-4 text-[#0F766E] ml-9",children:"Add"})]}),t.jsxs("div",{className:"w-full mb-6 mt-[4vh] pb-10  ",children:[t.jsx(kt,{value:d,children:t.jsxs(Mt,{onSubmit:d.handleSubmit,onChange:It,children:[t.jsxs("div",{className:"grid grid-cols-12",children:[t.jsx("div",{className:" col-span-12 lg:col-span-3",children:t.jsxs("label",{className:"  text-teal-900 text-sm w-[10vw]   font-semibold",htmlFor:"",children:["Class Name",t.jsx("small",{className:"mt-1 text-sm font-semibold text-red-600 inline ",children:"*"})]})}),t.jsxs("div",{className:"col-span-12 lg:col-span-9",children:[t.jsxs("select",{...d.getFieldProps("classId"),className:"common-input-css",type:"text",placeholder:"Enter class",children:[t.jsx("option",{value:"",children:"Select"}),_==null?void 0:_.map((e,s)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.class_name}))]}),t.jsx("span",{className:"text-red-600  text-xs",children:d.touched.classId&&d.errors.classId?d.errors.classId:null})]})]}),t.jsx(t.Fragment,{children:t.jsx("div",{className:"w-[95%] ml-5 flex items-center mt-8 justify-center border border-teal-300  h-[34vh] overflow-auto",children:t.jsx("div",{className:"w-full  relative",children:t.jsxs("div",{className:"h-[32vh] overflow-auto",children:[" ",t.jsx("div",{className:"w-full ",children:t.jsx(Ht,{name:"subject",children:e=>t.jsx(t.Fragment,{children:(d==null?void 0:d.values.subject.length)>0&&(d==null?void 0:d.values.subject.map((s,l)=>t.jsx(pt.Fragment,{children:t.jsx("div",{className:"w-full h-auto overflow-auto flex items-center justify-center",children:t.jsxs("div",{className:"flex mt-[4vh] max-[700px]:block",children:[t.jsx($t,{formik:d,label:"Subject Name",name:`subject.${l}.subjectName`,isDynamic:!0,placeholder:"Enter subject name",onChange:a=>At(a,l)}),t.jsxs("div",{className:" px-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Add & Remove Subject"}),l>0&&t.jsx("button",{className:"mt-1",type:"button",onClick:()=>e.remove(l),children:t.jsx(qt,{className:"inline-block w-9 h-9 text-red-600"})}),"|",t.jsx("button",{type:"button",className:"mt-1",onClick:()=>{if(s.subjectName==="")return activateBottomErrorCard(!0,"fill the subject name");e.push({subjectName:""})},children:t.jsx(Gt,{className:"inline-block w-9 h-9 text-blue-600"})})]})]})})},l)))})})})]})})})}),t.jsx("div",{className:"mt-3",children:t.jsx("button",{type:"submit",className:"save-button",children:"Save"})})]})}),t.jsx("div",{className:"mandatorytext",children:t.jsxs("h1",{children:["Note : (*) is a mandatory field, Section Name must be character (A-Z,a-z)"," "]})})]})]})}),t.jsx("div",{className:" col-span-12 lg:col-span-7 w-full lg:ml-2 ",children:t.jsxs("div",{className:"mt-5 border border-teal-300   rounded-md relative",children:[t.jsxs("div",{className:"bg-white px-3 ",children:[" ",t.jsx("h1",{className:" absolute text-2xl bg-white flex font-semibold  -mt-4 text-gray-500 ml-9",children:"View List"})]}),t.jsx("div",{className:"mt-5  ",children:t.jsx(Rt,{generatePdf:Bt,enable:rt,setenable:ot,csvdata:W,readymadeListData:u,fetchMasterList:m,setSearchTableData:nt,searchTableData:ut})}),t.jsx("div",{className:"-mt-5 main-div",children:t.jsxs("div",{className:" rounded-md h-[80vh] 2xl:p-6 p-4 overflow-y-auto",children:[Z&&t.jsx(Vt,{}),E&&t.jsx(Yt,{activateBottomErrorCard,errorTitle:tt}),E&&t.jsxs("div",{className:"alert-msg",role:"alert",children:[t.jsx("strong",{className:"sorry-msg",children:"Sorry! "}),t.jsx("span",{className:"some-error-msg",children:"Some error occured while fetching list. Please try again later"}),t.jsx("span",{className:"absolute-span"})]}),et&&t.jsx(Ot,{setdeleteStatus:y,deleteItem:Ct,deactivate:A}),t.jsx("div",{className:"h-[55vh] overflow-auto",children:D&&(n==null?void 0:n.length)!=0&&t.jsxs(t.Fragment,{children:[t.jsx(Ut,{filter:!1,exportStatus:!1,assessmentType:!1,columns:_t,dataList:gt,pageNumber:dt}),t.jsx(Jt,{ChangePage:vt,number:v,lastPage:it,nextPage:St,prevPage:Nt,postperpage:N,blockToast:h,setBlockToast:g})]})}),D&&(n==null?void 0:n.length)==0&&t.jsx("div",{className:"data-not-found",children:"Data Not Found"})]})})]})})]})})})]})})};export{se as default};
