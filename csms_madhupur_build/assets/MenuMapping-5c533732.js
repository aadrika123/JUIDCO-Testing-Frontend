import{u as O,r as n,b as z,S as h,A as p,e as f,R as H,j as a,B as G,aa as K,ab as Q,c as v,du as X,a as Z,g as ee}from"./index-21aade66.js";import{B as ae}from"./BottomErrorCard-c4e8289a.js";import{u as te}from"./useErrorAutoFocusField-39db6dc1.js";import{S as D}from"./OutLineTextField-7556c55f.js";let re=v().shape({menuMap:X().of(v().shape({description:Z().when("menuMapStatus",{is:u=>u=="2",then:u=>u.required("Description is required").min(3,"Must be at least 3 characters").max(100,"Must be at most 100 characters"),otherwise:u=>u.notRequired()})}))});function fe(){var y,_;O();const{AutoFocusErrorField:u}=te(),{api_retrieve_all_student:le,api_getClassData:ce,api_getSectionData:se,api_student_menuMap:de,api_section_group_map:ne,api_fetch_student_menuMap:oe,menu_crud_active_all:I,menu_mapping_retrieve_all_store:E,get_active_role:R,menu_mapping_store:F}=ee(),[$,d]=n.useState(!1),[i,j]=n.useState([]),[C,A]=n.useState(!1),[B,U]=n.useState(null),[b,W]=n.useState([]);n.useState([]);const[g,L]=n.useState([]),T=()=>{d(!0),p.post(I,{},f()).then(function(e){var t,l,r,s;console.log("menu master..",(t=e==null?void 0:e.data)==null?void 0:t.data),(l=e==null?void 0:e.data)!=null&&l.status?W((r=e==null?void 0:e.data)==null?void 0:r.data):o(!0,(s=e==null?void 0:e.data)==null?void 0:s.message),d(!1)}).catch(function(e){console.log("==2 error list...",e),o(!0,"Error occured while fetching data."),d(!1)})},V=()=>{d(!0),p.post(R,{},f()).then(function(e){var t,l,r,s;console.log("role Data..",(t=e==null?void 0:e.data)==null?void 0:t.data),(l=e==null?void 0:e.data)!=null&&l.status?L((r=e==null?void 0:e.data)==null?void 0:r.data):o(!0,(s=e==null?void 0:e.data)==null?void 0:s.message),d(!1)}).catch(function(e){console.log("==2 error list...",e),o(!0,"Error occured while fetching data."),d(!1)})},Y=()=>{if(i){const e=i==null?void 0:i.map(t=>({subMenuId:t==null?void 0:t.id,subMenuName:t==null?void 0:t.sub_menu_name,orderNo:t==null?void 0:t.order_no,menuId:t==null?void 0:t.menu_id,menuName:t==null?void 0:t.menu_name}));m.setFieldValue("menuMap",e)}},m=z({enableReinitialize:!0,initialValues:{menuName:"",menuId:"",section_id:"",menuMap:[{menuId:"",subMenuId:"",isWrite:"0",isRead:"0",isUpdate:"0",isDeactivate:"0"}]},validationSchema:re,onSubmit:e=>{var l;const t=(l=e==null?void 0:e.menuMap)==null?void 0:l.map(r=>({menuId:e==null?void 0:e.menuId,subMenuId:r==null?void 0:r.subMenuId,isWrite:(r==null?void 0:r.isWrite)||0,isRead:(r==null?void 0:r.isRead)||0,isUpdate:(r==null?void 0:r.isUpdate)||0,isDeactivate:(r==null?void 0:r.isDeactivate)||0,roleId:e==null?void 0:e.roleId}));console.log("values",t),h.fire({title:"Are you sure?",text:"You want to submit menuMap!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, submit it!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(r=>{r.isConfirmed?(d(!0),p.post(F,{menuMap:t},f()).then(function(s){var S,k;console.log("Class Data..",s),((S=s==null?void 0:s.data)==null?void 0:S.status)==!0?(h.fire("Submitted!","menuMap has been submitted.","success"),m.resetForm()):o(!0,(k=s==null?void 0:s.data)==null?void 0:k.message),d(!1)}).catch(function(s){console.log("==2 error list...",s),o(!0,"Error occured while fetching data."),d(!1)})):r.dismiss===h.DismissReason.cancel&&h.fire("Cancelled","Your form data is safe :)","error")})}}),{values:c,handleSubmit:q,getFieldProps:ue,setFieldValue:x,errors:w,touched:ie,isValid:P,isSubmitting:N,submitCount:M}=m,J=()=>{d(!0),p.post(E,{menuId:c==null?void 0:c.menuId},f()).then(function(e){var t,l,r;console.log("Student Data..",(t=e==null?void 0:e.data)==null?void 0:t.data),(l=e==null?void 0:e.data)!=null&&l.status?j((r=e==null?void 0:e.data)==null?void 0:r.data):j([]),d(!1)}).catch(function(e){console.log("==2 error list...",e),o(!0,"Error occured while fetching data."),d(!1)})};n.useEffect(()=>{T(),V()},[]),n.useEffect(()=>{c!=null&&c.menuId&&J()},[c==null?void 0:c.menuId]),n.useEffect(()=>{i&&Y()},[i]);const o=(e,t)=>{U(t),A(e)};return H.useEffect(()=>{u({isValid:P,submitCount:M,isSubmitting:N,errors:w})},[w,M,N]),a.jsxs(a.Fragment,{children:[$&&a.jsx(G,{}),C&&a.jsx(ae,{activateBottomErrorCard:o,errorTitle:B}),a.jsx(K,{value:c,children:a.jsx(Q,{onSubmit:q,children:a.jsx("div",{className:"w-full col-span-10 2xl:py-3 2xl:px-6 px-6 py-2",children:a.jsxs("div",{className:"border-[2px] border-gray-200 rounded-md h-[82vh] 2xl:p-6 p-4 overflow-y-auto",children:[a.jsx("div",{className:"",children:a.jsxs("div",{className:"flex w-full justify-between items-center max-[870px]:block",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-3xl text-center font-semibold text-gray-600 flex flex-start",children:"Menu Mapping"}),a.jsx("span",{className:"text-sm text-center font-medium text-gray-400",children:"Unlock Your Potential. Join Our Journey Of Education And Excellence"})]}),a.jsxs("div",{className:"flex gap-6 mt-4 md:mt-0 flex-col lg:flex-row",children:[a.jsx("input",{disabled:!0,type:"text",className:"mt-7 h-8 w-full lg:w-40 form-control block  px-3 2xl:py-1.5 py-1 2xl:text-base text-sm font-normal text-gray-700  bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md ",value:Date().toLocaleString().slice(0,15)}),a.jsx("div",{className:"form-group  md:col-span-2 mb-6 md:px-4",children:a.jsx(D,{label:"Select Menu",name:"menuId",formik:m,selectedText:"menuName",children:b==null?void 0:b.map((e,t)=>a.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.menu_name},t))})}),a.jsx("div",{className:"form-group col-span-12 md:col-span-2 mb-6 md:px-4",children:a.jsx(D,{label:"Select Role",name:"roleId",formik:m,selectedText:"roleName",children:g==null?void 0:g.map((e,t)=>a.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.role_name},t))})})]})]})}),((y=c==null?void 0:c.menuMap)==null?void 0:y.length)>0?a.jsx("div",{className:"flex flex-col",children:a.jsx("div",{className:"overflow-x-auto sm:-mx-6 lg:-mx-8",children:a.jsx("div",{className:"inline-block min-w-full py-2 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"overflow-hidden",children:[a.jsxs("table",{className:"min-w-full border text-center text-sm font-light dark:border-neutral-500",children:[a.jsx("thead",{className:"border-b font-medium dark:border-neutral-500",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"whitespace-nowrap border-r px-6 py-4 font-medium dark:border-neutral-500",children:"sl.no"}),a.jsx("th",{scope:"col",className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:"Sub Menu Name"}),a.jsx("th",{scope:"col",className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:"Create"})}),a.jsx("th",{scope:"col",className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:"Read"})}),a.jsx("th",{scope:"col",className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:"Update"})}),a.jsx("th",{scope:"col",className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:"Delete"})})]})}),a.jsx("tbody",{children:(_=c==null?void 0:c.menuMap)==null?void 0:_.map((e,t)=>a.jsxs("tr",{className:"border-b dark:border-neutral-500",children:[a.jsx("td",{className:"whitespace-nowrap border-r px-6 py-4 font-medium dark:border-neutral-500",children:t+1}),a.jsx("td",{className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:(e==null?void 0:e.subMenuName)||"N/A"}),a.jsx("td",{className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("input",{className:"h-[18px] w-[18px]  ",type:"checkbox",value:`menuMap[${t}].isWrite`=="1"?"0":"1",name:`menuMap[${t}].isWrite`,onChange:l=>{x(`menuMap[${t}].isWrite`,l.target.value)}})}),a.jsx("td",{className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("input",{className:"h-[18px] w-[18px]",type:"checkbox",value:`menuMap[${t}].isRead`=="1"?"0":"1",name:`menuMap[${t}].isRead`,onChange:l=>{x(`menuMap[${t}].isRead`,l.target.value)}})}),a.jsx("td",{className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("input",{className:"h-[18px] w-[18px]",type:"checkbox",value:`menuMap[${t}].isUpdate`=="1"?"0":"1",name:`menuMap[${t}].isUpdate`,onChange:l=>{x(`menuMap[${t}].isUpdate`,l.target.value)}})}),a.jsx("td",{className:"whitespace-nowrap border-r px-6 py-4 dark:border-neutral-500",children:a.jsx("input",{className:"h-[18px] w-[18px]  ",type:"checkbox",value:`menuMap[${t}].isDeactivate`=="1"?"0":"1",name:`menuMap[${t}].isDeactivate`,onChange:l=>{x(`menuMap[${t}].isDeactivate`,l.target.value)}})})]}))})]}),a.jsx("div",{className:"flex justify-end w-full gap-4 mt-4",children:a.jsx("button",{type:"submit",className:"bg-blue-500 text- text-white px-4 py-2 rounded-md mt-4",children:"Submit"})})]})})})}):a.jsx("h1",{className:"text-gray-600 text-center mt-56 text-2xl",children:"No Data Found! please select class and section"})]})})})})]})}export{fe as default};
